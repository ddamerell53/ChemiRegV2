// Generated by Haxe 3.4.7
var $hx_exports = typeof exports != "undefined" ? exports : typeof window != "undefined" ? window : typeof self != "undefined" ? self : this;
$hx_exports["saturn"] = $hx_exports["saturn"] || {};
$hx_exports["saturn"]["core"] = $hx_exports["saturn"]["core"] || {};
$hx_exports["saturn"]["core"]["domain"] = $hx_exports["saturn"]["core"]["domain"] || {};
var $global = typeof window != "undefined" ? window : typeof global != "undefined" ? global : typeof self != "undefined" ? self : this;
var $hxClasses = $hxClasses || {},$estr = function() { return js.Boot.__string_rec(this,''); };
function $extend(from, fields) {
	function Inherit() {} Inherit.prototype = from; var proto = new Inherit();
	for (var name in fields) proto[name] = fields[name];
	if( fields.toString !== Object.prototype.toString ) proto.toString = fields.toString;
	return proto;
}
var EReg = $hxClasses["EReg"] = function(r,opt) {
	this.r = new RegExp(r,opt.split("u").join(""));
	this.rs = r;
	this.opt = opt;
};
EReg.__name__ = ["EReg"];
EReg.prototype = {
	r: null
	,rs: null
	,opt: null
	,regenerate: function() {
		this.r = new RegExp(this.rs,this.opt);
	}
	,hxUnserialize: function(u) {
		this.rs = u.unserialize();
		this.opt = u.unserialize();
	}
	,hxSerialize: function(s) {
		s.serialize(this.rs);
		s.serialize(this.opt);
		this.regenerate();
	}
	,match: function(s) {
		if(this.r.global) {
			this.r.lastIndex = 0;
		}
		this.r.m = this.r.exec(s);
		this.r.s = s;
		return this.r.m != null;
	}
	,matched: function(n) {
		if(this.r.m != null && n >= 0 && n < this.r.m.length) {
			return this.r.m[n];
		} else {
			throw new js._Boot.HaxeError("EReg::matched");
		}
	}
	,matchedLeft: function() {
		if(this.r.m == null) {
			throw new js._Boot.HaxeError("No string matched");
		}
		return HxOverrides.substr(this.r.s,0,this.r.m.index);
	}
	,matchedRight: function() {
		if(this.r.m == null) {
			throw new js._Boot.HaxeError("No string matched");
		}
		var sz = this.r.m.index + this.r.m[0].length;
		return HxOverrides.substr(this.r.s,sz,this.r.s.length - sz);
	}
	,matchedPos: function() {
		if(this.r.m == null) {
			throw new js._Boot.HaxeError("No string matched");
		}
		return { pos : this.r.m.index, len : this.r.m[0].length};
	}
	,matchSub: function(s,pos,len) {
		if(len == null) {
			len = -1;
		}
		if(this.r.global) {
			this.r.lastIndex = pos;
			var tmp = this.r;
			var tmp1 = len < 0 ? s : HxOverrides.substr(s,0,pos + len);
			this.r.m = tmp.exec(tmp1);
			var b = this.r.m != null;
			if(b) {
				this.r.s = s;
			}
			return b;
		} else {
			var b1 = this.match(len < 0 ? HxOverrides.substr(s,pos,null) : HxOverrides.substr(s,pos,len));
			if(b1) {
				this.r.s = s;
				this.r.m.index += pos;
			}
			return b1;
		}
	}
	,replace: function(s,by) {
		return s.replace(this.r,by);
	}
	,__class__: EReg
};
var HxOverrides = $hxClasses["HxOverrides"] = function() { };
HxOverrides.__name__ = ["HxOverrides"];
HxOverrides.strDate = function(s) {
	var _g = s.length;
	switch(_g) {
	case 8:
		var k = s.split(":");
		var d = new Date();
		d["setTime"](0);
		d["setUTCHours"](k[0]);
		d["setUTCMinutes"](k[1]);
		d["setUTCSeconds"](k[2]);
		return d;
	case 10:
		var k1 = s.split("-");
		return new Date(k1[0],k1[1] - 1,k1[2],0,0,0);
	case 19:
		var k2 = s.split(" ");
		var y = k2[0].split("-");
		var t = k2[1].split(":");
		return new Date(y[0],y[1] - 1,y[2],t[0],t[1],t[2]);
	default:
		throw new js._Boot.HaxeError("Invalid date format : " + s);
	}
};
HxOverrides.cca = function(s,index) {
	var x = s.charCodeAt(index);
	if(x != x) {
		return js.Lib.get_undefined();
	}
	return x;
};
HxOverrides.substr = function(s,pos,len) {
	if(len == null) {
		len = s.length;
	} else if(len < 0) {
		if(pos == 0) {
			len = s.length + len;
		} else {
			return "";
		}
	}
	return s.substr(pos,len);
};
HxOverrides.remove = function(a,obj) {
	var i = a.indexOf(obj);
	if(i == -1) {
		return false;
	}
	a.splice(i,1);
	return true;
};
HxOverrides.iter = function(a) {
	return { cur : 0, arr : a, hasNext : function() {
		return this.cur < this.arr.length;
	}, next : function() {
		return this.arr[this.cur++];
	}};
};
var Lambda = $hxClasses["Lambda"] = function() { };
Lambda.__name__ = ["Lambda"];
Lambda.count = function(it,pred) {
	var n = 0;
	if(pred == null) {
		var _ = $iterator(it)();
		while(_.hasNext()) {
			var _1 = _.next();
			++n;
		}
	} else {
		var x = $iterator(it)();
		while(x.hasNext()) {
			var x1 = x.next();
			if(pred(x1)) {
				++n;
			}
		}
	}
	return n;
};
var List = $hxClasses["List"] = function() {
	this.length = 0;
};
List.__name__ = ["List"];
List.prototype = {
	h: null
	,q: null
	,length: null
	,add: function(item) {
		var x = new _List.ListNode(item,null);
		if(this.h == null) {
			this.h = x;
		} else {
			this.q.next = x;
		}
		this.q = x;
		this.length++;
	}
	,first: function() {
		if(this.h == null) {
			return null;
		} else {
			return this.h.item;
		}
	}
	,isEmpty: function() {
		return this.h == null;
	}
	,iterator: function() {
		return new _List.ListIterator(this.h);
	}
	,__class__: List
};
var _List = _List || {};
_List.ListNode = $hxClasses["_List.ListNode"] = function(item,next) {
	this.item = item;
	this.next = next;
};
_List.ListNode.__name__ = ["_List","ListNode"];
_List.ListNode.prototype = {
	item: null
	,next: null
	,__class__: _List.ListNode
};
_List.ListIterator = $hxClasses["_List.ListIterator"] = function(head) {
	this.head = head;
};
_List.ListIterator.__name__ = ["_List","ListIterator"];
_List.ListIterator.prototype = {
	head: null
	,hasNext: function() {
		return this.head != null;
	}
	,next: function() {
		var val = this.head.item;
		this.head = this.head.next;
		return val;
	}
	,__class__: _List.ListIterator
};
Math.__name__ = ["Math"];
var Reflect = $hxClasses["Reflect"] = function() { };
Reflect.__name__ = ["Reflect"];
Reflect.hasField = function(o,field) {
	return Object.prototype.hasOwnProperty.call(o,field);
};
Reflect.field = function(o,field) {
	try {
		return o[field];
	} catch( e ) {
		return null;
	}
};
Reflect.setField = function(o,field,value) {
	o[field] = value;
};
Reflect.callMethod = function(o,func,args) {
	return func.apply(o,args);
};
Reflect.fields = function(o) {
	var a = [];
	if(o != null) {
		var hasOwnProperty = Object.prototype.hasOwnProperty;
		for( var f in o ) {
		if(f != "__id__" && f != "hx__closures__" && hasOwnProperty.call(o,f)) {
			a.push(f);
		}
		}
	}
	return a;
};
Reflect.isFunction = function(f) {
	if(typeof(f) == "function") {
		return !(js.Boot.isClass(f) || js.Boot.isEnum(f));
	} else {
		return false;
	}
};
Reflect.deleteField = function(o,field) {
	if(!Reflect.hasField(o,field)) {
		return false;
	}
	delete(o[field]);
	return true;
};
var Std = $hxClasses["Std"] = function() { };
Std.__name__ = ["Std"];
Std["is"] = function(v,t) {
	return js.Boot.__instanceof(v,t);
};
Std.string = function(s) {
	return js.Boot.__string_rec(s,"");
};
Std["int"] = function(x) {
	return x | 0;
};
Std.parseInt = function(x) {
	var v = parseInt(x,10);
	if(v == 0 && (HxOverrides.cca(x,1) == 120 || HxOverrides.cca(x,1) == 88)) {
		v = parseInt(x);
	}
	if(isNaN(v)) {
		return null;
	}
	return v;
};
Std.parseFloat = function(x) {
	return parseFloat(x);
};
var StringBuf = $hxClasses["StringBuf"] = function() {
	this.b = "";
};
StringBuf.__name__ = ["StringBuf"];
StringBuf.prototype = {
	b: null
	,add: function(x) {
		this.b += Std.string(x);
	}
	,addChar: function(c) {
		this.b += String.fromCharCode(c);
	}
	,toString: function() {
		return this.b;
	}
	,__class__: StringBuf
};
var StringTools = $hxClasses["StringTools"] = function() { };
StringTools.__name__ = ["StringTools"];
StringTools.urlEncode = function(s) {
	return encodeURIComponent(s);
};
StringTools.urlDecode = function(s) {
	return decodeURIComponent(s.split("+").join(" "));
};
StringTools.startsWith = function(s,start) {
	if(s.length >= start.length) {
		return HxOverrides.substr(s,0,start.length) == start;
	} else {
		return false;
	}
};
StringTools.replace = function(s,sub,by) {
	return s.split(sub).join(by);
};
StringTools.fastCodeAt = function(s,index) {
	return s.charCodeAt(index);
};
StringTools.isEof = function(c) {
	return c != c;
};
var ValueType = $hxClasses["ValueType"] = { __ename__ : ["ValueType"], __constructs__ : ["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"] };
ValueType.TNull = ["TNull",0];
ValueType.TNull.toString = $estr;
ValueType.TNull.__enum__ = ValueType;
ValueType.TInt = ["TInt",1];
ValueType.TInt.toString = $estr;
ValueType.TInt.__enum__ = ValueType;
ValueType.TFloat = ["TFloat",2];
ValueType.TFloat.toString = $estr;
ValueType.TFloat.__enum__ = ValueType;
ValueType.TBool = ["TBool",3];
ValueType.TBool.toString = $estr;
ValueType.TBool.__enum__ = ValueType;
ValueType.TObject = ["TObject",4];
ValueType.TObject.toString = $estr;
ValueType.TObject.__enum__ = ValueType;
ValueType.TFunction = ["TFunction",5];
ValueType.TFunction.toString = $estr;
ValueType.TFunction.__enum__ = ValueType;
ValueType.TClass = function(c) { var $x = ["TClass",6,c]; $x.__enum__ = ValueType; $x.toString = $estr; return $x; };
ValueType.TEnum = function(e) { var $x = ["TEnum",7,e]; $x.__enum__ = ValueType; $x.toString = $estr; return $x; };
ValueType.TUnknown = ["TUnknown",8];
ValueType.TUnknown.toString = $estr;
ValueType.TUnknown.__enum__ = ValueType;
var Type = $hxClasses["Type"] = function() { };
Type.__name__ = ["Type"];
Type.getClass = function(o) {
	if(o == null) {
		return null;
	} else {
		return js.Boot.getClass(o);
	}
};
Type.getClassName = function(c) {
	var a = c.__name__;
	if(a == null) {
		return null;
	}
	return a.join(".");
};
Type.getEnumName = function(e) {
	var a = e.__ename__;
	return a.join(".");
};
Type.resolveClass = function(name) {
	var cl = $hxClasses[name];
	if(cl == null || !js.Boot.isClass(cl)) {
		return null;
	}
	return cl;
};
Type.resolveEnum = function(name) {
	var e = $hxClasses[name];
	if(e == null || !js.Boot.isEnum(e)) {
		return null;
	}
	return e;
};
Type.createInstance = function(cl,args) {
	var _g = args.length;
	switch(_g) {
	case 0:
		return new cl();
	case 1:
		return new cl(args[0]);
	case 2:
		return new cl(args[0],args[1]);
	case 3:
		return new cl(args[0],args[1],args[2]);
	case 4:
		return new cl(args[0],args[1],args[2],args[3]);
	case 5:
		return new cl(args[0],args[1],args[2],args[3],args[4]);
	case 6:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5]);
	case 7:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6]);
	case 8:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);
	case 9:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8]);
	case 10:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9]);
	case 11:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9],args[10]);
	case 12:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9],args[10],args[11]);
	case 13:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9],args[10],args[11],args[12]);
	case 14:
		return new cl(args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7],args[8],args[9],args[10],args[11],args[12],args[13]);
	default:
		throw new js._Boot.HaxeError("Too many arguments");
	}
};
Type.createEmptyInstance = function(cl) {
	function empty() {}; empty.prototype = cl.prototype;
	return new empty();
};
Type.createEnum = function(e,constr,params) {
	var f = Reflect.field(e,constr);
	if(f == null) {
		throw new js._Boot.HaxeError("No such constructor " + constr);
	}
	if(Reflect.isFunction(f)) {
		if(params == null) {
			throw new js._Boot.HaxeError("Constructor " + constr + " need parameters");
		}
		return Reflect.callMethod(e,f,params);
	}
	if(params != null && params.length != 0) {
		throw new js._Boot.HaxeError("Constructor " + constr + " does not need parameters");
	}
	return f;
};
Type.getInstanceFields = function(c) {
	var a = [];
	for(var i in c.prototype) a.push(i);
	HxOverrides.remove(a,"__class__");
	HxOverrides.remove(a,"__properties__");
	return a;
};
Type.getEnumConstructs = function(e) {
	return e.__constructs__.slice();
};
Type["typeof"] = function(v) {
	var _g = typeof(v);
	switch(_g) {
	case "boolean":
		return ValueType.TBool;
	case "function":
		if(js.Boot.isClass(v) || js.Boot.isEnum(v)) {
			return ValueType.TObject;
		}
		return ValueType.TFunction;
	case "number":
		if(Math.ceil(v) == v % 2147483648.0) {
			return ValueType.TInt;
		}
		return ValueType.TFloat;
	case "object":
		if(v == null) {
			return ValueType.TNull;
		}
		var e = v.__enum__;
		if(e != null) {
			return ValueType.TEnum(e);
		}
		var c = js.Boot.getClass(v);
		if(c != null) {
			return ValueType.TClass(c);
		}
		return ValueType.TObject;
	case "string":
		return ValueType.TClass(String);
	case "undefined":
		return ValueType.TNull;
	default:
		return ValueType.TUnknown;
	}
};
Type.enumIndex = function(e) {
	return e[1];
};
var bindings = bindings || {};
bindings.NodeSocket = $hxClasses["bindings.NodeSocket"] = function(nativeSocket) {
	this.theNativeSocket = nativeSocket;
};
bindings.NodeSocket.__name__ = ["bindings","NodeSocket"];
bindings.NodeSocket.prototype = {
	theNativeSocket: null
	,id: null
	,on: function(command,func) {
		this.theNativeSocket.on(command,func);
	}
	,emit: function(command,obj) {
		this.theNativeSocket.emit(command,obj);
	}
	,getId: function() {
		return this.theNativeSocket.id;
	}
	,disconnect: function() {
		this.theNativeSocket.disconnect();
	}
	,__class__: bindings.NodeSocket
};
bindings.NodeFSExtra = $hxClasses["bindings.NodeFSExtra"] = function() { };
bindings.NodeFSExtra.__name__ = ["bindings","NodeFSExtra"];
bindings.NodeFSExtra.copy = function(src,dest,cb) {
	bindings.NodeFSExtra.fsExtra.copy(src,dest,cb);
	return;
};
bindings.NodeTemp = $hxClasses["bindings.NodeTemp"] = function() { };
bindings.NodeTemp.__name__ = ["bindings","NodeTemp"];
bindings.NodeTemp.open = function(prefix,cb) {
	return bindings.NodeTemp.temp.open(prefix,cb);
};
bindings.NodeTemp.open_untracked = function(prefix,cb) {
	var filePath = bindings.NodeTemp.temp.path(prefix);
	var cnst = js.Node.require("constants");
	var RDWR_EXCL = cnst.O_CREAT | cnst.O_TRUNC | cnst.O_RDWR | cnst.O_EXCL;
	var tmp = js.Node.require("fs").open;
	var tmp1 = parseInt("0600",8);
	tmp(filePath,RDWR_EXCL,tmp1,function(err,fd) {
		if(cb != null) {
			cb(err,{ path : filePath, fd : fd});
		}
	});
	return 1;
};
var com = com || {};
if(!com.dongxiguo) com.dongxiguo = {};
if(!com.dongxiguo.continuation) com.dongxiguo.continuation = {};
com.dongxiguo.continuation.Continuation = $hxClasses["com.dongxiguo.continuation.Continuation"] = function() { };
com.dongxiguo.continuation.Continuation.__name__ = ["com","dongxiguo","continuation","Continuation"];
com.dongxiguo.continuation.ContinuationDetail = $hxClasses["com.dongxiguo.continuation.ContinuationDetail"] = function() { };
com.dongxiguo.continuation.ContinuationDetail.__name__ = ["com","dongxiguo","continuation","ContinuationDetail"];
var haxe = haxe || {};
haxe.IMap = $hxClasses["haxe.IMap"] = function() { };
haxe.IMap.__name__ = ["haxe","IMap"];
haxe.Json = $hxClasses["haxe.Json"] = function() { };
haxe.Json.__name__ = ["haxe","Json"];
haxe.Json.stringify = function(obj,replacer,insertion) {
	return js.Node.get_json().stringify(obj,replacer,insertion);
};
haxe.Json.parse = function(jsonString) {
	return js.Node.get_json().parse(jsonString);
};
haxe.Serializer = $hxClasses["haxe.Serializer"] = function() {
	this.buf = new StringBuf();
	this.cache = [];
	this.useCache = haxe.Serializer.USE_CACHE;
	this.useEnumIndex = haxe.Serializer.USE_ENUM_INDEX;
	this.shash = new haxe.ds.StringMap();
	this.scount = 0;
};
haxe.Serializer.__name__ = ["haxe","Serializer"];
haxe.Serializer.run = function(v) {
	var s = new haxe.Serializer();
	s.serialize(v);
	return s.toString();
};
haxe.Serializer.prototype = {
	buf: null
	,cache: null
	,shash: null
	,scount: null
	,useCache: null
	,useEnumIndex: null
	,toString: function() {
		return this.buf.toString();
	}
	,serializeString: function(s) {
		var x = this.shash.get(s);
		if(x != null) {
			this.buf.add("R");
			this.buf.add(x);
			return;
		}
		this.shash.set(s,this.scount++);
		this.buf.add("y");
		s = StringTools.urlEncode(s);
		this.buf.add(s.length);
		this.buf.add(":");
		this.buf.add(s);
	}
	,serializeRef: function(v) {
		var vt = typeof(v);
		var _g1 = 0;
		var _g = this.cache.length;
		while(_g1 < _g) {
			var i = _g1++;
			var ci = this.cache[i];
			if(typeof(ci) == vt && ci == v) {
				this.buf.add("r");
				this.buf.add(i);
				return true;
			}
		}
		this.cache.push(v);
		return false;
	}
	,serializeFields: function(v) {
		var _g = 0;
		var _g1 = Reflect.fields(v);
		while(_g < _g1.length) {
			var f = _g1[_g];
			++_g;
			this.serializeString(f);
			this.serialize(Reflect.field(v,f));
		}
		this.buf.add("g");
	}
	,serialize: function(v) {
		var _g = Type["typeof"](v);
		switch(Type.enumIndex(_g)) {
		case 0:
			this.buf.add("n");
			break;
		case 1:
			var v1 = v;
			if(v1 == 0) {
				this.buf.add("z");
				return;
			}
			this.buf.add("i");
			this.buf.add(v1);
			break;
		case 2:
			var v2 = v;
			if(isNaN(v2)) {
				this.buf.add("k");
			} else if(!isFinite(v2)) {
				this.buf.add(v2 < 0 ? "m" : "p");
			} else {
				this.buf.add("d");
				this.buf.add(v2);
			}
			break;
		case 3:
			this.buf.add(v ? "t" : "f");
			break;
		case 4:
			if(Std["is"](v,Class)) {
				var className = Type.getClassName(v);
				this.buf.add("A");
				this.serializeString(className);
			} else if(Std["is"](v,Enum)) {
				this.buf.add("B");
				this.serializeString(Type.getEnumName(v));
			} else {
				if(this.useCache && this.serializeRef(v)) {
					return;
				}
				this.buf.add("o");
				this.serializeFields(v);
			}
			break;
		case 5:
			throw new js._Boot.HaxeError("Cannot serialize function");
			break;
		case 6:
			var c = _g[2];
			if(c == String) {
				this.serializeString(v);
				return;
			}
			if(this.useCache && this.serializeRef(v)) {
				return;
			}
			switch(c) {
			case Array:
				var ucount = 0;
				this.buf.add("a");
				var l = v["length"];
				var _g1 = 0;
				var _g2 = l;
				while(_g1 < _g2) {
					var i = _g1++;
					if(v[i] == null) {
						++ucount;
					} else {
						if(ucount > 0) {
							if(ucount == 1) {
								this.buf.add("n");
							} else {
								this.buf.add("u");
								this.buf.add(ucount);
							}
							ucount = 0;
						}
						this.serialize(v[i]);
					}
				}
				if(ucount > 0) {
					if(ucount == 1) {
						this.buf.add("n");
					} else {
						this.buf.add("u");
						this.buf.add(ucount);
					}
				}
				this.buf.add("h");
				break;
			case Date:
				var d = v;
				this.buf.add("v");
				this.buf.add(d.getTime());
				break;
			case List:
				this.buf.add("l");
				var v3 = v;
				var i1 = v3.iterator();
				while(i1.hasNext()) {
					var i2 = i1.next();
					this.serialize(i2);
				}
				this.buf.add("h");
				break;
			case haxe.ds.IntMap:
				this.buf.add("q");
				var v4 = v;
				var k = v4.keys();
				while(k.hasNext()) {
					var k1 = k.next();
					this.buf.add(":");
					this.buf.add(k1);
					this.serialize(v4.get(k1));
				}
				this.buf.add("h");
				break;
			case haxe.ds.ObjectMap:
				this.buf.add("M");
				var v5 = v;
				var k2 = v5.keys();
				while(k2.hasNext()) {
					var k3 = k2.next();
					var id = Reflect.field(k3,"__id__");
					Reflect.deleteField(k3,"__id__");
					this.serialize(k3);
					Reflect.setField(k3,"__id__",id);
					this.serialize(v5.get(k3));
				}
				this.buf.add("h");
				break;
			case haxe.ds.StringMap:
				this.buf.add("b");
				var v6 = v;
				var k4 = v6.keys();
				while(k4.hasNext()) {
					var k5 = k4.next();
					this.serializeString(k5);
					this.serialize(v6.get(k5));
				}
				this.buf.add("h");
				break;
			case haxe.io.Bytes:
				var v7 = v;
				this.buf.add("s");
				this.buf.add(Math.ceil(v7.length * 8 / 6));
				this.buf.add(":");
				var i3 = 0;
				var max = v7.length - 2;
				var b64 = haxe.Serializer.BASE64_CODES;
				if(b64 == null) {
					var length = haxe.Serializer.BASE64.length;
					var this1 = new Array(length);
					b64 = this1;
					var _g11 = 0;
					var _g3 = haxe.Serializer.BASE64.length;
					while(_g11 < _g3) {
						var i4 = _g11++;
						b64[i4] = HxOverrides.cca(haxe.Serializer.BASE64,i4);
					}
					haxe.Serializer.BASE64_CODES = b64;
				}
				while(i3 < max) {
					var b1 = v7.get(i3++);
					var b2 = v7.get(i3++);
					var b3 = v7.get(i3++);
					this.buf.addChar(b64[b1 >> 2]);
					this.buf.addChar(b64[(b1 << 4 | b2 >> 4) & 63]);
					this.buf.addChar(b64[(b2 << 2 | b3 >> 6) & 63]);
					this.buf.addChar(b64[b3 & 63]);
				}
				if(i3 == max) {
					var b11 = v7.get(i3++);
					var b21 = v7.get(i3++);
					this.buf.addChar(b64[b11 >> 2]);
					this.buf.addChar(b64[(b11 << 4 | b21 >> 4) & 63]);
					this.buf.addChar(b64[b21 << 2 & 63]);
				} else if(i3 == max + 1) {
					var b12 = v7.get(i3++);
					this.buf.addChar(b64[b12 >> 2]);
					this.buf.addChar(b64[b12 << 4 & 63]);
				}
				break;
			default:
				if(this.useCache) {
					this.cache.pop();
				}
				if(v.hxSerialize != null) {
					this.buf.add("C");
					this.serializeString(Type.getClassName(c));
					if(this.useCache) {
						this.cache.push(v);
					}
					v.hxSerialize(this);
					this.buf.add("g");
				} else {
					this.buf.add("c");
					this.serializeString(Type.getClassName(c));
					if(this.useCache) {
						this.cache.push(v);
					}
					this.serializeFields(v);
				}
			}
			break;
		case 7:
			var e = _g[2];
			if(this.useCache) {
				if(this.serializeRef(v)) {
					return;
				}
				this.cache.pop();
			}
			this.buf.add(this.useEnumIndex ? "j" : "w");
			this.serializeString(Type.getEnumName(e));
			if(this.useEnumIndex) {
				this.buf.add(":");
				this.buf.add(v[1]);
			} else {
				this.serializeString(v[0]);
			}
			this.buf.add(":");
			var l1 = v["length"];
			this.buf.add(l1 - 2);
			var _g12 = 2;
			var _g4 = l1;
			while(_g12 < _g4) {
				var i5 = _g12++;
				this.serialize(v[i5]);
			}
			if(this.useCache) {
				this.cache.push(v);
			}
			break;
		default:
			throw new js._Boot.HaxeError("Cannot serialize " + Std.string(v));
		}
	}
	,__class__: haxe.Serializer
};
haxe.Timer = $hxClasses["haxe.Timer"] = function(time_ms) {
	var me = this;
	this.id = setInterval(function() {
		me.run();
	},time_ms);
};
haxe.Timer.__name__ = ["haxe","Timer"];
haxe.Timer.delay = function(f,time_ms) {
	var t = new haxe.Timer(time_ms);
	t.run = function() {
		t.stop();
		f();
	};
	return t;
};
haxe.Timer.prototype = {
	id: null
	,stop: function() {
		if(this.id == null) {
			return;
		}
		clearInterval(this.id);
		this.id = null;
	}
	,run: function() {
	}
	,__class__: haxe.Timer
};
if(!haxe._Unserializer) haxe._Unserializer = {};
haxe._Unserializer.DefaultResolver = $hxClasses["haxe._Unserializer.DefaultResolver"] = function() {
};
haxe._Unserializer.DefaultResolver.__name__ = ["haxe","_Unserializer","DefaultResolver"];
haxe._Unserializer.DefaultResolver.prototype = {
	resolveClass: function(name) {
		return Type.resolveClass(name);
	}
	,resolveEnum: function(name) {
		return Type.resolveEnum(name);
	}
	,__class__: haxe._Unserializer.DefaultResolver
};
haxe.Unserializer = $hxClasses["haxe.Unserializer"] = function(buf) {
	this.buf = buf;
	this.length = buf.length;
	this.pos = 0;
	this.scache = [];
	this.cache = [];
	var r = haxe.Unserializer.DEFAULT_RESOLVER;
	if(r == null) {
		r = new haxe._Unserializer.DefaultResolver();
		haxe.Unserializer.DEFAULT_RESOLVER = r;
	}
	this.resolver = r;
};
haxe.Unserializer.__name__ = ["haxe","Unserializer"];
haxe.Unserializer.initCodes = function() {
	var codes = [];
	var _g1 = 0;
	var _g = haxe.Unserializer.BASE64.length;
	while(_g1 < _g) {
		var i = _g1++;
		codes[StringTools.fastCodeAt(haxe.Unserializer.BASE64,i)] = i;
	}
	return codes;
};
haxe.Unserializer.run = function(v) {
	return new haxe.Unserializer(v).unserialize();
};
haxe.Unserializer.prototype = {
	buf: null
	,pos: null
	,length: null
	,cache: null
	,scache: null
	,resolver: null
	,get: function(p) {
		return StringTools.fastCodeAt(this.buf,p);
	}
	,readDigits: function() {
		var k = 0;
		var s = false;
		var fpos = this.pos;
		while(true) {
			var c = this.get(this.pos);
			if(StringTools.isEof(c)) {
				break;
			}
			if(c == 45) {
				if(this.pos != fpos) {
					break;
				}
				s = true;
				this.pos++;
				continue;
			}
			if(c < 48 || c > 57) {
				break;
			}
			k = k * 10 + (c - 48);
			this.pos++;
		}
		if(s) {
			k *= -1;
		}
		return k;
	}
	,readFloat: function() {
		var p1 = this.pos;
		while(true) {
			var c = this.get(this.pos);
			if(StringTools.isEof(c)) {
				break;
			}
			if(c >= 43 && c < 58 || c == 101 || c == 69) {
				this.pos++;
			} else {
				break;
			}
		}
		return Std.parseFloat(HxOverrides.substr(this.buf,p1,this.pos - p1));
	}
	,unserializeObject: function(o) {
		while(true) {
			if(this.pos >= this.length) {
				throw new js._Boot.HaxeError("Invalid object");
			}
			if(this.get(this.pos) == 103) {
				break;
			}
			var k = this.unserialize();
			if(typeof(k) != "string") {
				throw new js._Boot.HaxeError("Invalid object key");
			}
			var v = this.unserialize();
			Reflect.setField(o,k,v);
		}
		this.pos++;
	}
	,unserializeEnum: function(edecl,tag) {
		if(this.get(this.pos++) != 58) {
			throw new js._Boot.HaxeError("Invalid enum format");
		}
		var nargs = this.readDigits();
		if(nargs == 0) {
			return Type.createEnum(edecl,tag);
		}
		var args = [];
		while(nargs-- > 0) args.push(this.unserialize());
		return Type.createEnum(edecl,tag,args);
	}
	,unserialize: function() {
		var _g = this.get(this.pos++);
		switch(_g) {
		case 65:
			var name = this.unserialize();
			var cl = this.resolver.resolveClass(name);
			if(cl == null) {
				throw new js._Boot.HaxeError("Class not found " + name);
			}
			return cl;
		case 66:
			var name1 = this.unserialize();
			var e = this.resolver.resolveEnum(name1);
			if(e == null) {
				throw new js._Boot.HaxeError("Enum not found " + name1);
			}
			return e;
		case 67:
			var name2 = this.unserialize();
			var cl1 = this.resolver.resolveClass(name2);
			if(cl1 == null) {
				throw new js._Boot.HaxeError("Class not found " + name2);
			}
			var o = Type.createEmptyInstance(cl1);
			this.cache.push(o);
			o.hxUnserialize(this);
			if(this.get(this.pos++) != 103) {
				throw new js._Boot.HaxeError("Invalid custom data");
			}
			return o;
		case 77:
			var h = new haxe.ds.ObjectMap();
			this.cache.push(h);
			var buf = this.buf;
			while(this.get(this.pos) != 104) {
				var s = this.unserialize();
				h.set(s,this.unserialize());
			}
			this.pos++;
			return h;
		case 82:
			var n = this.readDigits();
			if(n < 0 || n >= this.scache.length) {
				throw new js._Boot.HaxeError("Invalid string reference");
			}
			return this.scache[n];
		case 97:
			var buf1 = this.buf;
			var a = [];
			this.cache.push(a);
			while(true) {
				var c = this.get(this.pos);
				if(c == 104) {
					this.pos++;
					break;
				}
				if(c == 117) {
					this.pos++;
					var n1 = this.readDigits();
					a[a.length + n1 - 1] = null;
				} else {
					a.push(this.unserialize());
				}
			}
			return a;
		case 98:
			var h1 = new haxe.ds.StringMap();
			this.cache.push(h1);
			var buf2 = this.buf;
			while(this.get(this.pos) != 104) {
				var s1 = this.unserialize();
				h1.set(s1,this.unserialize());
			}
			this.pos++;
			return h1;
		case 99:
			var name3 = this.unserialize();
			var cl2 = this.resolver.resolveClass(name3);
			if(cl2 == null) {
				throw new js._Boot.HaxeError("Class not found " + name3);
			}
			var o1 = Type.createEmptyInstance(cl2);
			this.cache.push(o1);
			this.unserializeObject(o1);
			return o1;
		case 100:
			return this.readFloat();
		case 102:
			return false;
		case 105:
			return this.readDigits();
		case 106:
			var name4 = this.unserialize();
			var edecl = this.resolver.resolveEnum(name4);
			if(edecl == null) {
				throw new js._Boot.HaxeError("Enum not found " + name4);
			}
			this.pos++;
			var index = this.readDigits();
			var tag = Type.getEnumConstructs(edecl)[index];
			if(tag == null) {
				throw new js._Boot.HaxeError("Unknown enum index " + name4 + "@" + index);
			}
			var e1 = this.unserializeEnum(edecl,tag);
			this.cache.push(e1);
			return e1;
		case 107:
			return NaN;
		case 108:
			var l = new List();
			this.cache.push(l);
			var buf3 = this.buf;
			while(this.get(this.pos) != 104) l.add(this.unserialize());
			this.pos++;
			return l;
		case 109:
			return -Infinity;
		case 110:
			return null;
		case 111:
			var o2 = { };
			this.cache.push(o2);
			this.unserializeObject(o2);
			return o2;
		case 112:
			return Infinity;
		case 113:
			var h2 = new haxe.ds.IntMap();
			this.cache.push(h2);
			var buf4 = this.buf;
			var c1 = this.get(this.pos++);
			while(c1 == 58) {
				var i = this.readDigits();
				h2.set(i,this.unserialize());
				c1 = this.get(this.pos++);
			}
			if(c1 != 104) {
				throw new js._Boot.HaxeError("Invalid IntMap format");
			}
			return h2;
		case 114:
			var n2 = this.readDigits();
			if(n2 < 0 || n2 >= this.cache.length) {
				throw new js._Boot.HaxeError("Invalid reference");
			}
			return this.cache[n2];
		case 115:
			var len = this.readDigits();
			var buf5 = this.buf;
			if(this.get(this.pos++) != 58 || this.length - this.pos < len) {
				throw new js._Boot.HaxeError("Invalid bytes length");
			}
			var codes = haxe.Unserializer.CODES;
			if(codes == null) {
				codes = haxe.Unserializer.initCodes();
				haxe.Unserializer.CODES = codes;
			}
			var i1 = this.pos;
			var rest = len & 3;
			var size = (len >> 2) * 3 + (rest >= 2 ? rest - 1 : 0);
			var max = i1 + (len - rest);
			var bytes = haxe.io.Bytes.alloc(size);
			var bpos = 0;
			while(i1 < max) {
				var c11 = codes[StringTools.fastCodeAt(buf5,i1++)];
				var c2 = codes[StringTools.fastCodeAt(buf5,i1++)];
				bytes.set(bpos++,c11 << 2 | c2 >> 4);
				var c3 = codes[StringTools.fastCodeAt(buf5,i1++)];
				bytes.set(bpos++,c2 << 4 | c3 >> 2);
				var c4 = codes[StringTools.fastCodeAt(buf5,i1++)];
				bytes.set(bpos++,c3 << 6 | c4);
			}
			if(rest >= 2) {
				var c12 = codes[StringTools.fastCodeAt(buf5,i1++)];
				var c21 = codes[StringTools.fastCodeAt(buf5,i1++)];
				bytes.set(bpos++,c12 << 2 | c21 >> 4);
				if(rest == 3) {
					var c31 = codes[StringTools.fastCodeAt(buf5,i1++)];
					bytes.set(bpos++,c21 << 4 | c31 >> 2);
				}
			}
			this.pos += len;
			this.cache.push(bytes);
			return bytes;
		case 116:
			return true;
		case 118:
			var d;
			if(this.get(this.pos) >= 48 && this.get(this.pos) <= 57 && this.get(this.pos + 1) >= 48 && this.get(this.pos + 1) <= 57 && this.get(this.pos + 2) >= 48 && this.get(this.pos + 2) <= 57 && this.get(this.pos + 3) >= 48 && this.get(this.pos + 3) <= 57 && this.get(this.pos + 4) == 45) {
				d = HxOverrides.strDate(HxOverrides.substr(this.buf,this.pos,19));
				this.pos += 19;
			} else {
				var t = this.readFloat();
				d = new Date(t);
			}
			this.cache.push(d);
			return d;
		case 119:
			var name5 = this.unserialize();
			var edecl1 = this.resolver.resolveEnum(name5);
			if(edecl1 == null) {
				throw new js._Boot.HaxeError("Enum not found " + name5);
			}
			var e2 = this.unserializeEnum(edecl1,this.unserialize());
			this.cache.push(e2);
			return e2;
		case 120:
			throw js._Boot.HaxeError.wrap(this.unserialize());
			break;
		case 121:
			var len1 = this.readDigits();
			if(this.get(this.pos++) != 58 || this.length - this.pos < len1) {
				throw new js._Boot.HaxeError("Invalid string length");
			}
			var s2 = HxOverrides.substr(this.buf,this.pos,len1);
			this.pos += len1;
			s2 = StringTools.urlDecode(s2);
			this.scache.push(s2);
			return s2;
		case 122:
			return 0;
		default:
		}
		this.pos--;
		throw new js._Boot.HaxeError("Invalid char " + this.buf.charAt(this.pos) + " at position " + this.pos);
	}
	,__class__: haxe.Unserializer
};
if(!haxe.crypto) haxe.crypto = {};
haxe.crypto.Md5 = $hxClasses["haxe.crypto.Md5"] = function() {
};
haxe.crypto.Md5.__name__ = ["haxe","crypto","Md5"];
haxe.crypto.Md5.encode = function(s) {
	var m = new haxe.crypto.Md5();
	var h = m.doEncode(haxe.crypto.Md5.str2blks(s));
	return m.hex(h);
};
haxe.crypto.Md5.str2blks = function(str) {
	var str1 = haxe.io.Bytes.ofString(str);
	var nblk = (str1.length + 8 >> 6) + 1;
	var blks = [];
	var blksSize = nblk * 16;
	var _g1 = 0;
	var _g = blksSize;
	while(_g1 < _g) {
		var i = _g1++;
		blks[i] = 0;
	}
	var i1 = 0;
	var max = str1.length;
	var l = max * 8;
	while(i1 < max) {
		blks[i1 >> 2] |= str1.get(i1) << (l + i1) % 4 * 8;
		++i1;
	}
	blks[i1 >> 2] |= 128 << (l + i1) % 4 * 8;
	var k = nblk * 16 - 2;
	blks[k] = l & 255;
	blks[k] |= (l >>> 8 & 255) << 8;
	blks[k] |= (l >>> 16 & 255) << 16;
	blks[k] |= (l >>> 24 & 255) << 24;
	return blks;
};
haxe.crypto.Md5.prototype = {
	bitOR: function(a,b) {
		var lsb = a & 1 | b & 1;
		var msb31 = a >>> 1 | b >>> 1;
		return msb31 << 1 | lsb;
	}
	,bitXOR: function(a,b) {
		var lsb = a & 1 ^ b & 1;
		var msb31 = a >>> 1 ^ b >>> 1;
		return msb31 << 1 | lsb;
	}
	,bitAND: function(a,b) {
		var lsb = a & 1 & (b & 1);
		var msb31 = a >>> 1 & b >>> 1;
		return msb31 << 1 | lsb;
	}
	,addme: function(x,y) {
		var lsw = (x & 65535) + (y & 65535);
		var msw = (x >> 16) + (y >> 16) + (lsw >> 16);
		return msw << 16 | lsw & 65535;
	}
	,hex: function(a) {
		var str = "";
		var hex_chr = "0123456789abcdef";
		var _g = 0;
		while(_g < a.length) {
			var num = a[_g];
			++_g;
			var _g1 = 0;
			while(_g1 < 4) {
				var j = _g1++;
				str += hex_chr.charAt(num >> j * 8 + 4 & 15) + hex_chr.charAt(num >> j * 8 & 15);
			}
		}
		return str;
	}
	,rol: function(num,cnt) {
		return num << cnt | num >>> 32 - cnt;
	}
	,cmn: function(q,a,b,x,s,t) {
		return this.addme(this.rol(this.addme(this.addme(a,q),this.addme(x,t)),s),b);
	}
	,ff: function(a,b,c,d,x,s,t) {
		return this.cmn(this.bitOR(this.bitAND(b,c),this.bitAND(~b,d)),a,b,x,s,t);
	}
	,gg: function(a,b,c,d,x,s,t) {
		return this.cmn(this.bitOR(this.bitAND(b,d),this.bitAND(c,~d)),a,b,x,s,t);
	}
	,hh: function(a,b,c,d,x,s,t) {
		return this.cmn(this.bitXOR(this.bitXOR(b,c),d),a,b,x,s,t);
	}
	,ii: function(a,b,c,d,x,s,t) {
		return this.cmn(this.bitXOR(c,this.bitOR(b,~d)),a,b,x,s,t);
	}
	,doEncode: function(x) {
		var a = 1732584193;
		var b = -271733879;
		var c = -1732584194;
		var d = 271733878;
		var step;
		var i = 0;
		while(i < x.length) {
			var olda = a;
			var oldb = b;
			var oldc = c;
			var oldd = d;
			step = 0;
			a = this.ff(a,b,c,d,x[i],7,-680876936);
			d = this.ff(d,a,b,c,x[i + 1],12,-389564586);
			c = this.ff(c,d,a,b,x[i + 2],17,606105819);
			b = this.ff(b,c,d,a,x[i + 3],22,-1044525330);
			a = this.ff(a,b,c,d,x[i + 4],7,-176418897);
			d = this.ff(d,a,b,c,x[i + 5],12,1200080426);
			c = this.ff(c,d,a,b,x[i + 6],17,-1473231341);
			b = this.ff(b,c,d,a,x[i + 7],22,-45705983);
			a = this.ff(a,b,c,d,x[i + 8],7,1770035416);
			d = this.ff(d,a,b,c,x[i + 9],12,-1958414417);
			c = this.ff(c,d,a,b,x[i + 10],17,-42063);
			b = this.ff(b,c,d,a,x[i + 11],22,-1990404162);
			a = this.ff(a,b,c,d,x[i + 12],7,1804603682);
			d = this.ff(d,a,b,c,x[i + 13],12,-40341101);
			c = this.ff(c,d,a,b,x[i + 14],17,-1502002290);
			b = this.ff(b,c,d,a,x[i + 15],22,1236535329);
			a = this.gg(a,b,c,d,x[i + 1],5,-165796510);
			d = this.gg(d,a,b,c,x[i + 6],9,-1069501632);
			c = this.gg(c,d,a,b,x[i + 11],14,643717713);
			b = this.gg(b,c,d,a,x[i],20,-373897302);
			a = this.gg(a,b,c,d,x[i + 5],5,-701558691);
			d = this.gg(d,a,b,c,x[i + 10],9,38016083);
			c = this.gg(c,d,a,b,x[i + 15],14,-660478335);
			b = this.gg(b,c,d,a,x[i + 4],20,-405537848);
			a = this.gg(a,b,c,d,x[i + 9],5,568446438);
			d = this.gg(d,a,b,c,x[i + 14],9,-1019803690);
			c = this.gg(c,d,a,b,x[i + 3],14,-187363961);
			b = this.gg(b,c,d,a,x[i + 8],20,1163531501);
			a = this.gg(a,b,c,d,x[i + 13],5,-1444681467);
			d = this.gg(d,a,b,c,x[i + 2],9,-51403784);
			c = this.gg(c,d,a,b,x[i + 7],14,1735328473);
			b = this.gg(b,c,d,a,x[i + 12],20,-1926607734);
			a = this.hh(a,b,c,d,x[i + 5],4,-378558);
			d = this.hh(d,a,b,c,x[i + 8],11,-2022574463);
			c = this.hh(c,d,a,b,x[i + 11],16,1839030562);
			b = this.hh(b,c,d,a,x[i + 14],23,-35309556);
			a = this.hh(a,b,c,d,x[i + 1],4,-1530992060);
			d = this.hh(d,a,b,c,x[i + 4],11,1272893353);
			c = this.hh(c,d,a,b,x[i + 7],16,-155497632);
			b = this.hh(b,c,d,a,x[i + 10],23,-1094730640);
			a = this.hh(a,b,c,d,x[i + 13],4,681279174);
			d = this.hh(d,a,b,c,x[i],11,-358537222);
			c = this.hh(c,d,a,b,x[i + 3],16,-722521979);
			b = this.hh(b,c,d,a,x[i + 6],23,76029189);
			a = this.hh(a,b,c,d,x[i + 9],4,-640364487);
			d = this.hh(d,a,b,c,x[i + 12],11,-421815835);
			c = this.hh(c,d,a,b,x[i + 15],16,530742520);
			b = this.hh(b,c,d,a,x[i + 2],23,-995338651);
			a = this.ii(a,b,c,d,x[i],6,-198630844);
			d = this.ii(d,a,b,c,x[i + 7],10,1126891415);
			c = this.ii(c,d,a,b,x[i + 14],15,-1416354905);
			b = this.ii(b,c,d,a,x[i + 5],21,-57434055);
			a = this.ii(a,b,c,d,x[i + 12],6,1700485571);
			d = this.ii(d,a,b,c,x[i + 3],10,-1894986606);
			c = this.ii(c,d,a,b,x[i + 10],15,-1051523);
			b = this.ii(b,c,d,a,x[i + 1],21,-2054922799);
			a = this.ii(a,b,c,d,x[i + 8],6,1873313359);
			d = this.ii(d,a,b,c,x[i + 15],10,-30611744);
			c = this.ii(c,d,a,b,x[i + 6],15,-1560198380);
			b = this.ii(b,c,d,a,x[i + 13],21,1309151649);
			a = this.ii(a,b,c,d,x[i + 4],6,-145523070);
			d = this.ii(d,a,b,c,x[i + 11],10,-1120210379);
			c = this.ii(c,d,a,b,x[i + 2],15,718787259);
			b = this.ii(b,c,d,a,x[i + 9],21,-343485551);
			a = this.addme(a,olda);
			b = this.addme(b,oldb);
			c = this.addme(c,oldc);
			d = this.addme(d,oldd);
			i += 16;
		}
		return [a,b,c,d];
	}
	,__class__: haxe.crypto.Md5
};
if(!haxe.ds) haxe.ds = {};
haxe.ds.IntMap = $hxClasses["haxe.ds.IntMap"] = function() {
	this.h = { };
};
haxe.ds.IntMap.__name__ = ["haxe","ds","IntMap"];
haxe.ds.IntMap.__interfaces__ = [haxe.IMap];
haxe.ds.IntMap.prototype = {
	h: null
	,set: function(key,value) {
		this.h[key] = value;
	}
	,get: function(key) {
		return this.h[key];
	}
	,keys: function() {
		var a = [];
		for( var key in this.h ) if(this.h.hasOwnProperty(key)) {
			a.push(key | 0);
		}
		return HxOverrides.iter(a);
	}
	,__class__: haxe.ds.IntMap
};
haxe.ds.ObjectMap = $hxClasses["haxe.ds.ObjectMap"] = function() {
	this.h = { __keys__ : { }};
};
haxe.ds.ObjectMap.__name__ = ["haxe","ds","ObjectMap"];
haxe.ds.ObjectMap.__interfaces__ = [haxe.IMap];
haxe.ds.ObjectMap.assignId = function(obj) {
	return obj.__id__ = ++haxe.ds.ObjectMap.count;
};
haxe.ds.ObjectMap.getId = function(obj) {
	return obj.__id__;
};
haxe.ds.ObjectMap.prototype = {
	h: null
	,set: function(key,value) {
		var id = haxe.ds.ObjectMap.getId(key) || haxe.ds.ObjectMap.assignId(key);
		this.h[id] = value;
		this.h.__keys__[id] = key;
	}
	,get: function(key) {
		return this.h[haxe.ds.ObjectMap.getId(key)];
	}
	,exists: function(key) {
		return this.h.__keys__[haxe.ds.ObjectMap.getId(key)] != null;
	}
	,keys: function() {
		var a = [];
		for( var key in this.h.__keys__ ) {
		if(this.h.hasOwnProperty(key)) {
			a.push(this.h.__keys__[key]);
		}
		}
		return HxOverrides.iter(a);
	}
	,__class__: haxe.ds.ObjectMap
};
if(!haxe.ds._StringMap) haxe.ds._StringMap = {};
haxe.ds._StringMap.StringMapIterator = $hxClasses["haxe.ds._StringMap.StringMapIterator"] = function(map,keys) {
	this.map = map;
	this.keys = keys;
	this.index = 0;
	this.count = keys.length;
};
haxe.ds._StringMap.StringMapIterator.__name__ = ["haxe","ds","_StringMap","StringMapIterator"];
haxe.ds._StringMap.StringMapIterator.prototype = {
	map: null
	,keys: null
	,index: null
	,count: null
	,hasNext: function() {
		return this.index < this.count;
	}
	,next: function() {
		return this.map.get(this.keys[this.index++]);
	}
	,__class__: haxe.ds._StringMap.StringMapIterator
};
haxe.ds.StringMap = $hxClasses["haxe.ds.StringMap"] = function() {
	this.h = { };
};
haxe.ds.StringMap.__name__ = ["haxe","ds","StringMap"];
haxe.ds.StringMap.__interfaces__ = [haxe.IMap];
haxe.ds.StringMap.prototype = {
	h: null
	,rh: null
	,isReserved: function(key) {
		return __map_reserved[key] != null;
	}
	,set: function(key,value) {
		if(this.isReserved(key)) {
			this.setReserved(key,value);
		} else {
			this.h[key] = value;
		}
	}
	,get: function(key) {
		if(this.isReserved(key)) {
			return this.getReserved(key);
		}
		return this.h[key];
	}
	,exists: function(key) {
		if(this.isReserved(key)) {
			return this.existsReserved(key);
		}
		return this.h.hasOwnProperty(key);
	}
	,setReserved: function(key,value) {
		if(this.rh == null) {
			this.rh = { };
		}
		this.rh["$" + key] = value;
	}
	,getReserved: function(key) {
		if(this.rh == null) {
			return null;
		} else {
			return this.rh["$" + key];
		}
	}
	,existsReserved: function(key) {
		if(this.rh == null) {
			return false;
		}
		return this.rh.hasOwnProperty("$" + key);
	}
	,remove: function(key) {
		if(this.isReserved(key)) {
			key = "$" + key;
			if(this.rh == null || !this.rh.hasOwnProperty(key)) {
				return false;
			}
			delete(this.rh[key]);
			return true;
		} else {
			if(!this.h.hasOwnProperty(key)) {
				return false;
			}
			delete(this.h[key]);
			return true;
		}
	}
	,keys: function() {
		return HxOverrides.iter(this.arrayKeys());
	}
	,arrayKeys: function() {
		var out = [];
		for( var key in this.h ) {
		if(this.h.hasOwnProperty(key)) {
			out.push(key);
		}
		}
		if(this.rh != null) {
			for( var key in this.rh ) {
			if(key.charCodeAt(0) == 36) {
				out.push(key.substr(1));
			}
			}
		}
		return out;
	}
	,iterator: function() {
		return new haxe.ds._StringMap.StringMapIterator(this,this.arrayKeys());
	}
	,toString: function() {
		var s = new StringBuf();
		s.add("{");
		var keys = this.arrayKeys();
		var _g1 = 0;
		var _g = keys.length;
		while(_g1 < _g) {
			var i = _g1++;
			var k = keys[i];
			s.add(k);
			s.add(" => ");
			s.add(Std.string(this.get(k)));
			if(i < keys.length - 1) {
				s.add(", ");
			}
		}
		s.add("}");
		return s.toString();
	}
	,__class__: haxe.ds.StringMap
};
if(!haxe.io) haxe.io = {};
haxe.io.Bytes = $hxClasses["haxe.io.Bytes"] = function(length,b) {
	this.length = length;
	this.b = b;
};
haxe.io.Bytes.__name__ = ["haxe","io","Bytes"];
haxe.io.Bytes.alloc = function(length) {
	return new haxe.io.Bytes(length,new Buffer(length));
};
haxe.io.Bytes.ofString = function(s) {
	var nb = new Buffer(s,"utf8");
	return new haxe.io.Bytes(nb.length,nb);
};
haxe.io.Bytes.ofData = function(b) {
	return new haxe.io.Bytes(b.length,b);
};
haxe.io.Bytes.prototype = {
	length: null
	,b: null
	,get: function(pos) {
		return this.b[pos];
	}
	,set: function(pos,v) {
		this.b[pos] = v;
	}
	,blit: function(pos,src,srcpos,len) {
		if(pos < 0 || srcpos < 0 || len < 0 || pos + len > this.length || srcpos + len > src.length) {
			throw new js._Boot.HaxeError(haxe.io.Error.OutsideBounds);
		}
		src.getData().copy(this.b,pos,srcpos,srcpos + len);
	}
	,sub: function(pos,len) {
		if(pos < 0 || len < 0 || pos + len > this.length) {
			throw new js._Boot.HaxeError(haxe.io.Error.OutsideBounds);
		}
		var nb = new Buffer(len);
		var slice = this.b.slice(pos,pos + len);
		slice.copy(nb,0,0,len);
		return new haxe.io.Bytes(len,nb);
	}
	,compare: function(other) {
		var b1 = this.b;
		var b2 = other.b;
		var len = this.length < other.length ? this.length : other.length;
		var _g1 = 0;
		var _g = len;
		while(_g1 < _g) {
			var i = _g1++;
			if(b1[i] != b2[i]) {
				return b1[i] - b2[i];
			}
		}
		return this.length - other.length;
	}
	,getString: function(pos,len) {
		if(pos < 0 || len < 0 || pos + len > this.length) {
			throw new js._Boot.HaxeError(haxe.io.Error.OutsideBounds);
		}
		var s = "";
		var b = this.b;
		var fcc = String.fromCharCode;
		var i = pos;
		var max = pos + len;
		while(i < max) {
			var c = b[i++];
			if(c < 128) {
				if(c == 0) {
					break;
				}
				s += fcc(c);
			} else if(c < 224) {
				s += fcc((c & 63) << 6 | b[i++] & 127);
			} else if(c < 240) {
				var c2 = b[i++];
				s += fcc((c & 31) << 12 | (c2 & 127) << 6 | b[i++] & 127);
			} else {
				var c21 = b[i++];
				var c3 = b[i++];
				s += fcc((c & 15) << 18 | (c21 & 127) << 12 | c3 << 6 & 127 | b[i++] & 127);
			}
		}
		return s;
	}
	,readString: function(pos,len) {
		return this.getString(pos,len);
	}
	,toString: function() {
		return this.getString(0,this.length);
	}
	,toHex: function() {
		var s = new StringBuf();
		var chars = [];
		var str = "0123456789abcdef";
		var _g1 = 0;
		var _g = str.length;
		while(_g1 < _g) {
			var i = _g1++;
			chars.push(HxOverrides.cca(str,i));
		}
		var _g11 = 0;
		var _g2 = this.length;
		while(_g11 < _g2) {
			var i1 = _g11++;
			var c = this.get(i1);
			s.addChar(chars[c >> 4]);
			s.addChar(chars[c & 15]);
		}
		return s.toString();
	}
	,getData: function() {
		return this.b;
	}
	,__class__: haxe.io.Bytes
};
haxe.io.Error = $hxClasses["haxe.io.Error"] = { __ename__ : ["haxe","io","Error"], __constructs__ : ["Blocked","Overflow","OutsideBounds","Custom"] };
haxe.io.Error.Blocked = ["Blocked",0];
haxe.io.Error.Blocked.toString = $estr;
haxe.io.Error.Blocked.__enum__ = haxe.io.Error;
haxe.io.Error.Overflow = ["Overflow",1];
haxe.io.Error.Overflow.toString = $estr;
haxe.io.Error.Overflow.__enum__ = haxe.io.Error;
haxe.io.Error.OutsideBounds = ["OutsideBounds",2];
haxe.io.Error.OutsideBounds.toString = $estr;
haxe.io.Error.OutsideBounds.__enum__ = haxe.io.Error;
haxe.io.Error.Custom = function(e) { var $x = ["Custom",3,e]; $x.__enum__ = haxe.io.Error; $x.toString = $estr; return $x; };
var js = js || {};
if(!js._Boot) js._Boot = {};
js._Boot.HaxeError = $hxClasses["js._Boot.HaxeError"] = function(val) {
	Error.call(this);
	this.val = val;
	this.message = String(val);
	if(Error.captureStackTrace) {
		Error.captureStackTrace(this,js._Boot.HaxeError);
	}
};
js._Boot.HaxeError.__name__ = ["js","_Boot","HaxeError"];
js._Boot.HaxeError.wrap = function(val) {
	if((val instanceof Error)) {
		return val;
	} else {
		return new js._Boot.HaxeError(val);
	}
};
js._Boot.HaxeError.__super__ = Error;
js._Boot.HaxeError.prototype = $extend(Error.prototype,{
	val: null
	,__class__: js._Boot.HaxeError
});
js.Boot = $hxClasses["js.Boot"] = function() { };
js.Boot.__name__ = ["js","Boot"];
js.Boot.isClass = function(o) {
	return o.__name__;
};
js.Boot.isEnum = function(e) {
	return e.__ename__;
};
js.Boot.getClass = function(o) {
	if((o instanceof Array) && o.__enum__ == null) {
		return Array;
	} else {
		var cl = o.__class__;
		if(cl != null) {
			return cl;
		}
		var name = js.Boot.__nativeClassName(o);
		if(name != null) {
			return js.Boot.__resolveNativeClass(name);
		}
		return null;
	}
};
js.Boot.__string_rec = function(o,s) {
	if(o == null) {
		return "null";
	}
	if(s.length >= 5) {
		return "<...>";
	}
	var t = typeof(o);
	if(t == "function" && (js.Boot.isClass(o) || js.Boot.isEnum(o))) {
		t = "object";
	}
	switch(t) {
	case "function":
		return "<function>";
	case "object":
		if(o instanceof Array) {
			if(o.__enum__) {
				if(o.length == 2) {
					return o[0];
				}
				var str = o[0] + "(";
				s += "\t";
				var _g1 = 2;
				var _g = o.length;
				while(_g1 < _g) {
					var i = _g1++;
					if(i != 2) {
						str += "," + js.Boot.__string_rec(o[i],s);
					} else {
						str += js.Boot.__string_rec(o[i],s);
					}
				}
				return str + ")";
			}
			var l = o.length;
			var i1;
			var str1 = "[";
			s += "\t";
			var _g11 = 0;
			var _g2 = l;
			while(_g11 < _g2) {
				var i2 = _g11++;
				str1 += (i2 > 0 ? "," : "") + js.Boot.__string_rec(o[i2],s);
			}
			str1 += "]";
			return str1;
		}
		var tostr;
		try {
			tostr = o.toString;
		} catch( e ) {
			return "???";
		}
		if(tostr != null && tostr != Object.toString && typeof(tostr) == "function") {
			var s2 = o.toString();
			if(s2 != "[object Object]") {
				return s2;
			}
		}
		var k = null;
		var str2 = "{\n";
		s += "\t";
		var hasp = o.hasOwnProperty != null;
		for( var k in o ) {
		if(hasp && !o.hasOwnProperty(k)) {
			continue;
		}
		if(k == "prototype" || k == "__class__" || k == "__super__" || k == "__interfaces__" || k == "__properties__") {
			continue;
		}
		if(str2.length != 2) {
			str2 += ", \n";
		}
		str2 += s + k + " : " + js.Boot.__string_rec(o[k],s);
		}
		s = s.substring(1);
		str2 += "\n" + s + "}";
		return str2;
	case "string":
		return o;
	default:
		return String(o);
	}
};
js.Boot.__interfLoop = function(cc,cl) {
	if(cc == null) {
		return false;
	}
	if(cc == cl) {
		return true;
	}
	var intf = cc.__interfaces__;
	if(intf != null) {
		var _g1 = 0;
		var _g = intf.length;
		while(_g1 < _g) {
			var i = _g1++;
			var i1 = intf[i];
			if(i1 == cl || js.Boot.__interfLoop(i1,cl)) {
				return true;
			}
		}
	}
	return js.Boot.__interfLoop(cc.__super__,cl);
};
js.Boot.__instanceof = function(o,cl) {
	if(cl == null) {
		return false;
	}
	switch(cl) {
	case Array:
		if((o instanceof Array)) {
			return o.__enum__ == null;
		} else {
			return false;
		}
		break;
	case Bool:
		return typeof(o) == "boolean";
	case Dynamic:
		return true;
	case Float:
		return typeof(o) == "number";
	case Int:
		if(typeof(o) == "number") {
			return (o|0) === o;
		} else {
			return false;
		}
		break;
	case String:
		return typeof(o) == "string";
	default:
		if(o != null) {
			if(typeof(cl) == "function") {
				if(o instanceof cl) {
					return true;
				}
				if(js.Boot.__interfLoop(js.Boot.getClass(o),cl)) {
					return true;
				}
			} else if(typeof(cl) == "object" && js.Boot.__isNativeObj(cl)) {
				if(o instanceof cl) {
					return true;
				}
			}
		} else {
			return false;
		}
		if(cl == Class ? o.__name__ != null : false) {
			return true;
		}
		if(cl == Enum ? o.__ename__ != null : false) {
			return true;
		}
		return o.__enum__ == cl;
	}
};
js.Boot.__cast = function(o,t) {
	if(js.Boot.__instanceof(o,t)) {
		return o;
	} else {
		throw new js._Boot.HaxeError("Cannot cast " + Std.string(o) + " to " + Std.string(t));
	}
};
js.Boot.__nativeClassName = function(o) {
	var name = js.Boot.__toStr.call(o).slice(8,-1);
	if(name == "Object" || name == "Function" || name == "Math" || name == "JSON") {
		return null;
	}
	return name;
};
js.Boot.__isNativeObj = function(o) {
	return js.Boot.__nativeClassName(o) != null;
};
js.Boot.__resolveNativeClass = function(name) {
	return $global[name];
};
js.Browser = $hxClasses["js.Browser"] = function() { };
js.Browser.__name__ = ["js","Browser"];
js.Browser.get_window = function() {
	return window;
};
js.Browser.get_location = function() {
	return window.location;
};
js.Lib = $hxClasses["js.Lib"] = function() { };
js.Lib.__name__ = ["js","Lib"];
js.Lib.get_undefined = function() {
	return undefined;
};
js.NodeC = $hxClasses["js.NodeC"] = function() { };
js.NodeC.__name__ = ["js","NodeC"];
js.Node = $hxClasses["js.Node"] = function() { };
js.Node.__name__ = ["js","Node"];
js.Node.get_assert = function() {
	return js.Node.require("assert");
};
js.Node.get_child_process = function() {
	return js.Node.require("child_process");
};
js.Node.get_cluster = function() {
	return js.Node.require("cluster");
};
js.Node.get_crypto = function() {
	return js.Node.require("crypto");
};
js.Node.get_dgram = function() {
	return js.Node.require("dgram");
};
js.Node.get_dns = function() {
	return js.Node.require("dns");
};
js.Node.get_fs = function() {
	return js.Node.require("fs");
};
js.Node.get_http = function() {
	return js.Node.require("http");
};
js.Node.get_https = function() {
	return js.Node.require("https");
};
js.Node.get_net = function() {
	return js.Node.require("net");
};
js.Node.get_os = function() {
	return js.Node.require("os");
};
js.Node.get_path = function() {
	return js.Node.require("path");
};
js.Node.get_querystring = function() {
	return js.Node.require("querystring");
};
js.Node.get_repl = function() {
	return js.Node.require("repl");
};
js.Node.get_tls = function() {
	return js.Node.require("tls");
};
js.Node.get_url = function() {
	return js.Node.require("url");
};
js.Node.get_util = function() {
	return js.Node.require("util");
};
js.Node.get_vm = function() {
	return js.Node.require("vm");
};
js.Node.get_zlib = function() {
	return js.Node.require("zlib");
};
js.Node.get___filename = function() {
	return __filename;
};
js.Node.get___dirname = function() {
	return __dirname;
};
js.Node.get_json = function() {
	return JSON;
};
js.Node.newSocket = function(options) {
	return new js.Node.net.Socket(options);
};
js.Node.isNodeWebkit = function() {
	return (typeof process == "object");
};
var saturn = saturn || {};
if(!saturn.app) saturn.app = {};
saturn.app.SaturnServer = $hxClasses["saturn.app.SaturnServer"] = function() {
	this.usingEncryption = false;
	this.__dirname = js.Node.get___dirname();
	this.restify = js.Node.require("restify");
	this.osLib = js.Node.require("os");
	this.execLib = js.Node.require("child_process");
	this.domainLib = js.Node.require("domain");
	this.httpLib = js.Node.require("http");
	this.cryptoLib = js.Node.require("crypto");
	this.tempLib = js.Node.require("temp");
	this.pathLib = js.Node.require("path");
	this.fsExtraLib = js.Node.require("fs-extra");
	this.fsLib = js.Node.require("fs");
	this.serviceConfigs = new haxe.ds.StringMap();
	this.socketPlugins = [];
	this.plugins = [];
	if(js.Node.process.argv.length == 3) {
		this.servicesFile = js.Node.process.argv[2];
		this.loadServiceDefinition(function() {
		});
	} else {
		this.debug("Usage\tServices File\n");
		js.Node.process.exit(-1);
	}
};
saturn.app.SaturnServer.__name__ = ["saturn","app","SaturnServer"];
saturn.app.SaturnServer.main = function() {
	saturn.app.SaturnServer.defaultServer = new saturn.app.SaturnServer();
};
saturn.app.SaturnServer.getDefaultServer = function() {
	return saturn.app.SaturnServer.defaultServer;
};
saturn.app.SaturnServer.debuglog = function(name,value) {
	saturn.app.SaturnServer.DEBUG(name,value);
};
saturn.app.SaturnServer.getStandardUserInputError = function() {
	return "Invalid User Input";
};
saturn.app.SaturnServer.makeStaticAvailable = function(filePath,cb) {
	var outputPath = saturn.app.SaturnServer.getDefaultServer().getRelativePublicOuputFolder() + "/" + Std.string(saturn.app.SaturnServer.getDefaultServer().pathLib.basename(filePath)) + ".txt";
	var remotePath = saturn.app.SaturnServer.getDefaultServer().getRelativePublicOuputURL() + "/" + Std.string(saturn.app.SaturnServer.getDefaultServer().pathLib.basename(filePath)) + ".txt";
	bindings.NodeFSExtra.copy(filePath,outputPath,function(err) {
		cb(err,remotePath);
	});
};
saturn.app.SaturnServer.prototype = {
	fsLib: null
	,fsExtraLib: null
	,pathLib: null
	,tempLib: null
	,cryptoLib: null
	,httpLib: null
	,domainLib: null
	,execLib: null
	,osLib: null
	,restify: null
	,__dirname: null
	,server: null
	,theServerSocket: null
	,serviceConfigs: null
	,serviceConfig: null
	,servicesFile: null
	,localServerConfig: null
	,port: null
	,redisPort: null
	,socketPlugins: null
	,plugins: null
	,redisClient: null
	,internalConnectionHostName: null
	,authPlugin: null
	,usingEncryption: null
	,isEncrypted: function() {
		return this.usingEncryption;
	}
	,getInternalConnectionHostName: function() {
		return this.internalConnectionHostName;
	}
	,getRedisPort: function() {
		return this.redisPort;
	}
	,getPort: function() {
		return this.port;
	}
	,getHostname: function() {
		return this.getServerConfig().hostname;
	}
	,getServerConfig: function() {
		return this.localServerConfig;
	}
	,initialiseServer: function(index_page) {
		var _gthis = this;
		var http_config = { };
		var serverConfig = this.getServerConfig();
		if(Reflect.hasField(serverConfig,"internalConnectionHostName")) {
			this.internalConnectionHostName = Reflect.field(serverConfig,"internalConnectionHostName");
		} else {
			this.internalConnectionHostName = Reflect.field(serverConfig,"hostname");
		}
		if(Reflect.hasField(serverConfig,"restify_http_options")) {
			http_config = Reflect.field(serverConfig,"restify_http_options");
			saturn.core.Util.debug(saturn.core.Util.string(http_config));
			if(Reflect.hasField(http_config,"cert")) {
				var certificate = Reflect.field(http_config,"cert");
				if(certificate != null && certificate != "") {
					this.usingEncryption = true;
					this.server = this.restify.createServer({ "httpsServerOptions" : http_config});
				}
			}
		} else {
			this.server = this.restify.createServer();
		}
		var bunyan = js.Node.require("bunyan");
		var $process = js.Node.require("process");
		if(!js.Node.process.env.BUNYAN_OFF) {
			this.server.on("after",this.restify.plugins.auditLogger({ log : bunyan.createLogger({ name : "audit", stream : $process.stdout}), body : true, event : "after"}));
		}
		this.server["use"](this.restify.plugins.queryParser({ mapParams : true}));
		this.server["use"](this.restify.plugins.bodyParser({ mapParams : true}));
		var CookieParser = js.Node.require("restify-cookies");
		this.server["use"](CookieParser.parse);
		this.installPlugins();
		this.installSocketPlugins();
		this.server.get("/static/*",this.restify.plugins.serveStatic({ directory : "./public"}));
		this.server.get("/",function(req,res,next) {
			res.header("Location",index_page);
			res.send(302);
			return next(false);
		});
		this.configureRedisClient();
		if(saturn.app.SaturnServer.beforeListen != null) {
			saturn.app.SaturnServer.beforeListen();
		}
		this.server.listen(this.port,serverConfig.hostname,function() {
			_gthis.debug("Server listening at " + Std.string(_gthis.server.url));
		});
		if(saturn.app.SaturnServer.afterListen != null) {
			saturn.app.SaturnServer.afterListen();
		}
	}
	,installSocketPlugins: function() {
		var _gthis = this;
		if(Reflect.hasField(this.getServerConfig(),"socket_plugins")) {
			var pluginDefs = this.getServerConfig().socket_plugins;
			var _g = 0;
			while(_g < pluginDefs.length) {
				var pluginDef = pluginDefs[_g];
				++_g;
				this.debug("PLUGIN: " + Std.string(pluginDef.clazz));
				var plugin = Type.createInstance(Type.resolveClass(pluginDef.clazz),[this,pluginDef]);
				this.socketPlugins.push(plugin);
			}
			var Queue = js.Node.require("bull");
			this.theServerSocket.sockets.on("connection",function(socket) {
				var _g1 = 0;
				var _g11 = _gthis.socketPlugins;
				while(_g1 < _g11.length) {
					var plugin1 = _g11[_g1];
					++_g1;
					plugin1.addListeners(socket);
				}
			});
		}
	}
	,installPlugins: function() {
		if(Reflect.hasField(this.getServerConfig(),"plugins")) {
			var pluginDefs = this.getServerConfig().plugins;
			var _g = 0;
			while(_g < pluginDefs.length) {
				var pluginDef = pluginDefs[_g];
				++_g;
				this.debug("PLUGIN: " + Std.string(pluginDef.clazz));
				var plugin = Type.createInstance(Type.resolveClass(pluginDef.clazz),[this,pluginDef]);
				this.plugins.push(plugin);
			}
		}
	}
	,loadServiceDefinition: function(__return) {
		var _gthis = this;
		var __afterVar_0 = function(err,content) {
			if(err == null) {
				_gthis.serviceConfig = js.Node.get_json().parse(content);
				if(Reflect.hasField(_gthis.serviceConfig,"port")) {
					_gthis.port = _gthis.serviceConfig.port;
					if(Reflect.hasField(_gthis.serviceConfig,"redis_port")) {
						_gthis.redisPort = _gthis.serviceConfig.redis_port;
						_gthis.serviceConfigs.set("localhost: " + _gthis.port,_gthis.serviceConfig);
						_gthis.localServerConfig = _gthis.serviceConfig;
						_gthis.initialiseServer(_gthis.serviceConfig.index_page);
						__return();
					} else {
						_gthis.debug("Service config is missing redis_port property");
						js.Node.process.exit(-1);
						__return();
					}
				} else {
					_gthis.debug("Service config is missing port property");
					js.Node.process.exit(-1);
					__return();
				}
			} else {
				_gthis.debug(err);
				js.Node.process.exit(-1);
				__return();
			}
		};
		js.Node.get_fs().readFile(_gthis.servicesFile,{ "encoding" : "utf8"},function(__parameter_1,__parameter_2) {
			__afterVar_0(__parameter_1,__parameter_2);
		});
	}
	,debug: function(msg) {
		saturn.app.SaturnServer.DEBUG(msg);
	}
	,getStandardErrorCode: function() {
		return "H2IK";
	}
	,getRelativePublicStorageFolder: function() {
		return "public/static";
	}
	,getRelativePublicStorageURL: function() {
		return "static";
	}
	,getRelativePublicOuputFolder: function() {
		return this.getRelativePublicStorageFolder() + "/out";
	}
	,getRelativePublicOuputURL: function() {
		return this.getRelativePublicStorageURL() + "/out";
	}
	,getPythonPath: function() {
		if(js.Node.get_os().platform() == "win32") {
			return "C:/python27/Python.exe";
		} else {
			return "/opt/python/python_builds/python-2.7.7/bin/python";
		}
	}
	,getServer: function() {
		return this.server;
	}
	,getServerSocket: function() {
		return this.theServerSocket;
	}
	,setServerSocket: function(socket) {
		this.theServerSocket = socket;
	}
	,installLogin: function() {
	}
	,getSocketUser: function(socket,cb) {
		this.isSocketAuthenticated(socket,cb);
	}
	,setUser: function(socket,user) {
		socket.decoded_token = user;
	}
	,isSocketAuthenticated: function(socket,cb) {
		if(socket.decoded_token) {
			var user = this.getSocketUserNoAuthCheck(socket);
			this.isUserAuthenticated(user,cb);
		} else {
			cb(null);
		}
	}
	,getSocketUserNoAuthCheck: function(socket) {
		return socket.decoded_token;
	}
	,isUserAuthenticated: function(user,cb) {
		this.getAuthenticationPlugin().isUserAuthenticated(user,cb);
	}
	,configureRedisClient: function() {
		var _gthis = this;
		var redis = js.Node.require("redis");
		var tmp = this.getRedisPort();
		var tmp1 = this.getHostname();
		this.redisClient = redis.createClient(tmp,tmp1);
		this.redisClient.on("error",function(err) {
			_gthis.debug("Redis Error " + err);
			js.Node.process.exit(-1);
		});
	}
	,getRedisClient: function() {
		return this.redisClient;
	}
	,setAuthenticationPlugin: function(authPlugin) {
		this.authPlugin = authPlugin;
	}
	,getAuthenticationPlugin: function() {
		return this.authPlugin;
	}
	,__class__: saturn.app.SaturnServer
};
if(!saturn.client) saturn.client = {};
if(!saturn.client.core) saturn.client.core = {};
saturn.client.core.CommonCore = $hxClasses["saturn.client.core.CommonCore"] = function() { };
saturn.client.core.CommonCore.__name__ = ["saturn","client","core","CommonCore"];
saturn.client.core.CommonCore.setDefaultProvider = function(provider,name,defaultProvider) {
	if(name == null) {
		name = "DEFAULT";
	}
	saturn.client.core.CommonCore.providers.set(name,provider);
	if(defaultProvider) {
		saturn.client.core.CommonCore.DEFAULT_POOL_NAME = name;
	}
};
saturn.client.core.CommonCore.closeProviders = function() {
	var name = saturn.client.core.CommonCore.providers.keys();
	while(name.hasNext()) {
		var name1 = name.next();
		saturn.client.core.CommonCore.providers.get(name1)._closeConnection();
	}
};
saturn.client.core.CommonCore.getStringError = function(error) {
	var dwin = js.Browser.get_window();
	dwin.error = error;
	return error;
};
saturn.client.core.CommonCore.getCombinedModels = function() {
	if(saturn.client.core.CommonCore.combinedModels == null) {
		saturn.client.core.CommonCore.combinedModels = new haxe.ds.StringMap();
		var _g = 0;
		var _g1 = saturn.client.core.CommonCore.getProviderNames();
		while(_g < _g1.length) {
			var name = _g1[_g];
			++_g;
			var models = saturn.client.core.CommonCore.getDefaultProvider(null,name).getModels();
			var key = models.keys();
			while(key.hasNext()) {
				var key1 = key.next();
				saturn.client.core.CommonCore.combinedModels.set(key1,models.get(key1));
			}
		}
	}
	return saturn.client.core.CommonCore.combinedModels;
};
saturn.client.core.CommonCore.getProviderNameForModel = function(name) {
	var models = saturn.client.core.CommonCore.getCombinedModels();
	if(models.exists(name)) {
		if(models.get(name).exists("provider_name")) {
			return models.get(name).get("provider_name");
		} else {
			return null;
		}
	} else {
		return null;
	}
};
saturn.client.core.CommonCore.getProviderForNamedQuery = function(name) {
	var providerName = saturn.client.core.CommonCore.providers.keys();
	while(providerName.hasNext()) {
		var providerName1 = providerName.next();
		var provider = saturn.client.core.CommonCore.providers.get(providerName1);
		var config = provider.getConfig();
		if(Reflect.hasField(config,"named_queries")) {
			if(Reflect.hasField(Reflect.field(config,"named_queries"),name)) {
				return providerName1;
			}
		}
	}
	return null;
};
saturn.client.core.CommonCore.getDefaultProvider = function(cb,name) {
	if(name == null) {
		name = saturn.client.core.CommonCore.getDefaultProviderName();
	}
	if(saturn.client.core.CommonCore.providers.exists(name)) {
		if(cb != null) {
			cb(null,saturn.client.core.CommonCore.providers.get(name));
		}
		return saturn.client.core.CommonCore.providers.get(name);
	} else if(name != null) {
		saturn.client.core.CommonCore.getResource(name,cb);
		return -1;
	}
	return null;
};
saturn.client.core.CommonCore.getProviderNames = function() {
	var names = [];
	var name = saturn.client.core.CommonCore.providers.keys();
	while(name.hasNext()) {
		var name1 = name.next();
		names.push(name1);
	}
	var name2 = saturn.client.core.CommonCore.pools.keys();
	while(name2.hasNext()) {
		var name3 = name2.next();
		names.push(name3);
	}
	return names;
};
saturn.client.core.CommonCore.getFileExtension = function(fileName) {
	var r = new EReg("\\.(\\w+)","");
	r.match(fileName);
	return r.matched(1);
};
saturn.client.core.CommonCore.getBinaryFileAsArrayBuffer = function(file) {
	var fileReader = new FileReader();
	return fileReader.readAsArrayBuffer(file);
};
saturn.client.core.CommonCore.convertArrayBufferToBase64 = function(buffer) {
	var binary = "";
	var bytes = new Uint8Array(buffer);
	var len = bytes.byteLength;
	var _g1 = 0;
	var _g = len;
	while(_g1 < _g) {
		var i = _g1++;
		binary += String.fromCharCode(bytes[i]);
	}
	return js.Browser.get_window().btoa(binary);
};
saturn.client.core.CommonCore.getFileAsText = function(file,cb) {
	if(Std["is"](file,saturn.core.FileShim)) {
		var tmp = file.getAsText();
		cb(tmp);
	} else if(Reflect.hasField(file,"_data")) {
		var tmp1 = file.asText();
		cb(tmp1);
	} else {
		var fileReader = new FileReader();
		fileReader.onload = function(e) {
			cb(e.target.result);
		};
		fileReader.readAsText(file);
	}
};
saturn.client.core.CommonCore.getFileInChunks = function(file,chunkSize,cb) {
	var offset = 0;
	var fileSize = file.size;
	var chunker = null;
	chunker = function() {
		var reader = new FileReader();
		var reader1 = reader;
		var chunker1 = file.slice(offset,offset + chunkSize);
		reader1.readAsDataURL(chunker1);
		reader.onloadend = function(event) {
			if(event.target.error == null) {
				var chunker2 = reader.result.split(",")[1];
				cb(null,chunker2,function() {
					offset += chunkSize;
					if(offset >= fileSize) {
						cb(null,null,null);
					} else {
						chunker();
					}
				});
			} else {
				cb(event.target.error,null,null);
			}
		};
	};
	chunker();
};
saturn.client.core.CommonCore.getFileAsArrayBuffer = function(file,cb) {
	if(Std["is"](file,saturn.core.FileShim)) {
		var tmp = file.getAsArrayBuffer();
		cb(tmp);
	} else if(Reflect.hasField(file,"_data")) {
		var tmp1 = file.asUint8Array();
		cb(tmp1);
	} else {
		var fileReader = new FileReader();
		fileReader.onload = function(e) {
			cb(e.target.result);
		};
		fileReader.readAsArrayBuffer(file);
	}
};
saturn.client.core.CommonCore.setPool = function(poolName,pool,isDefault) {
	if(poolName == null) {
		poolName = "DEFAULT";
	}
	saturn.client.core.CommonCore.pools.set(poolName,pool);
	if(isDefault) {
		saturn.client.core.CommonCore.DEFAULT_POOL_NAME = poolName;
	}
};
saturn.client.core.CommonCore.getPool = function(poolName) {
	if(poolName == null) {
		poolName = "DEFAULT";
	}
	if(saturn.client.core.CommonCore.pools.exists(poolName)) {
		return saturn.client.core.CommonCore.pools.get(poolName);
	} else {
		return null;
	}
};
saturn.client.core.CommonCore.getResource = function(poolName,cb) {
	if(poolName == null) {
		poolName = "DEFAULT";
	}
	var pool = saturn.client.core.CommonCore.getPool(poolName);
	if(pool != null) {
		pool.acquire(function(err,resource) {
			if(err == null) {
				saturn.client.core.CommonCore.resourceToPool.set(resource,poolName);
			}
			cb(err,resource);
		});
	} else {
		cb("Invalid pool name",null);
	}
};
saturn.client.core.CommonCore.releaseResource = function(resource) {
	if(saturn.client.core.CommonCore.resourceToPool.exists(resource)) {
		var poolName = saturn.client.core.CommonCore.resourceToPool.get(resource);
		if(saturn.client.core.CommonCore.pools.exists(poolName)) {
			var pool = saturn.client.core.CommonCore.pools.get(poolName);
			pool.release(resource);
			return -3;
		} else {
			return -2;
		}
	} else {
		return -1;
	}
};
saturn.client.core.CommonCore.makeFullyQualified = function(path) {
	var location = js.Browser.get_location();
	return location.protocol + "//" + location.hostname + ":" + location.port + "/" + path;
};
saturn.client.core.CommonCore.getContent = function(url,onSuccess,onFailure) {
	Ext.Ajax.request({ url : url, success : function(response,opts) {
		onSuccess(response.responseText);
	}, failure : function(response1,opts1) {
		onFailure(response1);
	}});
};
saturn.client.core.CommonCore.getDefaultProviderName = function() {
	return saturn.client.core.CommonCore.DEFAULT_POOL_NAME;
};
if(!saturn.core) saturn.core = {};
saturn.core.CutProductDirection = $hxClasses["saturn.core.CutProductDirection"] = { __ename__ : ["saturn","core","CutProductDirection"], __constructs__ : ["UPSTREAM","DOWNSTREAM","UPDOWN"] };
saturn.core.CutProductDirection.UPSTREAM = ["UPSTREAM",0];
saturn.core.CutProductDirection.UPSTREAM.toString = $estr;
saturn.core.CutProductDirection.UPSTREAM.__enum__ = saturn.core.CutProductDirection;
saturn.core.CutProductDirection.DOWNSTREAM = ["DOWNSTREAM",1];
saturn.core.CutProductDirection.DOWNSTREAM.toString = $estr;
saturn.core.CutProductDirection.DOWNSTREAM.__enum__ = saturn.core.CutProductDirection;
saturn.core.CutProductDirection.UPDOWN = ["UPDOWN",2];
saturn.core.CutProductDirection.UPDOWN.toString = $estr;
saturn.core.CutProductDirection.UPDOWN.__enum__ = saturn.core.CutProductDirection;
if(!saturn.core.molecule) saturn.core.molecule = {};
saturn.core.molecule.Molecule = $hxClasses["saturn.core.molecule.Molecule"] = function(seq) {
	this.linked = false;
	this.allowStar = false;
	this.floatAttributes = new haxe.ds.StringMap();
	this.stringAttributes = new haxe.ds.StringMap();
	this.annotations = new haxe.ds.StringMap();
	this.rawAnnotationData = new haxe.ds.StringMap();
	this.annotationCRC = new haxe.ds.StringMap();
	this.setSequence(seq);
};
saturn.core.molecule.Molecule.__name__ = ["saturn","core","molecule","Molecule"];
saturn.core.molecule.Molecule.prototype = {
	sequence: null
	,starPosition: null
	,originalSequence: null
	,linkedOriginField: null
	,sequenceField: null
	,floatAttributes: null
	,stringAttributes: null
	,name: null
	,alternativeName: null
	,annotations: null
	,rawAnnotationData: null
	,annotationCRC: null
	,crc: null
	,allowStar: null
	,parent: null
	,linked: null
	,getValue: function() {
		return this.getSequence();
	}
	,isLinked: function() {
		return this.linked;
	}
	,setParent: function(parent) {
		this.parent = parent;
	}
	,getParent: function() {
		return this.parent;
	}
	,isChild: function() {
		return this.parent != null;
	}
	,setCRC: function(crc) {
		this.crc = crc;
	}
	,updateCRC: function() {
		if(this.sequence != null) {
			this.crc = haxe.crypto.Md5.encode(this.sequence);
		}
	}
	,getAnnotationCRC: function(annotationName) {
		return this.annotationCRC.get(annotationName);
	}
	,getCRC: function() {
		return this.crc;
	}
	,setRawAnnotationData: function(rawAnnotationData,annotationName) {
		this.rawAnnotationData.set(annotationName,rawAnnotationData);
	}
	,getRawAnnotationData: function(annotationName) {
		return this.rawAnnotationData.get(annotationName);
	}
	,setAllAnnotations: function(annotations) {
		this.removeAllAnnotations();
		var annotationName = annotations.keys();
		while(annotationName.hasNext()) {
			var annotationName1 = annotationName.next();
			this.setAnnotations(annotations.get(annotationName1),annotationName1);
		}
	}
	,removeAllAnnotations: function() {
		var annotationName = this.annotations.keys();
		while(annotationName.hasNext()) {
			var annotationName1 = annotationName.next();
			this.annotations.remove(annotationName1);
			this.annotationCRC.remove(annotationName1);
		}
	}
	,setAnnotations: function(annotations,annotationName) {
		this.annotations.set(annotationName,annotations);
		this.annotationCRC.set(annotationName,this.getCRC());
	}
	,getAnnotations: function(name) {
		return this.annotations.get(name);
	}
	,getAllAnnotations: function() {
		return this.annotations;
	}
	,getAlternativeName: function() {
		return this.alternativeName;
	}
	,setAlternativeName: function(altName) {
		this.alternativeName = altName;
	}
	,getMoleculeName: function() {
		return this.name;
	}
	,setMoleculeName: function(name) {
		this.name = name;
	}
	,getName: function() {
		return this.getMoleculeName();
	}
	,setName: function(name) {
		this.setMoleculeName(name);
	}
	,getSequence: function() {
		return this.sequence;
	}
	,setSequence: function(seq) {
		if(seq != null) {
			seq = seq.toUpperCase();
			seq = saturn.core.molecule.Molecule.whiteSpaceReg.replace(seq,"");
			seq = saturn.core.molecule.Molecule.newLineReg.replace(seq,"");
			seq = saturn.core.molecule.Molecule.carLineReg.replace(seq,"");
			this.starPosition = seq.indexOf("*");
			if(!this.allowStar) {
				this.originalSequence = seq;
				seq = saturn.core.molecule.Molecule.reg_starReplace.replace(seq,"");
			}
			this.sequence = seq;
		}
		this.updateCRC();
	}
	,getFirstPosition: function(seq) {
		return this.sequence.indexOf(seq);
	}
	,getLastPosition: function(seq) {
		if(seq == "") {
			return -1;
		}
		var c = 0;
		var lastMatchPos = -1;
		var lastLastMatchPos = -1;
		while(true) {
			lastMatchPos = this.sequence.indexOf(seq,lastMatchPos + 1);
			if(lastMatchPos != -1) {
				lastLastMatchPos = lastMatchPos;
				++c;
			} else {
				break;
			}
		}
		return lastLastMatchPos;
	}
	,getLocusCount: function(seq) {
		if(seq == "") {
			return 0;
		}
		var c = 0;
		var lastMatchPos = -1;
		while(true) {
			lastMatchPos = this.sequence.indexOf(seq,lastMatchPos + 1);
			if(lastMatchPos != -1) {
				++c;
			} else {
				break;
			}
		}
		return c;
	}
	,contains: function(seq) {
		if(this.sequence.indexOf(seq) > -1) {
			return true;
		} else {
			return false;
		}
	}
	,getLength: function() {
		return this.sequence.length;
	}
	,getStarPosition: function() {
		return this.starPosition;
	}
	,setStarPosition: function(starPosition) {
		this.starPosition = starPosition;
	}
	,getStarSequence: function() {
		return this.originalSequence;
	}
	,equals: function(other) {
		if(other.getStarPosition() != this.getStarPosition()) {
			return false;
		} else if(this.getSequence() != other.getSequence()) {
			return false;
		}
		return true;
	}
	,getCutPosition: function(template) {
		if(template.getLocusCount(this.getSequence()) > 0) {
			var siteStartPosition = template.getFirstPosition(this.getSequence());
			return siteStartPosition + this.starPosition;
		} else {
			return -1;
		}
	}
	,getAfterCutSequence: function(template) {
		var cutPosition = this.getCutPosition(template);
		if(cutPosition == -1) {
			return "";
		} else {
			var seq = template.getSequence();
			return seq.substring(cutPosition,seq.length);
		}
	}
	,getBeforeCutSequence: function(template) {
		var cutPosition = this.getCutPosition(template);
		if(cutPosition == -1) {
			return "";
		} else {
			var seq = template.getSequence();
			return seq.substring(0,cutPosition);
		}
	}
	,getLastCutPosition: function(template) {
		if(template.getLocusCount(this.getSequence()) > 0) {
			var siteStartPosition = template.getLastPosition(this.getSequence());
			return siteStartPosition + this.starPosition;
		} else {
			return -1;
		}
	}
	,getLastBeforeCutSequence: function(template) {
		var cutPosition = this.getLastCutPosition(template);
		if(cutPosition == -1) {
			return "";
		} else {
			var seq = template.getSequence();
			return seq.substring(0,cutPosition);
		}
	}
	,getLastAfterCutSequence: function(template) {
		var cutPosition = this.getLastCutPosition(template);
		if(cutPosition == -1) {
			return "";
		} else {
			var seq = template.getSequence();
			return seq.substring(cutPosition,seq.length);
		}
	}
	,getCutProduct: function(template,direction) {
		if(direction == saturn.core.CutProductDirection.UPSTREAM) {
			return this.getBeforeCutSequence(template);
		} else if(direction == saturn.core.CutProductDirection.DOWNSTREAM) {
			return this.getAfterCutSequence(template);
		} else if(direction == saturn.core.CutProductDirection.UPDOWN) {
			var startPos = this.getCutPosition(template);
			var endPos = this.getLastCutPosition(template) - this.getLength();
			return template.getSequence().substring(startPos,endPos);
		} else {
			return null;
		}
	}
	,getFloatAttribute: function(attr) {
		return this._getFloatAttribute(Std.string(attr));
	}
	,_getFloatAttribute: function(attributeName) {
		if(this.floatAttributes.exists(attributeName)) {
			return this.floatAttributes.get(attributeName);
		}
		return null;
	}
	,setValue: function(value) {
		this.setSequence(value);
	}
	,_setFloatAttribute: function(attributeName,val) {
		this.floatAttributes.set(attributeName,val);
	}
	,setFloatAttribute: function(attr,val) {
		this._setFloatAttribute(Std.string(attr),val);
	}
	,getStringAttribute: function(attr) {
		return this._getStringAttribute(Std.string(attr));
	}
	,_getStringAttribute: function(attributeName) {
		if(this.stringAttributes.exists(attributeName)) {
			return this.stringAttributes.get(attributeName);
		}
		return null;
	}
	,_setStringAttribute: function(attributeName,val) {
		this.stringAttributes.set(attributeName,val);
	}
	,setStringAttribute: function(attr,val) {
		this._setStringAttribute(Std.string(attr),val);
		return;
	}
	,getMW: function() {
		return this.getFloatAttribute(saturn.core.molecule.MoleculeFloatAttribute.MW);
	}
	,findMatchingLocuses: function(locus,mode) {
		var collookup_single = new EReg("^(\\d+)$","");
		if(collookup_single.match(locus)) {
			var num = collookup_single.matched(1);
			var locusPosition = new saturn.core.LocusPosition();
			locusPosition.start = Std.parseInt(num) - 1;
			locusPosition.end = locusPosition.start;
			return [locusPosition];
		}
		var collookup_double = new EReg("^(\\d+)-(\\d+)$","");
		if(collookup_double.match(locus)) {
			var locusPosition1 = new saturn.core.LocusPosition();
			locusPosition1.start = Std.parseInt(collookup_double.matched(1)) - 1;
			locusPosition1.end = Std.parseInt(collookup_double.matched(2)) - 1;
			return [locusPosition1];
		}
		var collookup_toend = new EReg("^(\\d+)-$","");
		if(collookup_toend.match(locus)) {
			var locusPosition2 = new saturn.core.LocusPosition();
			locusPosition2.start = Std.parseInt(collookup_toend.matched(1)) - 1;
			locusPosition2.end = this.getLength() - 1;
			return [locusPosition2];
		}
		var re_missMatchTotal = new EReg("^(\\d+)(.+)","");
		if(mode == null) {
			mode = saturn.core.molecule.MoleculeAlignMode.REGEX;
			if(re_missMatchTotal.match(locus)) {
				mode = saturn.core.molecule.MoleculeAlignMode.SIMPLE;
			}
		}
		if(mode == saturn.core.molecule.MoleculeAlignMode.REGEX) {
			return this.findMatchingLocusesRegEx(locus);
		} else if(mode == saturn.core.molecule.MoleculeAlignMode.SIMPLE) {
			var missMatchesAllowed = 0;
			if(re_missMatchTotal.match(locus)) {
				missMatchesAllowed = Std.parseInt(re_missMatchTotal.matched(1));
				locus = re_missMatchTotal.matched(2);
			}
			return this.findMatchingLocusesSimple(locus,missMatchesAllowed);
		} else {
			return null;
		}
	}
	,findMatchingLocusesSimple: function(locus,missMatchesAllowed) {
		if(missMatchesAllowed == null) {
			missMatchesAllowed = 0;
		}
		var positions = [];
		if(locus == null || locus == "") {
			return positions;
		}
		var currentMissMatches = 0;
		var seqI = -1;
		var lI = -1;
		var startPos = 0;
		var missMatchLimit = missMatchesAllowed + 1;
		var missMatchPositions = [];
		while(true) {
			++lI;
			++seqI;
			if(seqI > this.sequence.length - 1) {
				break;
			}
			if(locus.charAt(lI) != this.sequence.charAt(seqI)) {
				++currentMissMatches;
				missMatchPositions.push(seqI);
			}
			if(lI == 0) {
				startPos = seqI;
			}
			if(currentMissMatches == missMatchLimit) {
				seqI = startPos;
				lI = -1;
				currentMissMatches = 0;
				missMatchPositions = [];
			} else if(lI == locus.length - 1) {
				var locusPosition = new saturn.core.LocusPosition();
				locusPosition.start = startPos;
				locusPosition.end = seqI;
				locusPosition.missMatchPositions = missMatchPositions;
				positions.push(locusPosition);
				lI = -1;
				currentMissMatches = 0;
				missMatchPositions = [];
			}
		}
		return positions;
	}
	,findMatchingLocusesRegEx: function(regex) {
		var r = new EReg(regex,"i");
		var positions = [];
		if(regex == null || regex == "") {
			return positions;
		}
		var offSet = 0;
		var matchAgainst = this.sequence;
		while(matchAgainst != null) if(r.match(matchAgainst)) {
			var locusPosition = new saturn.core.LocusPosition();
			var match = r.matchedPos();
			locusPosition.start = match.pos + offSet;
			locusPosition.end = match.pos + match.len - 1 + offSet;
			offSet = locusPosition.end + 1;
			matchAgainst = r.matchedRight();
			positions.push(locusPosition);
		} else {
			break;
		}
		return positions;
	}
	,updateAnnotations: function(annotationName,config,annotationManager,cb) {
		if(this.getAnnotationCRC(annotationName) == this.getCRC()) {
			var tmp = this.getAnnotations(annotationName);
			cb(null,tmp);
		} else {
			annotationManager.annotateMolecule(this,annotationName,config,function(err,res) {
				cb(err,res);
			});
		}
	}
	,getAtPosition: function(pos) {
		return this.sequence.charAt(pos);
	}
	,__class__: saturn.core.molecule.Molecule
};
saturn.core.DNA = $hxClasses["saturn.core.DNA"] = function(seq) {
	this.reg_tReplace = new EReg("T","g");
	this.proteins = new haxe.ds.StringMap();
	saturn.core.molecule.Molecule.call(this,seq);
};
saturn.core.DNA.__name__ = ["saturn","core","DNA"];
saturn.core.DNA.isDNA = function(sequence) {
	var seqLen = sequence.length;
	var _g = new haxe.ds.StringMap();
	_g.set("A",true);
	_g.set("T",true);
	_g.set("G",true);
	_g.set("C",true);
	_g.set("U",true);
	var valid_nucs = _g;
	var _g2 = 0;
	var _g1 = seqLen;
	while(_g2 < _g1) {
		var i = _g2++;
		var nuc = sequence.charAt(i).toUpperCase();
		if(!(valid_nucs.exists(nuc) && valid_nucs.get(nuc))) {
			return false;
		}
	}
	return true;
};
saturn.core.DNA.__super__ = saturn.core.molecule.Molecule;
saturn.core.DNA.prototype = $extend(saturn.core.molecule.Molecule.prototype,{
	protein: null
	,proteins: null
	,addProtein: function(name,protein) {
		if(protein != null) {
			this.proteins.set(name,protein);
		}
	}
	,removeProtein: function(name) {
		this.proteins.remove(name);
	}
	,getProtein: function(name) {
		return this.proteins.get(name);
	}
	,getProteinNames: function() {
		var names = [];
		var name = this.proteins.keys();
		while(name.hasNext()) {
			var name1 = name.next();
			names.push(name1);
		}
		return names;
	}
	,getGCFraction: function() {
		var dnaComposition = this.getComposition();
		return (dnaComposition.cCount + dnaComposition.gCount) / this.getLength();
	}
	,reg_tReplace: null
	,convertToRNA: function() {
		return this.reg_tReplace.replace(this.getSequence(),"U");
	}
	,getHydrogenBondCount: function() {
		var dnaComposition = this.getComposition();
		return (dnaComposition.gCount + dnaComposition.cCount) * 3 + (dnaComposition.aCount + dnaComposition.tCount) * 2;
	}
	,getMolecularWeight: function(phosphateAt5Prime) {
		var dnaComposition = this.getComposition();
		var seqMW = 0.0;
		seqMW += dnaComposition.aCount * saturn.core.molecule.MoleculeConstants.aChainMW;
		seqMW += dnaComposition.tCount * saturn.core.molecule.MoleculeConstants.tChainMW;
		seqMW += dnaComposition.gCount * saturn.core.molecule.MoleculeConstants.gChainMW;
		seqMW += dnaComposition.cCount * saturn.core.molecule.MoleculeConstants.cChainMW;
		if(phosphateAt5Prime == false) {
			seqMW -= saturn.core.molecule.MoleculeConstants.PO3;
		}
		seqMW += saturn.core.molecule.MoleculeConstants.OH;
		return seqMW;
	}
	,setSequence: function(sequence) {
		saturn.core.molecule.Molecule.prototype.setSequence.call(this,sequence);
		if(this.isChild()) {
			var p = this.getParent();
			p.dnaSequenceUpdated(this.sequence);
		}
	}
	,proteinSequenceUpdated: function(sequence) {
	}
	,getComposition: function() {
		var aCount = 0;
		var tCount = 0;
		var gCount = 0;
		var cCount = 0;
		var seqLen = this.sequence.length;
		var _g1 = 0;
		var _g = seqLen;
		while(_g1 < _g) {
			var i = _g1++;
			var nuc = this.sequence.charAt(i);
			switch(nuc) {
			case "A":
				++aCount;
				break;
			case "C":
				++cCount;
				break;
			case "G":
				++gCount;
				break;
			case "T":
				++tCount;
				break;
			case "U":
				++tCount;
				break;
			}
		}
		return new saturn.core.DNAComposition(aCount,tCount,gCount,cCount);
	}
	,getMeltingTemperature: function() {
		var saltConc = 50;
		var primerConc = 500;
		var testTmCalc = new saturn.core.TmCalc();
		return testTmCalc.tmCalculation(this,saltConc,primerConc);
	}
	,findPrimer: function(startPos,minLength,maxLength,minMelting,maxMelting,extensionSequence,minLengthExtended,minMeltingExtended,maxMeltingExtentded) {
		if(maxMeltingExtentded == null) {
			maxMeltingExtentded = -1;
		}
		if(minMeltingExtended == null) {
			minMeltingExtended = -1;
		}
		if(minLengthExtended == null) {
			minLengthExtended = -1;
		}
		var cCount;
		var gCount;
		var tCount;
		var aCount = 0;
		var seq = HxOverrides.substr(this.sequence,startPos - 1,minLength - 1);
		var comp = new saturn.core.DNA(seq).getComposition();
		cCount = comp.cCount;
		gCount = comp.gCount;
		tCount = comp.tCount;
		aCount = comp.aCount;
		var rangeStart = startPos - 1 + minLength - 1;
		var rangeStop = rangeStart + maxLength;
		var _g1 = rangeStart;
		var _g = rangeStop;
		while(_g1 < _g) {
			var i = _g1++;
			var $char = this.sequence.charAt(i);
			if($char == "C") {
				++cCount;
			} else if($char == "G") {
				++gCount;
			} else if($char == "A") {
				++aCount;
			} else if($char == "T") {
				++tCount;
			}
			seq += $char;
			var mt = new saturn.core.DNA(seq).getMeltingTemperature();
			if(mt > maxMelting) {
				throw new js._Boot.HaxeError(new saturn.util.HaxeException("Maximum melting temperature exceeded"));
			} else if(mt >= minMelting && mt <= maxMelting) {
				if(extensionSequence == null) {
					return seq;
				} else {
					var completeSequence = new saturn.core.DNA(extensionSequence + seq);
					var completeMT = completeSequence.getMeltingTemperature();
					if(completeMT >= minMeltingExtended && completeMT <= maxMeltingExtentded && completeSequence.getLength() >= minLengthExtended) {
						return seq;
					} else if(completeMT < minMeltingExtended) {
						continue;
					} else if(completeMT > maxMeltingExtentded) {
						throw new js._Boot.HaxeError(new saturn.util.HaxeException("Maximum melting temperature for extended primer sequence exceeded"));
					} else if(completeSequence.getLength() < minLengthExtended) {
						continue;
					}
				}
			}
		}
		throw new js._Boot.HaxeError(new saturn.util.HaxeException("Unable to find region with required parameters"));
	}
	,getNumGC: function() {
		var seqLen = this.sequence.length;
		var gcNum = 0;
		var _g1 = 0;
		var _g = seqLen;
		while(_g1 < _g) {
			var i = _g1++;
			var nuc = this.sequence.charAt(i);
			if(nuc == "G" || nuc == "C") {
				++gcNum;
			}
		}
		return gcNum;
	}
	,getInverse: function() {
		var newSequence = new StringBuf();
		var seqLen = this.sequence.length;
		var _g1 = 0;
		var _g = seqLen;
		while(_g1 < _g) {
			var i = _g1++;
			var j = seqLen - i - 1;
			var nuc = this.sequence.charAt(j);
			newSequence.add(nuc);
		}
		return newSequence.toString();
	}
	,getComplement: function() {
		var newSequence = new StringBuf();
		var seqLen = this.sequence.length;
		var _g1 = 0;
		var _g = seqLen;
		while(_g1 < _g) {
			var i = _g1++;
			var nuc = this.sequence.charAt(i);
			switch(nuc) {
			case "A":
				nuc = "T";
				break;
			case "C":
				nuc = "G";
				break;
			case "G":
				nuc = "C";
				break;
			case "T":
				nuc = "A";
				break;
			}
			newSequence.add(nuc);
		}
		return newSequence.toString();
	}
	,getInverseComplement: function() {
		var newSequence = new StringBuf();
		var seqLen = this.sequence.length;
		var _g1 = 0;
		var _g = seqLen;
		while(_g1 < _g) {
			var i = _g1++;
			var j = seqLen - i - 1;
			var nuc = this.sequence.charAt(j);
			switch(nuc) {
			case "A":
				nuc = "T";
				break;
			case "C":
				nuc = "G";
				break;
			case "G":
				nuc = "C";
				break;
			case "T":
				nuc = "A";
				break;
			}
			newSequence.add(nuc);
		}
		return newSequence.toString();
	}
	,getFirstStartCodonPosition: function(geneticCode) {
		var geneticCode1 = saturn.core.GeneticCodeRegistry.getRegistry().getGeneticCodeByEnum(geneticCode);
		var codons = geneticCode1.getStartCodons();
		var minStartPos = -1;
		var codon = codons.keys();
		while(codon.hasNext()) {
			var codon1 = codon.next();
			var index = this.sequence.indexOf(codon1);
			if(index > -1) {
				if(minStartPos == -1 || minStartPos > index) {
					minStartPos = index;
				}
			}
		}
		return minStartPos;
	}
	,getTranslation: function(geneticCode,offSetPosition,stopAtFirstStop) {
		if(offSetPosition == null) {
			offSetPosition = 0;
		}
		if(!this.canHaveCodons()) {
			throw new js._Boot.HaxeError(new saturn.util.HaxeException("Unable to translate a sequence with less than 3 nucleotides"));
		}
		var proteinSequenceBuffer = new StringBuf();
		var seqLength = this.sequence.length;
		var finalCodonPosition = seqLength - (seqLength - offSetPosition) % 3;
		var geneticCode1 = saturn.core.GeneticCodeRegistry.getRegistry().getGeneticCodeByEnum(geneticCode);
		var startIndex = offSetPosition;
		var stopCodons = geneticCode1.getStopCodons();
		while(startIndex < finalCodonPosition) {
			var endIndex = startIndex + 3;
			var codon = this.sequence.substring(startIndex,endIndex);
			var code = geneticCode1.lookupCodon(codon);
			if(stopAtFirstStop && code == "!") {
				break;
			}
			proteinSequenceBuffer.add(code);
			startIndex = endIndex;
		}
		return proteinSequenceBuffer.toString();
	}
	,getFrameTranslation: function(geneticCode,frame) {
		if(this.sequence == null) {
			return null;
		}
		var offSetPos = 0;
		if(frame == saturn.core.Frame.TWO) {
			offSetPos = 1;
		} else if(frame == saturn.core.Frame.THREE) {
			offSetPos = 2;
		}
		return this.getTranslation(geneticCode,offSetPos,true);
	}
	,getThreeFrameTranslation: function(geneticCode) {
		var threeFrameTranslations = new haxe.ds.StringMap();
		threeFrameTranslations.set(Std.string(saturn.core.Frame.ONE),this.getFrameTranslation(geneticCode,saturn.core.Frame.ONE));
		threeFrameTranslations.set(Std.string(saturn.core.Frame.TWO),this.getFrameTranslation(geneticCode,saturn.core.Frame.TWO));
		threeFrameTranslations.set(Std.string(saturn.core.Frame.THREE),this.getFrameTranslation(geneticCode,saturn.core.Frame.THREE));
		return threeFrameTranslations;
	}
	,getSixFrameTranslation: function(geneticCode) {
		var forwardFrames = this.getThreeFrameTranslation(geneticCode);
		var dnaSeq = this.getInverseComplement();
		var inverseComplementDNAObj = new saturn.core.DNA(dnaSeq);
		var reverseFrames = inverseComplementDNAObj.getThreeFrameTranslation(geneticCode);
		forwardFrames.set("ONE_IC",reverseFrames.get("ONE"));
		forwardFrames.set("TWO_IC",reverseFrames.get("TWO"));
		forwardFrames.set("THREE_IC",reverseFrames.get("THREE"));
		return forwardFrames;
	}
	,getFirstStartCodonPositionByFrame: function(geneticCode,frame) {
		var startCodons = this.getStartCodonPositions(geneticCode,frame,true);
		if(startCodons.length == 0) {
			return -1;
		} else {
			return startCodons[0];
		}
	}
	,getStartCodonPositions: function(geneticCode,frame,stopAtFirst) {
		var offSet = 0;
		if(frame == saturn.core.Frame.TWO) {
			offSet = 1;
		} else if(frame == saturn.core.Frame.THREE) {
			offSet = 2;
		}
		var seqLength = this.sequence.length;
		var startingIndex = offSet;
		if(seqLength < startingIndex + 3) {
			throw new js._Boot.HaxeError(new saturn.util.HaxeException("Insufficient DNA length to find codon start position for frame " + Std.string(frame)));
		}
		var startCodonPositions = [];
		var finalCodonPosition = seqLength - (seqLength - offSet) % 3;
		var geneticCode1 = saturn.core.GeneticCodeRegistry.getRegistry().getGeneticCodeByEnum(geneticCode);
		var startIndex = startingIndex;
		while(startIndex < finalCodonPosition) {
			var endIndex = startIndex + 3;
			var codon = this.sequence.substring(startIndex,endIndex);
			if(geneticCode1.isStartCodon(codon)) {
				startCodonPositions.push(startIndex);
				if(stopAtFirst) {
					break;
				}
			}
			startIndex = endIndex;
		}
		return startCodonPositions;
	}
	,getFirstStopCodonPosition: function(geneticCode,frame) {
		var startCodons = this.getStopCodonPositions(geneticCode,frame,true);
		if(startCodons.isEmpty()) {
			return -1;
		} else {
			return startCodons.first();
		}
	}
	,getStopCodonPositions: function(geneticCode,frame,stopAtFirst) {
		var offSet = 0;
		if(frame == saturn.core.Frame.TWO) {
			offSet = 1;
		} else if(frame == saturn.core.Frame.THREE) {
			offSet = 2;
		}
		var seqLength = this.sequence.length;
		var startingIndex = offSet;
		if(seqLength < startingIndex + 3) {
			throw new js._Boot.HaxeError(new saturn.util.HaxeException("Insufficient DNA length to find codon start position for frame " + Std.string(frame)));
		}
		var startCodonPositions = new List();
		var finalCodonPosition = seqLength - (seqLength - offSet) % 3;
		var geneticCode1 = saturn.core.GeneticCodeRegistry.getRegistry().getGeneticCodeByEnum(geneticCode);
		var startIndex = startingIndex;
		while(startIndex < finalCodonPosition) {
			var endIndex = startIndex + 3;
			var codon = this.sequence.substring(startIndex,endIndex);
			if(geneticCode1.isStopCodon(codon)) {
				startCodonPositions.add(startIndex);
				if(stopAtFirst) {
					break;
				}
			}
			startIndex = endIndex;
		}
		return startCodonPositions;
	}
	,canHaveCodons: function() {
		if(this.sequence.length >= 3) {
			return true;
		} else {
			return false;
		}
	}
	,getFrameRegion: function(frame,start,stop) {
		var dnaStart;
		var dnaStop;
		if(frame == saturn.core.Frame.ONE) {
			dnaStart = start * 3 - 2;
			dnaStop = stop * 3;
		} else if(frame == saturn.core.Frame.TWO) {
			dnaStart = start * 3 - 1;
			dnaStop = stop * 3 + 1;
		} else if(frame == saturn.core.Frame.THREE) {
			dnaStart = start * 3;
			dnaStop = stop * 3 + 2;
		} else {
			return null;
		}
		return this.sequence.substring(dnaStart - 1,dnaStop);
	}
	,mutateResidue: function(frame,geneticCode,pos,mutAA) {
		var nucPos = this.getCodonStartPosition(frame,pos);
		if(nucPos >= this.sequence.length) {
			throw new js._Boot.HaxeError(new saturn.util.HaxeException("Sequence not long enough for requested frame and position"));
		}
		var geneticCode1 = saturn.core.GeneticCodeRegistry.getRegistry().getGeneticCodeByEnum(geneticCode);
		var codon = geneticCode1.getFirstCodon(mutAA);
		return this.sequence.substring(0,nucPos - 1) + codon + this.sequence.substring(nucPos + 2,this.sequence.length);
	}
	,getCodonStartPosition: function(frame,start) {
		var dnaStart;
		if(frame == saturn.core.Frame.ONE) {
			dnaStart = start * 3 - 2;
		} else if(frame == saturn.core.Frame.TWO) {
			dnaStart = start * 3 - 1;
		} else if(frame == saturn.core.Frame.THREE) {
			dnaStart = start * 3;
		} else {
			return null;
		}
		return dnaStart;
	}
	,getCodonStopPosition: function(frame,stop) {
		var dnaStop;
		if(frame == saturn.core.Frame.ONE) {
			dnaStop = stop * 3;
		} else if(frame == saturn.core.Frame.TWO) {
			dnaStop = stop * 3 + 1;
		} else if(frame == saturn.core.Frame.THREE) {
			dnaStop = stop * 3 + 2;
		} else {
			return null;
		}
		return dnaStop;
	}
	,getRegion: function(start,stop) {
		return HxOverrides.substr(this.sequence,start - 1,stop - start + 1);
	}
	,getFrom: function(start,len) {
		return HxOverrides.substr(this.sequence,start - 1,len);
	}
	,findMatchingLocuses: function(regex,mode) {
		var direction = saturn.core.Direction.Forward;
		if(StringTools.startsWith(regex,"r")) {
			var templateIC = new saturn.core.DNA(this.getInverseComplement());
			var regexIC = regex.substring(1,regex.length);
			var positions = templateIC.findMatchingLocuses(regexIC,mode);
			var length = this.getLength();
			var _g = 0;
			while(_g < positions.length) {
				var position = positions[_g];
				++_g;
				var originalStart = position.start;
				position.start = length - 1 - position.end;
				position.end = length - 1 - originalStart;
				if(position.missMatchPositions != null) {
					var fPositions = [];
					var _g1 = 0;
					var _g2 = position.missMatchPositions;
					while(_g1 < _g2.length) {
						var position1 = _g2[_g1];
						++_g1;
						fPositions.push(length - 1 - position1);
					}
					position.missMatchPositions = fPositions;
				}
			}
			return positions;
		} else {
			return saturn.core.molecule.Molecule.prototype.findMatchingLocuses.call(this,regex);
		}
	}
	,__class__: saturn.core.DNA
});
saturn.core.Frame = $hxClasses["saturn.core.Frame"] = { __ename__ : ["saturn","core","Frame"], __constructs__ : ["ONE","TWO","THREE"] };
saturn.core.Frame.ONE = ["ONE",0];
saturn.core.Frame.ONE.toString = $estr;
saturn.core.Frame.ONE.__enum__ = saturn.core.Frame;
saturn.core.Frame.TWO = ["TWO",1];
saturn.core.Frame.TWO.toString = $estr;
saturn.core.Frame.TWO.__enum__ = saturn.core.Frame;
saturn.core.Frame.THREE = ["THREE",2];
saturn.core.Frame.THREE.toString = $estr;
saturn.core.Frame.THREE.__enum__ = saturn.core.Frame;
saturn.core.Frames = $hxClasses["saturn.core.Frames"] = function() { };
saturn.core.Frames.__name__ = ["saturn","core","Frames"];
saturn.core.Frames.toInt = function(frame) {
	switch(Type.enumIndex(frame)) {
	case 0:
		return 0;
	case 1:
		return 1;
	case 2:
		return 2;
	}
};
saturn.core.Direction = $hxClasses["saturn.core.Direction"] = { __ename__ : ["saturn","core","Direction"], __constructs__ : ["Forward","Reverse"] };
saturn.core.Direction.Forward = ["Forward",0];
saturn.core.Direction.Forward.toString = $estr;
saturn.core.Direction.Forward.__enum__ = saturn.core.Direction;
saturn.core.Direction.Reverse = ["Reverse",1];
saturn.core.Direction.Reverse.toString = $estr;
saturn.core.Direction.Reverse.__enum__ = saturn.core.Direction;
saturn.core.DNAComposition = $hxClasses["saturn.core.DNAComposition"] = function(aCount,tCount,gCount,cCount) {
	this.aCount = aCount;
	this.tCount = tCount;
	this.gCount = gCount;
	this.cCount = cCount;
};
saturn.core.DNAComposition.__name__ = ["saturn","core","DNAComposition"];
saturn.core.DNAComposition.prototype = {
	aCount: null
	,tCount: null
	,gCount: null
	,cCount: null
	,__class__: saturn.core.DNAComposition
};
saturn.core.GeneticCode = $hxClasses["saturn.core.GeneticCode"] = function() {
	this.codonLookupTable = new haxe.ds.StringMap();
	this.aaToCodonTable = new haxe.ds.StringMap();
	this.startCodons = new haxe.ds.StringMap();
	this.stopCodons = new haxe.ds.StringMap();
	this.populateTable();
};
saturn.core.GeneticCode.__name__ = ["saturn","core","GeneticCode"];
saturn.core.GeneticCode.prototype = {
	codonLookupTable: null
	,aaToCodonTable: null
	,startCodons: null
	,stopCodons: null
	,isAA: function(aa) {
		return this.aaToCodonTable.exists(aa);
	}
	,addStartCodon: function(codon) {
		this.startCodons.set(codon,"1");
	}
	,isStartCodon: function(codon) {
		return this.startCodons.exists(codon);
	}
	,addStopCodon: function(codon) {
		this.stopCodons.set(codon,"1");
	}
	,isStopCodon: function(codon) {
		return this.stopCodons.exists(codon);
	}
	,getStopCodons: function() {
		return this.stopCodons;
	}
	,getCodonCount: function() {
		return Lambda.count(this.codonLookupTable);
	}
	,getStartCodons: function() {
		var clone = new haxe.ds.StringMap();
		var key = this.startCodons.keys();
		while(key.hasNext()) {
			var key1 = key.next();
			clone.set(key1,this.startCodons.get(key1));
		}
		return clone;
	}
	,populateTable: function() {
	}
	,lookupCodon: function(codon) {
		if(this.codonLookupTable.exists(codon)) {
			return this.codonLookupTable.get(codon);
		} else {
			return "?";
		}
	}
	,getCodonLookupTable: function() {
		return this.codonLookupTable;
	}
	,getAAToCodonTable: function() {
		return this.aaToCodonTable;
	}
	,getFirstCodon: function(aa) {
		if(this.aaToCodonTable.exists(aa)) {
			var codons = this.aaToCodonTable.get(aa);
			return codons.first();
		} else {
			return null;
		}
	}
	,__class__: saturn.core.GeneticCode
};
saturn.core.StandardGeneticCode = $hxClasses["saturn.core.StandardGeneticCode"] = function() {
	saturn.core.GeneticCode.call(this);
	saturn.core.GeneticCode.prototype.addStartCodon.call(this,"ATG");
	saturn.core.GeneticCode.prototype.addStopCodon.call(this,"TAA");
	saturn.core.GeneticCode.prototype.addStopCodon.call(this,"TGA");
	saturn.core.GeneticCode.prototype.addStopCodon.call(this,"TAG");
};
saturn.core.StandardGeneticCode.__name__ = ["saturn","core","StandardGeneticCode"];
saturn.core.StandardGeneticCode.getDefaultInstance = function() {
	return saturn.core.StandardGeneticCode.instance;
};
saturn.core.StandardGeneticCode.__super__ = saturn.core.GeneticCode;
saturn.core.StandardGeneticCode.prototype = $extend(saturn.core.GeneticCode.prototype,{
	populateTable: function() {
		this.codonLookupTable.set("TTT","F");
		this.codonLookupTable.set("TTC","F");
		this.codonLookupTable.set("TTA","L");
		this.codonLookupTable.set("TTG","L");
		this.codonLookupTable.set("TCT","S");
		this.codonLookupTable.set("TCC","S");
		this.codonLookupTable.set("TCA","S");
		this.codonLookupTable.set("TCG","S");
		this.codonLookupTable.set("TAT","Y");
		this.codonLookupTable.set("TAC","Y");
		this.codonLookupTable.set("TAA","!");
		this.codonLookupTable.set("TAG","!");
		this.codonLookupTable.set("TGT","C");
		this.codonLookupTable.set("TGC","C");
		this.codonLookupTable.set("TGA","!");
		this.codonLookupTable.set("TGG","W");
		this.codonLookupTable.set("CTT","L");
		this.codonLookupTable.set("CTC","L");
		this.codonLookupTable.set("CTA","L");
		this.codonLookupTable.set("CTG","L");
		this.codonLookupTable.set("CCT","P");
		this.codonLookupTable.set("CCC","P");
		this.codonLookupTable.set("CCA","P");
		this.codonLookupTable.set("CCG","P");
		this.codonLookupTable.set("CAT","H");
		this.codonLookupTable.set("CAC","H");
		this.codonLookupTable.set("CAA","Q");
		this.codonLookupTable.set("CAG","Q");
		this.codonLookupTable.set("CGT","R");
		this.codonLookupTable.set("CGC","R");
		this.codonLookupTable.set("CGA","R");
		this.codonLookupTable.set("CGG","R");
		this.codonLookupTable.set("ATT","I");
		this.codonLookupTable.set("ATC","I");
		this.codonLookupTable.set("ATA","I");
		this.codonLookupTable.set("ATG","M");
		this.codonLookupTable.set("ACT","T");
		this.codonLookupTable.set("ACC","T");
		this.codonLookupTable.set("ACA","T");
		this.codonLookupTable.set("ACG","T");
		this.codonLookupTable.set("AAT","N");
		this.codonLookupTable.set("AAC","N");
		this.codonLookupTable.set("AAA","K");
		this.codonLookupTable.set("AAG","K");
		this.codonLookupTable.set("AGT","S");
		this.codonLookupTable.set("AGC","S");
		this.codonLookupTable.set("AGA","R");
		this.codonLookupTable.set("AGG","R");
		this.codonLookupTable.set("GTT","V");
		this.codonLookupTable.set("GTC","V");
		this.codonLookupTable.set("GTA","V");
		this.codonLookupTable.set("GTG","V");
		this.codonLookupTable.set("GCT","A");
		this.codonLookupTable.set("GCC","A");
		this.codonLookupTable.set("GCA","A");
		this.codonLookupTable.set("GCG","A");
		this.codonLookupTable.set("GAT","D");
		this.codonLookupTable.set("GAC","D");
		this.codonLookupTable.set("GAA","E");
		this.codonLookupTable.set("GAG","E");
		this.codonLookupTable.set("GGT","G");
		this.codonLookupTable.set("GGC","G");
		this.codonLookupTable.set("GGA","G");
		this.codonLookupTable.set("GGG","G");
		var key = this.codonLookupTable.keys();
		while(key.hasNext()) {
			var key1 = key.next();
			var aa = this.codonLookupTable.get(key1);
			if(!this.aaToCodonTable.exists(aa)) {
				this.aaToCodonTable.set(aa,new List());
			}
			this.aaToCodonTable.get(aa).add(key1);
		}
	}
	,__class__: saturn.core.StandardGeneticCode
});
saturn.core.GeneticCodes = $hxClasses["saturn.core.GeneticCodes"] = { __ename__ : ["saturn","core","GeneticCodes"], __constructs__ : ["STANDARD"] };
saturn.core.GeneticCodes.STANDARD = ["STANDARD",0];
saturn.core.GeneticCodes.STANDARD.toString = $estr;
saturn.core.GeneticCodes.STANDARD.__enum__ = saturn.core.GeneticCodes;
saturn.core.GeneticCodeRegistry = $hxClasses["saturn.core.GeneticCodeRegistry"] = function() {
	this.shortNameToCodeObj = new haxe.ds.StringMap();
	this.shortNameToCodeObj.set(Std.string(saturn.core.GeneticCodes.STANDARD),saturn.core.StandardGeneticCode.getDefaultInstance());
};
saturn.core.GeneticCodeRegistry.__name__ = ["saturn","core","GeneticCodeRegistry"];
saturn.core.GeneticCodeRegistry.getRegistry = function() {
	return saturn.core.GeneticCodeRegistry.CODE_REGISTRY;
};
saturn.core.GeneticCodeRegistry.getDefault = function() {
	return saturn.core.GeneticCodeRegistry.getRegistry().getGeneticCodeByEnum(saturn.core.GeneticCodes.STANDARD);
};
saturn.core.GeneticCodeRegistry.prototype = {
	shortNameToCodeObj: null
	,getGeneticCodeNames: function() {
		var nameList = new List();
		var key = this.shortNameToCodeObj.keys();
		while(key.hasNext()) {
			var key1 = key.next();
			nameList.add(key1);
		}
		return nameList;
	}
	,getGeneticCodeByName: function(shortName) {
		if(!this.shortNameToCodeObj.exists(shortName)) {
			throw new js._Boot.HaxeError(new saturn.core.InvalidGeneticCodeException(shortName + " doesn't correspond to a genetic code in the main registry."));
		} else {
			return this.shortNameToCodeObj.get(shortName);
		}
	}
	,getGeneticCodeByEnum: function(code) {
		return this.getGeneticCodeByName(Std.string(code));
	}
	,__class__: saturn.core.GeneticCodeRegistry
};
if(!saturn.util) saturn.util = {};
saturn.util.HaxeException = $hxClasses["saturn.util.HaxeException"] = function(message) {
	this.errorMessage = message;
};
saturn.util.HaxeException.__name__ = ["saturn","util","HaxeException"];
saturn.util.HaxeException.prototype = {
	errorMessage: null
	,getMessage: function() {
		return this.errorMessage;
	}
	,toString: function() {
		return this.errorMessage;
	}
	,__class__: saturn.util.HaxeException
};
saturn.core.InvalidGeneticCodeException = $hxClasses["saturn.core.InvalidGeneticCodeException"] = function(message) {
	saturn.util.HaxeException.call(this,message);
};
saturn.core.InvalidGeneticCodeException.__name__ = ["saturn","core","InvalidGeneticCodeException"];
saturn.core.InvalidGeneticCodeException.__super__ = saturn.util.HaxeException;
saturn.core.InvalidGeneticCodeException.prototype = $extend(saturn.util.HaxeException.prototype,{
	__class__: saturn.core.InvalidGeneticCodeException
});
saturn.core.InvalidCodonException = $hxClasses["saturn.core.InvalidCodonException"] = function(message) {
	saturn.util.HaxeException.call(this,message);
};
saturn.core.InvalidCodonException.__name__ = ["saturn","core","InvalidCodonException"];
saturn.core.InvalidCodonException.__super__ = saturn.util.HaxeException;
saturn.core.InvalidCodonException.prototype = $extend(saturn.util.HaxeException.prototype,{
	__class__: saturn.core.InvalidCodonException
});
saturn.core.EUtils = $hxClasses["saturn.core.EUtils"] = function() {
};
saturn.core.EUtils.__name__ = ["saturn","core","EUtils"];
saturn.core.EUtils.getProteinsForGene = function(geneId,cb) {
	saturn.core.EUtils.getProteinGIsForGene(geneId,function(err,ids) {
		if(err != null) {
			cb(err,null);
		} else {
			saturn.core.EUtils.getProteinInfo(ids,true,function(err1,objs) {
				cb(err1,objs);
			});
		}
	});
};
saturn.core.EUtils.getProteinInfo = function(ids,lookupDNA,cb) {
	if(lookupDNA == null) {
		lookupDNA = false;
	}
	var c1 = saturn.core.EUtils.eutils.efetch({ db : "protein", id : ids, retmode : "xml"}).then(function(d) {
		if(!Reflect.hasField(d,"GBSet")) {
			var c11 = "Unable to retrieve proteins for  " + ids.toString();
			cb(c11,null);
			return;
		}
		var objs;
		if((d.GBSet.GBSeq instanceof Array) && d.GBSet.GBSeq.__enum__ == null) {
			objs = d.GBSet.GBSeq;
		} else {
			objs = [d.GBSet.GBSeq];
		}
		if(objs == null || objs.length == 0) {
			var c12 = "Unable to retrieve proteins for  " + ids.join(",");
			cb(c12,null);
			return;
		}
		var protObjs = [];
		var _g = 0;
		while(_g < objs.length) {
			var seqObj = objs[_g];
			++_g;
			var protein = new saturn.core.Protein(seqObj.GBSeq_sequence);
			protObjs.push(protein);
			protein.setMoleculeName(Reflect.field(seqObj,"GBSeq_accession-version"));
			if(Reflect.hasField(seqObj,"GBSeq_other-seqids")) {
				var seqIdElems = Reflect.field(Reflect.field(seqObj,"GBSeq_other-seqids"),"GBSeqid");
				var _g1 = 0;
				while(_g1 < seqIdElems.length) {
					var seqIdElem = seqIdElems[_g1];
					++_g1;
					var seqId = seqIdElem;
					if(seqId.indexOf("gi|") == 0) {
						protein.setAlternativeName(seqId);
						break;
					}
				}
			}
			if(Reflect.hasField(seqObj,"GBSeq_feature-table")) {
				var table = Reflect.field(seqObj,"GBSeq_feature-table");
				var features = table.GBFeature;
				var _g11 = 0;
				while(_g11 < features.length) {
					var feature = features[_g11];
					++_g11;
					if(feature.GBFeature_key == "CDS") {
						var feature_quals = feature.GBFeature_quals.GBQualifier;
						var _g2 = 0;
						while(_g2 < feature_quals.length) {
							var feature1 = feature_quals[_g2];
							++_g2;
							if(feature1.GBQualifier_name == "coded_by") {
								var acStr = feature1.GBQualifier_value;
								var parts = acStr.split(":");
								if(parts.length > 2) {
									var c13 = "Parts greater than two for  " + protein.getMoleculeName();
									cb(c13,null);
									return;
								} else {
									var dna = new saturn.core.DNA(null);
									var name = parts[0];
									dna.setMoleculeName(name);
									dna.addProtein("default",protein);
									protein.setReferenceCoordinates(parts[1]);
								}
							}
						}
					}
				}
			}
		}
		if(lookupDNA) {
			var dnaRefs = [];
			var _g3 = 0;
			while(_g3 < protObjs.length) {
				var protObj = protObjs[_g3];
				++_g3;
				dnaRefs.push(protObj.getDNA().getMoleculeName());
			}
			saturn.core.EUtils.getDNAForAccessions(dnaRefs,function(err,dnaObjs) {
				if(err != null) {
					cb(err,null);
				} else {
					var refMap = new haxe.ds.StringMap();
					var _g4 = 0;
					while(_g4 < dnaObjs.length) {
						var obj = dnaObjs[_g4];
						++_g4;
						refMap.set(obj.getMoleculeName(),obj);
					}
					var _g5 = 0;
					while(_g5 < protObjs.length) {
						var protObj1 = protObjs[_g5];
						++_g5;
						var dnaAccession = protObj1.getDNA().getMoleculeName();
						if(refMap.exists(dnaAccession)) {
							var dna1 = refMap.get(dnaAccession);
							protObj1.setDNA(dna1);
							var coords = protObj1.getReferenceCoordinates().split("..");
							if(coords.length > 2) {
								var c14 = "Invalid coordinate string for " + protObj1.getMoleculeName() + " " + protObj1.getReferenceCoordinates();
								cb(c14,null);
								return;
							}
							dna1.setSequence(dna1.getRegion(Std.parseInt(coords[0]),Std.parseInt(coords[1])));
							var protSeq = dna1.getFrameTranslation(saturn.core.GeneticCodes.STANDARD,saturn.core.Frame.ONE);
						} else {
							cb(dnaAccession + " not found",null);
							return;
						}
					}
					cb(null,protObjs);
				}
			});
		} else {
			cb(null,protObjs);
		}
	});
	c1.catch(function(d){cb(d)});
};
saturn.core.EUtils.getDNAForAccessions = function(accessions,cb) {
	var c1 = saturn.core.EUtils.eutils.efetch({ db : "nucleotide", id : accessions, retmode : "xml"}).then(function(d) {
		var objs;
		if((d.GBSet.GBSeq instanceof Array) && d.GBSet.GBSeq.__enum__ == null) {
			objs = d.GBSet.GBSeq;
		} else {
			objs = [d.GBSet.GBSeq];
		}
		if(objs == null || objs.length == 0) {
			var c11 = "Unable to retrieve proteins for  " + accessions.join(",");
			cb(c11,null);
			return;
		}
		var dnaObjs = [];
		var _g = 0;
		while(_g < objs.length) {
			var seqObj = objs[_g];
			++_g;
			var dna = new saturn.core.DNA(seqObj.GBSeq_sequence);
			dnaObjs.push(dna);
			dna.setMoleculeName(Reflect.field(seqObj,"GBSeq_accession-version"));
			if(Reflect.hasField(seqObj,"GBSeq_other-seqids")) {
				var seqIdElems = Reflect.field(Reflect.field(seqObj,"GBSeq_other-seqids"),"GBSeqid");
				var _g1 = 0;
				while(_g1 < seqIdElems.length) {
					var seqIdElem = seqIdElems[_g1];
					++_g1;
					var seqId = seqIdElem;
					if(seqId.indexOf("gi|") == 0) {
						dna.setAlternativeName(seqId);
						break;
					}
				}
			}
		}
		cb(null,dnaObjs);
	});
	c1.catch(function(d){cb(d)});
};
saturn.core.EUtils.getProteinGIsForGene = function(geneId,cb) {
	var c1 = saturn.core.EUtils.eutils.esearch({ db : "gene", term : geneId}).then(saturn.core.EUtils.eutils.elink({ dbto : "protein"})).then(function(d) {
		saturn.core.Util.debug("");
		var found = false;
		if(Reflect.hasField(d,"linksets")) {
			var linksets = d.linksets;
			if(linksets.length > 0) {
				if(Reflect.hasField(linksets[0],"linksetdbs")) {
					var linksetdbs = linksets[0].linksetdbs;
					if(linksetdbs.length > 0) {
						var _g = 0;
						while(_g < linksetdbs.length) {
							var set = linksetdbs[_g];
							++_g;
							if(set.linkname == "gene_protein_refseq") {
								var ids = set.links;
								cb(null,ids);
								found = true;
								break;
							}
						}
					}
				}
			}
		}
		if(!found) {
			cb("Unable to lookup gene entry " + geneId,null);
		}
	});
	c1.catch(function(d){cb(d)});
};
saturn.core.EUtils.insertProteins = function(objs,cb) {
	var run = null;
	run = function() {
		if(objs.length == 0) {
			return;
		}
		var protein = objs.pop();
		saturn.core.Util.debug("Inserting: " + protein.getMoleculeName());
		saturn.core.Protein.insertTranslation(protein.getDNA().getMoleculeName(),protein.getDNA().getAlternativeName(),protein.getDNA().getSequence(),"NUCLEOTIDE",protein.getMoleculeName(),protein.getAlternativeName(),protein.getSequence(),"PROTEIN","7158","GENE",function(err) {
			if(err != null) {
				saturn.core.Util.debug(err);
			} else {
				run();
			}
		});
	};
	run();
};
saturn.core.EUtils.getGeneInfo = function(geneId,cb) {
	saturn.core.Util.debug("Fetching gene record (tends to be very slow)");
	var c1 = saturn.core.EUtils.eutils.efetch({ db : "gene", id : geneId}).then(function(d) {
		var set1 = Reflect.field(d,"Entrezgene-Set");
		var set2 = Reflect.field(set1,"Entrezgene");
		var set3 = Reflect.field(set2,"Entrezgene_gene");
		var set4 = Reflect.field(set3,"Gene-ref");
		var c11 = Reflect.field(set4,"Gene-ref_locus");
		var c12 = Reflect.field(set4,"Gene-ref_desc");
		cb(null,{ symbol : c11, description : c12});
	});
	c1.catch(function(d){cb(d)});
};
saturn.core.EUtils.prototype = {
	__class__: saturn.core.EUtils
};
saturn.core.EntityType = $hxClasses["saturn.core.EntityType"] = function() {
};
saturn.core.EntityType.__name__ = ["saturn","core","EntityType"];
saturn.core.EntityType.prototype = {
	id: null
	,name: null
	,__class__: saturn.core.EntityType
};
saturn.core.FileShim = $hxClasses["saturn.core.FileShim"] = function(name,base64) {
	this.name = name;
	this.base64 = base64;
};
saturn.core.FileShim.__name__ = ["saturn","core","FileShim"];
saturn.core.FileShim.prototype = {
	name: null
	,base64: null
	,getAsText: function() {
		return js.Browser.get_window().atob(this.base64);
	}
	,getAsArrayBuffer: function() {
		var bstr = js.Browser.get_window().atob(this.base64);
		var buffer = new Uint8Array(bstr.length);
		var _g1 = 0;
		var _g = bstr.length;
		while(_g1 < _g) {
			var i = _g1++;
			buffer[i] = HxOverrides.cca(bstr,i);
		}
		return buffer;
	}
	,__class__: saturn.core.FileShim
};
saturn.core.Generator = $hxClasses["saturn.core.Generator"] = function(limit) {
	this.limit = limit;
	this.processed = 0;
	this.done = false;
	this.items = [];
	this.maxAtOnce = 1;
};
saturn.core.Generator.__name__ = ["saturn","core","Generator"];
saturn.core.Generator.prototype = {
	limit: null
	,processed: null
	,done: null
	,cb: null
	,endCb: null
	,maxAtOnce: null
	,items: null
	,push: function(item) {
		this.items.push(item);
	}
	,pop: function(item) {
		return this.items.pop();
	}
	,die: function(err) {
		saturn.core.Util.debug(err);
		this.stop(err);
	}
	,stop: function(err) {
		this.finished();
		this.endCb(err);
	}
	,next: function() {
		var _gthis = this;
		if(this.done && this.items.length == 0 || this.limit != -1 && this.processed == this.limit) {
			this.endCb(null);
			return;
		} else if(this.items.length > 0) {
			if(this.maxAtOnce != 1) {
				var list = [];
				var added = 0;
				while(this.items.length > 0) {
					var item = this.items.pop();
					list.push(item);
					this.processed++;
					++added;
					if(added == this.maxAtOnce) {
						break;
					}
				}
				this.cb(list,function() {
					haxe.Timer.delay($bind(_gthis,_gthis.next),1);
				},this);
			} else {
				var item1 = this.items.pop();
				this.processed++;
				this.cb(item1,function() {
					haxe.Timer.delay($bind(_gthis,_gthis.next),1);
				},this);
			}
		} else {
			saturn.core.Util.debug("waiting");
			haxe.Timer.delay($bind(this,this.next),100);
		}
	}
	,count: function() {
		return this.processed;
	}
	,setMaxAtOnce: function(maxAtOnce) {
		this.maxAtOnce = maxAtOnce;
	}
	,setLimit: function(limit) {
		this.limit = limit;
	}
	,onEnd: function(cb) {
		this.endCb = cb;
	}
	,onNext: function(cb) {
		this.cb = cb;
		this.next();
	}
	,finished: function() {
		this.done = true;
	}
	,__class__: saturn.core.Generator
};
saturn.core.LocusPosition = $hxClasses["saturn.core.LocusPosition"] = function() {
};
saturn.core.LocusPosition.__name__ = ["saturn","core","LocusPosition"];
saturn.core.LocusPosition.prototype = {
	start: null
	,end: null
	,missMatchPositions: null
	,__class__: saturn.core.LocusPosition
};
saturn.core.Protein = $hxClasses["saturn.core.Protein"] = function(seq) {
	this.max_pH = 13;
	this.min_pH = 3;
	this.threshold = 0.1;
	var _g = new haxe.ds.StringMap();
	_g.set("Y",1490);
	_g.set("W",5500);
	_g.set("C",125);
	this.lu_extinction = _g;
	var _g1 = new haxe.ds.StringMap();
	_g1.set("D",-1);
	_g1.set("E",-1);
	_g1.set("H",1);
	_g1.set("Y",-1);
	_g1.set("K",1);
	_g1.set("R",1);
	_g1.set("C",-1);
	_g1.set("N-Term",1);
	_g1.set("C-Term",-1);
	this.lu_charge = _g1;
	var _g2 = new haxe.ds.StringMap();
	_g2.set("D",4.05);
	_g2.set("E",4.45);
	_g2.set("H",5.98);
	_g2.set("Y",10);
	_g2.set("K",10.4);
	_g2.set("R",12.5);
	_g2.set("C",9);
	_g2.set("N-Term",8);
	_g2.set("C-Term",3.55);
	this.lu_pKa = _g2;
	var _g3 = new haxe.ds.StringMap();
	_g3.set("A",1.8);
	_g3.set("G",-0.4);
	_g3.set("M",1.9);
	_g3.set("S",-0.8);
	_g3.set("C",2.5);
	_g3.set("H",-3.2);
	_g3.set("N",-3.5);
	_g3.set("T",-0.7);
	_g3.set("D",-3.5);
	_g3.set("I",4.5);
	_g3.set("P",-1.6);
	_g3.set("V",4.2);
	_g3.set("E",-3.5);
	_g3.set("K",-3.9);
	_g3.set("Q",-3.5);
	_g3.set("W",-0.9);
	_g3.set("F",2.8);
	_g3.set("L",3.8);
	_g3.set("R",-4.5);
	_g3.set("Y",-1.3);
	this.hydrophobicityLookUp = _g3;
	saturn.core.molecule.Molecule.call(this,seq);
};
saturn.core.Protein.__name__ = ["saturn","core","Protein"];
saturn.core.Protein._insertGene = function(geneId,source,cb) {
	var provider = saturn.core.Util.getProvider();
	provider.getById(geneId,saturn.core.domain.Entity,function(obj,err) {
		if(err != null) {
			cb(err);
		} else if(obj != null) {
			cb(null);
		} else {
			var gene = new saturn.core.domain.Entity();
			gene.entityId = geneId;
			gene.source = new saturn.core.domain.DataSource();
			gene.source.name = source;
			gene.entityType = new saturn.core.EntityType();
			gene.entityType.name = "DNA";
			saturn.core.EUtils.getGeneInfo(Std.parseInt(geneId),function(err1,info) {
				gene.altName = info.symbol;
				gene.description = info.description;
				provider.insertObjects([gene],function(err2) {
					cb(err2);
				});
			});
		}
	});
};
saturn.core.Protein.insertTranslation = function(dnaId,dnaAltName,dnaSeq,dnaSource,protId,protAltName,protSeq,protSource,geneId,geneSource,cb) {
	var provider = saturn.core.Util.getProvider();
	saturn.core.Protein._insertGene(geneId,geneSource,function(err) {
		if(err != null) {
			cb(err);
		} else {
			var dna = new saturn.core.domain.Entity();
			dna.entityId = dnaId;
			dna.altName = dnaAltName;
			dna.source = new saturn.core.domain.DataSource();
			dna.source.name = dnaSource;
			dna.entityType = new saturn.core.EntityType();
			dna.entityType.name = "DNA";
			var dna_mol = new saturn.core.domain.Molecule();
			dna_mol.entity = dna;
			dna_mol.sequence = dnaSeq;
			var annotation = new saturn.core.domain.MoleculeAnnotation();
			annotation.entity = dna;
			annotation.referent = new saturn.core.domain.Entity();
			annotation.referent.entityId = geneId;
			annotation.referent.source = new saturn.core.domain.DataSource();
			annotation.referent.source.name = "GENE";
			var prot = new saturn.core.domain.Entity();
			prot.entityId = protId;
			prot.altName = protAltName;
			prot.source = new saturn.core.domain.DataSource();
			prot.source.name = protSource;
			prot.entityType = new saturn.core.EntityType();
			prot.entityType.name = "PROTEIN";
			var prot_mol = new saturn.core.domain.Molecule();
			prot_mol.entity = prot;
			prot_mol.sequence = protSeq;
			var reaction = new saturn.core.Reaction();
			reaction.name = dnaId + "-TRANS";
			reaction.reactionType = new saturn.core.ReactionType();
			reaction.reactionType.name = "TRANSLATION";
			prot.reaction = reaction;
			var reactionComp = new saturn.core.ReactionComponent();
			reactionComp.entity = dna;
			reactionComp.reactionRole = new saturn.core.ReactionRole();
			reactionComp.reactionRole.name = "TEMPLATE";
			reactionComp.reaction = reaction;
			reactionComp.position = 1;
			provider.insertObjects([dna],function(err1) {
				if(err1 != null) {
					cb(err1);
				} else {
					provider.insertObjects([dna_mol],function(err2) {
						if(err2 != null) {
							cb(err2);
						} else {
							provider.insertObjects([reaction],function(err3) {
								if(err3 != null) {
									cb(err3);
								} else {
									provider.insertObjects([reactionComp],function(err4) {
										if(err4 != null) {
											cb(err4);
										} else {
											provider.insertObjects([prot],function(err5) {
												if(err5 != null) {
													cb(err5);
												} else {
													provider.insertObjects([prot_mol],function(err6) {
														if(err6 != null) {
															cb(err6);
														} else {
															provider.insertObjects([annotation],function(err7) {
																if(err7 != null) {
																	saturn.core.Util.debug(err7);
																}
																cb(err7);
															});
														}
													});
												}
											});
										}
									});
								}
							});
						}
					});
				}
			});
		}
	});
};
saturn.core.Protein.isProtein = function(sequence) {
	var seqLen = sequence.length;
	var valid_res = saturn.core.GeneticCodeRegistry.getDefault().getAAToCodonTable();
	var _g1 = 0;
	var _g = seqLen;
	while(_g1 < _g) {
		var i = _g1++;
		var res = sequence.charAt(i).toUpperCase();
		if(!valid_res.exists(res)) {
			return false;
		}
	}
	return true;
};
saturn.core.Protein.__super__ = saturn.core.molecule.Molecule;
saturn.core.Protein.prototype = $extend(saturn.core.molecule.Molecule.prototype,{
	dna: null
	,coordinates: null
	,hydrophobicityLookUp: null
	,lu_pKa: null
	,lu_charge: null
	,lu_extinction: null
	,threshold: null
	,min_pH: null
	,max_pH: null
	,setSequence: function(sequence) {
		saturn.core.molecule.Molecule.prototype.setSequence.call(this,sequence);
		if(sequence != null) {
			var mSet = saturn.core.molecule.MoleculeSetRegistry.getStandardMoleculeSet();
			var mw = mSet.getMolecule("H2O").getFloatAttribute(saturn.core.molecule.MoleculeFloatAttribute.MW);
			var _g1 = 0;
			var _g = this.sequence.length;
			while(_g1 < _g) {
				var i = _g1++;
				var molecule = mSet.getMolecule(this.sequence.charAt(i));
				if(molecule != null) {
					mw += molecule.getFloatAttribute(saturn.core.molecule.MoleculeFloatAttribute.MW_CONDESATION);
				} else {
					mw = -1;
					break;
				}
			}
			this.setFloatAttribute(saturn.core.molecule.MoleculeFloatAttribute.MW,mw);
		}
		if(this.isLinked()) {
			var d = this.getParent();
			if(d != null) {
				d.proteinSequenceUpdated(this.sequence);
			}
		}
	}
	,getHydrophobicity: function() {
		var proteinSequence = this.sequence;
		var seqLength = this.sequence.length;
		var totalGravy = 0.0;
		var averageGravy = 0.0;
		var _g1 = 0;
		var _g = seqLength;
		while(_g1 < _g) {
			var i = _g1++;
			var aminoAcid = HxOverrides.substr(proteinSequence,i,1);
			var hydroValue = this.hydrophobicityLookUp.get(aminoAcid);
			totalGravy += hydroValue;
		}
		averageGravy = totalGravy / seqLength;
		return averageGravy;
	}
	,setDNA: function(dna) {
		this.dna = dna;
	}
	,dnaSequenceUpdated: function(sequence) {
	}
	,getDNA: function() {
		return this.dna;
	}
	,setReferenceCoordinates: function(coordinates) {
		this.coordinates = coordinates;
	}
	,getReferenceCoordinates: function() {
		return this.coordinates;
	}
	,getAminoAcidCharge: function(aa,mid_pH) {
		var aminoAcid = aa;
		var pH = mid_pH;
		var ratio = 1 / (1 + Math.pow(10,pH - this.lu_pKa.get(aminoAcid)));
		if(this.lu_charge.get(aminoAcid) == 1) {
			return ratio;
		} else {
			return ratio - 1;
		}
	}
	,getProteinCharge: function(mid_pH) {
		var seqLength = this.sequence.length;
		var proteinSequence = this.sequence;
		var aa = "N-Term";
		var proteinCharge = this.getAminoAcidCharge(aa,mid_pH);
		aa = "C-Term";
		proteinCharge += this.getAminoAcidCharge(aa,mid_pH);
		var _g1 = 0;
		var _g = seqLength;
		while(_g1 < _g) {
			var i = _g1++;
			aa = HxOverrides.substr(proteinSequence,i,1);
			if(this.lu_pKa.exists(aa)) {
				proteinCharge += this.getAminoAcidCharge(aa,mid_pH);
			}
		}
		return proteinCharge;
	}
	,getpI: function() {
		var proteinSequence = this.sequence;
		while(true) {
			var mid_pH = 0.5 * (this.max_pH + this.min_pH);
			var proteinCharge = this.getProteinCharge(mid_pH);
			if(proteinCharge > this.threshold) {
				this.min_pH = mid_pH;
			} else if(proteinCharge < -this.threshold) {
				this.max_pH = mid_pH;
			} else {
				return mid_pH;
			}
		}
	}
	,getExtinctionNonReduced: function() {
		var proteinSequence = this.sequence;
		var seqLength = this.sequence.length;
		var aa;
		var extinctionNonReduced = 0.0;
		var numberCysteines = 0.0;
		var pairsCysteins = 0.0;
		var _g1 = 0;
		var _g = seqLength;
		while(_g1 < _g) {
			var i = _g1++;
			aa = HxOverrides.substr(proteinSequence,i,1);
			if(this.lu_extinction.exists(aa) && aa != "C") {
				extinctionNonReduced += this.lu_extinction.get(aa);
			}
			if(aa == "C") {
				++numberCysteines;
			}
		}
		if(numberCysteines % 2 == 0) {
			pairsCysteins = numberCysteines / 2;
		} else {
			pairsCysteins = numberCysteines / 2 - 0.5;
		}
		extinctionNonReduced += pairsCysteins * this.lu_extinction.get("C");
		return extinctionNonReduced;
	}
	,getExtinctionReduced: function() {
		var proteinSequence = this.sequence;
		var seqLength = this.sequence.length;
		var aa;
		var extinctionReduced = 0.0;
		var _g1 = 0;
		var _g = seqLength;
		while(_g1 < _g) {
			var i = _g1++;
			aa = HxOverrides.substr(proteinSequence,i,1);
			if(this.lu_extinction.exists(aa) && aa != "C") {
				extinctionReduced += this.lu_extinction.get(aa);
			}
		}
		return extinctionReduced;
	}
	,__class__: saturn.core.Protein
});
saturn.core.Reaction = $hxClasses["saturn.core.Reaction"] = function() {
};
saturn.core.Reaction.__name__ = ["saturn","core","Reaction"];
saturn.core.Reaction.prototype = {
	id: null
	,name: null
	,reactionTypeId: null
	,reactionType: null
	,__class__: saturn.core.Reaction
};
saturn.core.ReactionComponent = $hxClasses["saturn.core.ReactionComponent"] = function() {
};
saturn.core.ReactionComponent.__name__ = ["saturn","core","ReactionComponent"];
saturn.core.ReactionComponent.prototype = {
	id: null
	,position: null
	,reactionRoleId: null
	,entityId: null
	,reactionId: null
	,reaction: null
	,reactionRole: null
	,entity: null
	,__class__: saturn.core.ReactionComponent
};
saturn.core.ReactionRole = $hxClasses["saturn.core.ReactionRole"] = function() {
};
saturn.core.ReactionRole.__name__ = ["saturn","core","ReactionRole"];
saturn.core.ReactionRole.prototype = {
	id: null
	,name: null
	,__class__: saturn.core.ReactionRole
};
saturn.core.ReactionType = $hxClasses["saturn.core.ReactionType"] = function() {
};
saturn.core.ReactionType.__name__ = ["saturn","core","ReactionType"];
saturn.core.ReactionType.prototype = {
	id: null
	,name: null
	,__class__: saturn.core.ReactionType
};
saturn.core.RestrictionSite = $hxClasses["saturn.core.RestrictionSite"] = function(seq) {
	saturn.core.DNA.call(this,seq);
};
saturn.core.RestrictionSite.__name__ = ["saturn","core","RestrictionSite"];
saturn.core.RestrictionSite.__super__ = saturn.core.DNA;
saturn.core.RestrictionSite.prototype = $extend(saturn.core.DNA.prototype,{
	__class__: saturn.core.RestrictionSite
});
saturn.core.molecule.MoleculeSet = $hxClasses["saturn.core.molecule.MoleculeSet"] = function() {
	this.moleculeSet = new haxe.ds.StringMap();
};
saturn.core.molecule.MoleculeSet.__name__ = ["saturn","core","molecule","MoleculeSet"];
saturn.core.molecule.MoleculeSet.prototype = {
	moleculeSet: null
	,setMolecule: function(name,molecule) {
		this.moleculeSet.set(name,molecule);
	}
	,getMolecule: function(name) {
		return this.moleculeSet.get(name);
	}
	,__class__: saturn.core.molecule.MoleculeSet
};
saturn.core.StandardMoleculeSet = $hxClasses["saturn.core.StandardMoleculeSet"] = function() {
	saturn.core.molecule.MoleculeSet.call(this);
	var mMap = [{ "NAME" : "A", "MW" : 71.0788},{ "NAME" : "R", "MW" : 156.1875},{ "NAME" : "N", "MW" : 114.1038},{ "NAME" : "D", "MW" : 115.0886},{ "NAME" : "C", "MW" : 103.1448},{ "NAME" : "E", "MW" : 129.1155},{ "NAME" : "Q", "MW" : 128.1308},{ "NAME" : "G", "MW" : 57.052},{ "NAME" : "H", "MW" : 137.1412},{ "NAME" : "I", "MW" : 113.1595},{ "NAME" : "L", "MW" : 113.1595},{ "NAME" : "K", "MW" : 128.1742},{ "NAME" : "M", "MW" : 131.1986},{ "NAME" : "F", "MW" : 147.1766},{ "NAME" : "P", "MW" : 97.1167},{ "NAME" : "S", "MW" : 87.0782},{ "NAME" : "T", "MW" : 101.1051},{ "NAME" : "W", "MW" : 186.2133},{ "NAME" : "Y", "MW" : 163.176},{ "NAME" : "V", "MW" : 99.1326}];
	var _g = 0;
	while(_g < mMap.length) {
		var mDef = mMap[_g];
		++_g;
		var m = new saturn.core.molecule.Molecule(mDef.NAME);
		m.setFloatAttribute(saturn.core.molecule.MoleculeFloatAttribute.MW_CONDESATION,mDef.MW);
		m.setStringAttribute(saturn.core.molecule.MoleculeStringAttribute.NAME,mDef.NAME);
		this.setMolecule(mDef.NAME,m);
	}
	mMap = [{ "NAME" : "H2O", "MW" : 18.02}];
	var _g1 = 0;
	while(_g1 < mMap.length) {
		var mDef1 = mMap[_g1];
		++_g1;
		var m1 = new saturn.core.molecule.Molecule(mDef1.NAME);
		m1.setFloatAttribute(saturn.core.molecule.MoleculeFloatAttribute.MW,mDef1.MW);
		m1.setStringAttribute(saturn.core.molecule.MoleculeStringAttribute.NAME,mDef1.NAME);
		this.setMolecule(mDef1.NAME,m1);
	}
};
saturn.core.StandardMoleculeSet.__name__ = ["saturn","core","StandardMoleculeSet"];
saturn.core.StandardMoleculeSet.__super__ = saturn.core.molecule.MoleculeSet;
saturn.core.StandardMoleculeSet.prototype = $extend(saturn.core.molecule.MoleculeSet.prototype,{
	__class__: saturn.core.StandardMoleculeSet
});
saturn.core.TmCalc = $hxClasses["saturn.core.TmCalc"] = function() {
	this.deltaHTable = new haxe.ds.StringMap();
	this.deltaSTable = new haxe.ds.StringMap();
	this.endHTable = new haxe.ds.StringMap();
	this.endSTable = new haxe.ds.StringMap();
	this.populateDeltaHTable();
	this.populateDeltaSTable();
	this.populateEndHTable();
	this.populateEndSTable();
};
saturn.core.TmCalc.__name__ = ["saturn","core","TmCalc"];
saturn.core.TmCalc.prototype = {
	deltaHTable: null
	,deltaSTable: null
	,endHTable: null
	,endSTable: null
	,populateDeltaHTable: function() {
		this.deltaHTable.set("AA",-7900);
		this.deltaHTable.set("TT",-7900);
		this.deltaHTable.set("AT",-7200);
		this.deltaHTable.set("TA",-7200);
		this.deltaHTable.set("CA",-8500);
		this.deltaHTable.set("TG",-8500);
		this.deltaHTable.set("GT",-8400);
		this.deltaHTable.set("AC",-8400);
		this.deltaHTable.set("CT",-7800);
		this.deltaHTable.set("AG",-7800);
		this.deltaHTable.set("GA",-8200);
		this.deltaHTable.set("TC",-8200);
		this.deltaHTable.set("CG",-10600);
		this.deltaHTable.set("GC",-9800);
		this.deltaHTable.set("GG",-8000);
		this.deltaHTable.set("CC",-8000);
	}
	,populateDeltaSTable: function() {
		this.deltaSTable.set("AA",-22.2);
		this.deltaSTable.set("TT",-22.2);
		this.deltaSTable.set("AT",-20.4);
		this.deltaSTable.set("TA",-21.3);
		this.deltaSTable.set("CA",-22.7);
		this.deltaSTable.set("TG",-22.7);
		this.deltaSTable.set("GT",-22.4);
		this.deltaSTable.set("AC",-22.4);
		this.deltaSTable.set("CT",-21.0);
		this.deltaSTable.set("AG",-21.0);
		this.deltaSTable.set("GA",-22.2);
		this.deltaSTable.set("TC",-22.2);
		this.deltaSTable.set("CG",-27.2);
		this.deltaSTable.set("GC",-24.4);
		this.deltaSTable.set("GG",-19.9);
		this.deltaSTable.set("CC",-19.9);
	}
	,populateEndHTable: function() {
		this.endHTable.set("A",2300);
		this.endHTable.set("T",2300);
		this.endHTable.set("G",100);
		this.endHTable.set("C",100);
	}
	,populateEndSTable: function() {
		this.endSTable.set("A",4.1);
		this.endSTable.set("T",4.1);
		this.endSTable.set("G",-2.8);
		this.endSTable.set("C",-2.8);
	}
	,getDeltaH: function(primerSeq) {
		var dnaSeq = primerSeq.getSequence();
		var seqLen = dnaSeq.length;
		var startNuc = dnaSeq.charAt(0);
		var endNuc = dnaSeq.charAt(seqLen - 1);
		var startH = this.endHTable.get(startNuc);
		var endH = this.endHTable.get(endNuc);
		var deltaH = startH + endH;
		var _g1 = 1;
		var _g = seqLen;
		while(_g1 < _g) {
			var i = _g1++;
			var currNuc = dnaSeq.charAt(i);
			var currH = this.deltaHTable.get(startNuc + currNuc);
			startNuc = currNuc;
			deltaH += currH;
		}
		return deltaH;
	}
	,getDeltaS: function(primerSeq) {
		var dnaSeq = primerSeq.getSequence();
		var seqLen = dnaSeq.length;
		var startNuc = dnaSeq.charAt(0);
		var endNuc = dnaSeq.charAt(seqLen - 1);
		var startS = this.endSTable.get(startNuc);
		var endS = this.endSTable.get(endNuc);
		var deltaS = startS + endS;
		var _g1 = 1;
		var _g = seqLen;
		while(_g1 < _g) {
			var i = _g1++;
			var currNuc = dnaSeq.charAt(i);
			var currS = this.deltaSTable.get(startNuc + currNuc);
			startNuc = currNuc;
			deltaS += currS;
		}
		return deltaS;
	}
	,saltCorrection: function(primerSeq,saltConc) {
		var saltPenalty = 0.368;
		var dnaSeq = primerSeq.getSequence();
		var seqLen = dnaSeq.length;
		saltConc /= 1000.0;
		var lnSalt = Math.log(saltConc);
		var deltaS = this.getDeltaS(primerSeq);
		var saltCorrDeltaS = deltaS + saltPenalty * (seqLen - 1) * lnSalt;
		return saltCorrDeltaS;
	}
	,tmCalculation: function(primerSeq,saltConc,primerConc) {
		var deltaH = this.getDeltaH(primerSeq);
		var saltCorrDeltaS = this.saltCorrection(primerSeq,saltConc);
		var gasConst = 1.987;
		var lnPrimerConc = Math.log(primerConc / 1000000000 / 2);
		var tmKelvin = deltaH / (saltCorrDeltaS + gasConst * lnPrimerConc);
		var tmCelcius = tmKelvin - 273.15;
		if(tmCelcius > 75) {
			return 75;
		} else {
			return tmCelcius;
		}
	}
	,__class__: saturn.core.TmCalc
};
saturn.core.User = $hxClasses["saturn.core.User"] = function() {
};
saturn.core.User.__name__ = ["saturn","core","User"];
saturn.core.User.prototype = {
	id: null
	,username: null
	,password: null
	,firstname: null
	,lastname: null
	,email: null
	,fullname: null
	,uuid: null
	,token: null
	,projects: null
	,__class__: saturn.core.User
};
saturn.core.Util = $hxClasses["saturn.core.Util"] = function() {
};
saturn.core.Util.__name__ = ["saturn","core","Util"];
saturn.core.Util.debug = function(msg) {
	saturn.app.SaturnServer.getDefaultServer().debug(msg);
};
saturn.core.Util.inspect = function(obj) {
	js.Node.console.log(obj);
};
saturn.core.Util.print = function(msg) {
	js.Node.console.log(msg);
};
saturn.core.Util.openw = function(path) {
	return saturn.core.Util.fs.createWriteStream(path);
};
saturn.core.Util.opentemp = function(prefix,cb) {
	saturn.core.Util.temp.open(prefix,function(error,info) {
		cb(error,new saturn.core.Stream(info.fd),info.path);
	});
};
saturn.core.Util.isHostEnvironmentAvailable = function() {
	return false;
};
saturn.core.Util.exec = function(program,args,cb) {
	var proc = js.Node.get_child_process().spawn(program,args);
	proc.stderr.on("data",function(error) {
		saturn.core.Util.debug(error.toString("utf8"));
	});
	proc.stdout.on("data",function(msg) {
		saturn.core.Util.debug(msg.toString("utf8"));
	});
	proc.on("close",function(code) {
		saturn.core.Util.debug("Closed");
		cb(code);
	});
	proc.on("error",function(error1) {
		saturn.core.Util.debug(error1);
		cb(-1);
	});
	saturn.core.Util.debug("Hello X");
};
saturn.core.Util.getNewExternalProcess = function(cb) {
};
saturn.core.Util.getNewFileDialog = function(cb) {
};
saturn.core.Util.saveFileAsDialog = function(contents,cb) {
};
saturn.core.Util.saveFile = function(fileName,contents,cb) {
};
saturn.core.Util.jsImports = function(paths,cb) {
	var errs = new haxe.ds.StringMap();
	var next = null;
	next = function() {
		if(paths.length == 0) {
			cb(errs);
		} else {
			var path = paths.pop();
			saturn.core.Util.jsImport(path,function(err) {
				errs.set(path,err);
				next();
			});
		}
	};
	next();
};
saturn.core.Util.jsImport = function(path,cb) {
};
saturn.core.Util.openFileAsDialog = function(cb) {
};
saturn.core.Util.readFile = function(fileName,cb) {
};
saturn.core.Util.open = function(path,cb) {
	saturn.core.Util.fs.createReadStream(path).pipe(saturn.core.Util.split()).on("data",function(line) {
		cb(null,line);
	}).on("error",function(err) {
		cb(err,null);
	}).on("end",function() {
		cb(null,null);
	});
};
saturn.core.Util.getProvider = function() {
	return saturn.client.core.CommonCore.getDefaultProvider();
};
saturn.core.Util.string = function(a) {
	return Std.string(a);
};
saturn.core.Util.clone = function(obj) {
	var ser = haxe.Serializer.run(obj);
	return haxe.Unserializer.run(ser);
};
saturn.core.Util.prototype = {
	__class__: saturn.core.Util
};
saturn.core.Stream = $hxClasses["saturn.core.Stream"] = function(streamId) {
	this.streamId = streamId;
};
saturn.core.Stream.__name__ = ["saturn","core","Stream"];
saturn.core.Stream.prototype = {
	streamId: null
	,write: function(content) {
		saturn.core.Util.fs.writeSync(this.streamId,content);
	}
	,end: function(cb) {
		saturn.core.Util.fs.closeSync(this.streamId,cb);
	}
	,__class__: saturn.core.Stream
};
if(!saturn.core.domain) saturn.core.domain = {};
saturn.core.domain.DataSource = $hxClasses["saturn.core.domain.DataSource"] = function() {
};
saturn.core.domain.DataSource.__name__ = ["saturn","core","domain","DataSource"];
saturn.core.domain.DataSource.getEntities = function(source,cb) {
	var p = saturn.core.Util.getProvider();
	p.getById(source,saturn.core.domain.DataSource,function(obj,err) {
		if(err != null) {
			cb(err,null);
		} else if(obj == null) {
			cb("Data source not found " + source,null);
		} else {
			saturn.core.Util.debug("Retreiving records for source " + source);
			var tmp = saturn.core.Util.string(obj.id);
			p.getByValues([tmp],saturn.core.domain.Entity,"dataSourceId",function(objs,error) {
				saturn.core.Util.debug("Entities retrieved for source " + source);
				if(error != null) {
					cb("An error occurred retrieving data source " + source + " entities\n" + error,null);
				} else {
					cb(null,objs);
				}
			});
		}
	});
};
saturn.core.domain.DataSource.getSource = function(source,insert,cb) {
	var p = saturn.core.Util.getProvider();
	p.getById(source,saturn.core.domain.DataSource,function(obj,err) {
		if(err != null) {
			cb("An error occurred looking for source: " + source + "\n" + err,null);
		} else if(obj == null) {
			if(insert) {
				var obj1 = new saturn.core.domain.DataSource();
				obj1.name = source;
				p.insert(source,function(err1) {
					if(err1 != null) {
						cb("An error occurred inserting source: " + source + "\n" + err1,null);
					} else {
						p.getById(source,saturn.core.domain.DataSource,function(obj2,err2) {
							if(err2 != null) {
								cb("An error occurred looking for source: " + source + "\n" + err2,null);
							} else if(obj2 == null) {
								cb("Inserted source " + source + " could not be found",null);
							} else {
								cb(null,obj2);
							}
						});
					}
				});
			} else {
				cb(null,null);
			}
		} else {
			cb(null,obj);
		}
	});
};
saturn.core.domain.DataSource.prototype = {
	id: null
	,name: null
	,__class__: saturn.core.domain.DataSource
};
saturn.core.domain.Entity = $hxClasses["saturn.core.domain.Entity"] = function() {
};
saturn.core.domain.Entity.__name__ = ["saturn","core","domain","Entity"];
saturn.core.domain.Entity.insertList = function(ids,source,cb) {
	var uqx = new haxe.ds.StringMap();
	var _g = 0;
	while(_g < ids.length) {
		var id = ids[_g];
		++_g;
		uqx.set(id,id);
	}
	ids = [];
	var id1 = uqx.keys();
	while(id1.hasNext()) {
		var id2 = id1.next();
		ids.push(id2);
	}
	saturn.core.domain.DataSource.getSource(source,false,function(err,sourceObj) {
		if(err != null) {
			cb(err,null);
		} else if(sourceObj == null) {
			cb("Unable to find source " + source,null);
		} else {
			var objs = [];
			var _g1 = 0;
			while(_g1 < ids.length) {
				var id3 = ids[_g1];
				++_g1;
				var entity = new saturn.core.domain.Entity();
				entity.entityId = id3;
				entity.dataSourceId = sourceObj.id;
				objs.push(entity);
			}
			var p = saturn.core.Util.getProvider();
			p.insertObjects(objs,function(err1) {
				if(err1 != null) {
					cb("An error occurred inserting entities\n" + err1,null);
				} else {
					p.getByIds(ids,saturn.core.domain.Entity,function(objs1,err2) {
						if(err2 != null) {
							cb("An error occurred looking for inserted objects\n" + err2,null);
						} else {
							cb(null,objs1);
						}
					});
				}
			});
		}
	});
};
saturn.core.domain.Entity.getObjects = function(ids,cb) {
	var p = saturn.core.Util.getProvider();
	p.getByIds(ids,saturn.core.domain.Entity,function(objs,err) {
		if(err != null) {
			cb(err,null);
		} else {
			cb(null,objs);
		}
	});
};
saturn.core.domain.Entity.prototype = {
	id: null
	,entityId: null
	,dataSourceId: null
	,reactionId: null
	,entityTypeId: null
	,altName: null
	,description: null
	,source: null
	,reaction: null
	,entityType: null
	,__class__: saturn.core.domain.Entity
};
saturn.core.domain.FileProxy = $hxClasses["saturn.core.domain.FileProxy"] = function() {
};
saturn.core.domain.FileProxy.__name__ = ["saturn","core","domain","FileProxy"];
saturn.core.domain.FileProxy.prototype = {
	path: null
	,content: null
	,__class__: saturn.core.domain.FileProxy
};
saturn.core.domain.Molecule = $hxClasses["saturn.core.domain.Molecule"] = function() {
};
saturn.core.domain.Molecule.__name__ = ["saturn","core","domain","Molecule"];
saturn.core.domain.Molecule.prototype = {
	id: null
	,name: null
	,sequence: null
	,entityId: null
	,entity: null
	,__class__: saturn.core.domain.Molecule
};
saturn.core.domain.MoleculeAnnotation = $hxClasses["saturn.core.domain.MoleculeAnnotation"] = function() {
};
saturn.core.domain.MoleculeAnnotation.__name__ = ["saturn","core","domain","MoleculeAnnotation"];
saturn.core.domain.MoleculeAnnotation.prototype = {
	id: null
	,entityId: null
	,labelId: null
	,start: null
	,stop: null
	,evalue: null
	,altevalue: null
	,entity: null
	,referent: null
	,__class__: saturn.core.domain.MoleculeAnnotation
};
saturn.core.domain.Uploader = $hxClasses["saturn.core.domain.Uploader"] = function(source,evalue) {
	this.initialised = false;
	this.source = source;
	this.cutoff = evalue;
};
saturn.core.domain.Uploader.__name__ = ["saturn","core","domain","Uploader"];
saturn.core.domain.Uploader.prototype = {
	referentMap: null
	,provider: null
	,generator: null
	,initialised: null
	,source: null
	,cutoff: null
	,next: function(items,generator) {
		var _gthis = this;
		this.generator = generator;
		if(this.initialised == false) {
			this.provider = saturn.core.Util.getProvider();
			this.setupReferentMap(function(err) {
				if(err != null) {
					generator.die(err);
				} else {
					_gthis.initialised = true;
					_gthis.next(items,generator);
				}
			});
		} else {
			if(items.length == 0) {
				return;
			}
			var ids = saturn.db.Model.generateUniqueListWithField(items,"entity.entityId");
			var acList = saturn.db.Model.generateUniqueListWithField(items,"referent.entityId");
			var newReferents = [];
			var _g = 0;
			while(_g < acList.length) {
				var id = acList[_g];
				++_g;
				if(!this.referentMap.exists(id)) {
					newReferents.push(id);
				}
			}
			var _g1 = 0;
			while(_g1 < items.length) {
				var item = items[_g1];
				++_g1;
				if(item.evalue > this.cutoff) {
					HxOverrides.remove(items,item);
				}
			}
			this.insertReferents(newReferents,function(err1) {
				if(err1 != null) {
					generator.die(err1);
				} else {
					_gthis.provider.insertObjects(items,function(err2) {
						if(err2 != null) {
							generator.die(err2);
						} else {
							generator.next();
						}
					});
				}
			});
		}
	}
	,setupReferentMap: function(cb) {
		var _gthis = this;
		saturn.core.domain.DataSource.getEntities(this.source,function(err,objs) {
			if(err != null) {
				cb(err);
			} else {
				_gthis.referentMap = saturn.db.Model.generateIDMap(objs);
				cb(null);
			}
		});
	}
	,insertReferents: function(accessions,cb) {
		var _gthis = this;
		if(accessions.length == 0) {
			cb(null);
		} else {
			saturn.core.domain.Entity.insertList(accessions,this.source,function(err,objs) {
				if(err == null) {
					var _g = 0;
					while(_g < objs.length) {
						var obj = objs[_g];
						++_g;
						_gthis.referentMap.set(obj.entityId,obj.id);
					}
				}
				cb(err);
			});
		}
	}
	,__class__: saturn.core.domain.Uploader
};
saturn.core.domain.SgcAllele = $hxClasses["saturn.core.domain.SgcAllele"] = $hx_exports["saturn"]["core"]["domain"]["SgcAllele"] = function() {
	saturn.core.DNA.call(this,null);
	this.setup();
};
saturn.core.domain.SgcAllele.__name__ = ["saturn","core","domain","SgcAllele"];
saturn.core.domain.SgcAllele.__super__ = saturn.core.DNA;
saturn.core.domain.SgcAllele.prototype = $extend(saturn.core.DNA.prototype,{
	alleleId: null
	,id: null
	,entryCloneId: null
	,forwardPrimerId: null
	,reversePrimerId: null
	,dnaSeq: null
	,proteinSeq: null
	,plateWell: null
	,plate: null
	,entryClone: null
	,elnId: null
	,status: null
	,complex: null
	,forwardPrimer: null
	,reversePrimer: null
	,proteinSequenceObj: null
	,setup: function() {
		this.setSequence(this.dnaSeq);
		this.sequenceField = "dnaSeq";
		if(this.proteinSequenceObj == null) {
			this.proteinSequenceObj = new saturn.core.Protein(null);
		}
		this.addProtein("Translation",this.proteinSequenceObj);
	}
	,getMoleculeName: function() {
		return this.alleleId;
	}
	,loadProtein: function(cb) {
		this.proteinSequenceObj.setName(this.alleleId + " (Protein)");
		this.proteinSequenceObj.setDNA(this);
		cb(this.proteinSequenceObj);
	}
	,setSequence: function(sequence) {
		saturn.core.DNA.prototype.setSequence.call(this,sequence);
		this.dnaSeq = sequence;
	}
	,__class__: saturn.core.domain.SgcAllele
});
saturn.core.domain.SgcAllelePlate = $hxClasses["saturn.core.domain.SgcAllelePlate"] = function() {
};
saturn.core.domain.SgcAllelePlate.__name__ = ["saturn","core","domain","SgcAllelePlate"];
saturn.core.domain.SgcAllelePlate.prototype = {
	plateName: null
	,id: null
	,elnRef: null
	,setup: function() {
	}
	,loadPlate: function(cb) {
	}
	,__class__: saturn.core.domain.SgcAllelePlate
};
saturn.core.domain.SgcEntryClone = $hxClasses["saturn.core.domain.SgcEntryClone"] = function() {
	saturn.core.DNA.call(this,null);
	this.setup();
};
saturn.core.domain.SgcEntryClone.__name__ = ["saturn","core","domain","SgcEntryClone"];
saturn.core.domain.SgcEntryClone.__super__ = saturn.core.DNA;
saturn.core.domain.SgcEntryClone.prototype = $extend(saturn.core.DNA.prototype,{
	entryCloneId: null
	,id: null
	,dnaSeq: null
	,target: null
	,seqSource: null
	,sourceId: null
	,sequenceConfirmed: null
	,elnId: null
	,complex: null
	,proteinSequenceObj: null
	,complexOverride: null
	,getMoleculeName: function() {
		return this.entryCloneId;
	}
	,setup: function() {
		this.setSequence(this.dnaSeq);
		if(this.dnaSeq != null && this.dnaSeq != "" && this.dnaSeq.length > 2) {
			this.proteinSequenceObj = new saturn.core.Protein(this.getFrameTranslation(saturn.core.GeneticCodes.STANDARD,saturn.core.Frame.ONE));
		} else {
			this.proteinSequenceObj = new saturn.core.Protein(null);
		}
		this.proteinSequenceObj.setDNA(this);
		this.addProtein("Translation",this.proteinSequenceObj);
	}
	,setSequence: function(sequence) {
		saturn.core.DNA.prototype.setSequence.call(this,sequence);
		this.dnaSeq = sequence;
		if(this.proteinSequenceObj != null && this.dnaSeq != null && this.dnaSeq != "" && this.dnaSeq.length > 2) {
			this.proteinSequenceObj.setSequence(this.getFrameTranslation(saturn.core.GeneticCodes.STANDARD,saturn.core.Frame.ONE));
		}
	}
	,loadTranslation: function(cb) {
		this.proteinSequenceObj.setName(this.entryCloneId + " (Protein)");
		cb(this.proteinSequenceObj);
	}
	,__class__: saturn.core.domain.SgcEntryClone
});
saturn.core.domain.SgcForwardPrimer = $hxClasses["saturn.core.domain.SgcForwardPrimer"] = function() {
	saturn.core.DNA.call(this,null);
};
saturn.core.domain.SgcForwardPrimer.__name__ = ["saturn","core","domain","SgcForwardPrimer"];
saturn.core.domain.SgcForwardPrimer.__super__ = saturn.core.DNA;
saturn.core.domain.SgcForwardPrimer.prototype = $extend(saturn.core.DNA.prototype,{
	primerId: null
	,id: null
	,dnaSequence: null
	,targetId: null
	,setup: function() {
		this.setSequence(this.dnaSequence);
	}
	,getMoleculeName: function() {
		return this.primerId;
	}
	,setSequence: function(sequence) {
		saturn.core.DNA.prototype.setSequence.call(this,sequence);
		this.dnaSequence = sequence;
	}
	,__class__: saturn.core.domain.SgcForwardPrimer
});
saturn.core.domain.SgcReversePrimer = $hxClasses["saturn.core.domain.SgcReversePrimer"] = function() {
	saturn.core.DNA.call(this,null);
};
saturn.core.domain.SgcReversePrimer.__name__ = ["saturn","core","domain","SgcReversePrimer"];
saturn.core.domain.SgcReversePrimer.__super__ = saturn.core.DNA;
saturn.core.domain.SgcReversePrimer.prototype = $extend(saturn.core.DNA.prototype,{
	primerId: null
	,id: null
	,dnaSequence: null
	,targetId: null
	,setup: function() {
		this.setSequence(this.dnaSequence);
	}
	,getMoleculeName: function() {
		return this.primerId;
	}
	,setSequence: function(sequence) {
		saturn.core.DNA.prototype.setSequence.call(this,sequence);
		this.dnaSequence = sequence;
	}
	,__class__: saturn.core.domain.SgcReversePrimer
});
saturn.core.domain.SgcTarget = $hxClasses["saturn.core.domain.SgcTarget"] = function() {
	saturn.core.DNA.call(this,null);
	this.setup();
};
saturn.core.domain.SgcTarget.__name__ = ["saturn","core","domain","SgcTarget"];
saturn.core.domain.SgcTarget.__super__ = saturn.core.DNA;
saturn.core.domain.SgcTarget.prototype = $extend(saturn.core.DNA.prototype,{
	targetId: null
	,id: null
	,gi: null
	,dnaSeq: null
	,proteinSeq: null
	,geneId: null
	,activeStatus: null
	,pi: null
	,comments: null
	,proteinSequenceObj: null
	,complexComments: null
	,eln: null
	,complex: null
	,complexOverride: null
	,setup: function() {
		this.setSequence(this.dnaSeq);
		this.setName(this.targetId);
		this.sequenceField = "dnaSeq";
		if(this.proteinSequenceObj == null) {
			this.proteinSequenceObj = new saturn.core.Protein(null);
		}
		this.addProtein("Translation",this.proteinSequenceObj);
	}
	,proteinSequenceUpdated: function(sequence) {
		this.proteinSeq = sequence;
	}
	,setSequence: function(sequence) {
		saturn.core.DNA.prototype.setSequence.call(this,sequence);
		this.dnaSeq = sequence;
	}
	,loadWonka: function() {
	}
	,__class__: saturn.core.domain.SgcTarget
});
saturn.core.molecule.MoleculeFloatAttribute = $hxClasses["saturn.core.molecule.MoleculeFloatAttribute"] = { __ename__ : ["saturn","core","molecule","MoleculeFloatAttribute"], __constructs__ : ["MW","MW_CONDESATION"] };
saturn.core.molecule.MoleculeFloatAttribute.MW = ["MW",0];
saturn.core.molecule.MoleculeFloatAttribute.MW.toString = $estr;
saturn.core.molecule.MoleculeFloatAttribute.MW.__enum__ = saturn.core.molecule.MoleculeFloatAttribute;
saturn.core.molecule.MoleculeFloatAttribute.MW_CONDESATION = ["MW_CONDESATION",1];
saturn.core.molecule.MoleculeFloatAttribute.MW_CONDESATION.toString = $estr;
saturn.core.molecule.MoleculeFloatAttribute.MW_CONDESATION.__enum__ = saturn.core.molecule.MoleculeFloatAttribute;
saturn.core.molecule.MoleculeStringAttribute = $hxClasses["saturn.core.molecule.MoleculeStringAttribute"] = { __ename__ : ["saturn","core","molecule","MoleculeStringAttribute"], __constructs__ : ["NAME"] };
saturn.core.molecule.MoleculeStringAttribute.NAME = ["NAME",0];
saturn.core.molecule.MoleculeStringAttribute.NAME.toString = $estr;
saturn.core.molecule.MoleculeStringAttribute.NAME.__enum__ = saturn.core.molecule.MoleculeStringAttribute;
saturn.core.molecule.MoleculeAlignMode = $hxClasses["saturn.core.molecule.MoleculeAlignMode"] = { __ename__ : ["saturn","core","molecule","MoleculeAlignMode"], __constructs__ : ["REGEX","SIMPLE"] };
saturn.core.molecule.MoleculeAlignMode.REGEX = ["REGEX",0];
saturn.core.molecule.MoleculeAlignMode.REGEX.toString = $estr;
saturn.core.molecule.MoleculeAlignMode.REGEX.__enum__ = saturn.core.molecule.MoleculeAlignMode;
saturn.core.molecule.MoleculeAlignMode.SIMPLE = ["SIMPLE",1];
saturn.core.molecule.MoleculeAlignMode.SIMPLE.toString = $estr;
saturn.core.molecule.MoleculeAlignMode.SIMPLE.__enum__ = saturn.core.molecule.MoleculeAlignMode;
saturn.core.molecule.MoleculeConstants = $hxClasses["saturn.core.molecule.MoleculeConstants"] = function() { };
saturn.core.molecule.MoleculeConstants.__name__ = ["saturn","core","molecule","MoleculeConstants"];
saturn.core.molecule.MoleculeSets = $hxClasses["saturn.core.molecule.MoleculeSets"] = { __ename__ : ["saturn","core","molecule","MoleculeSets"], __constructs__ : ["STANDARD"] };
saturn.core.molecule.MoleculeSets.STANDARD = ["STANDARD",0];
saturn.core.molecule.MoleculeSets.STANDARD.toString = $estr;
saturn.core.molecule.MoleculeSets.STANDARD.__enum__ = saturn.core.molecule.MoleculeSets;
saturn.core.molecule.MoleculeSetRegistry = $hxClasses["saturn.core.molecule.MoleculeSetRegistry"] = function() {
	this.moleculeSets = new haxe.ds.StringMap();
	this.register(saturn.core.molecule.MoleculeSets.STANDARD,new saturn.core.StandardMoleculeSet());
};
saturn.core.molecule.MoleculeSetRegistry.__name__ = ["saturn","core","molecule","MoleculeSetRegistry"];
saturn.core.molecule.MoleculeSetRegistry.getStandardMoleculeSet = function() {
	return saturn.core.molecule.MoleculeSetRegistry.defaultRegistry.get(saturn.core.molecule.MoleculeSets.STANDARD);
};
saturn.core.molecule.MoleculeSetRegistry.prototype = {
	moleculeSets: null
	,register: function(setType,set) {
		this.registerSet(Std.string(setType),set);
	}
	,get: function(setType) {
		return this.getSet(Std.string(setType));
	}
	,registerSet: function(name,set) {
		this.moleculeSets.set(name,set);
	}
	,getSet: function(name) {
		return this.moleculeSets.get(name);
	}
	,__class__: saturn.core.molecule.MoleculeSetRegistry
};
if(!saturn.core.parsers) saturn.core.parsers = {};
saturn.core.parsers.BaseParser = $hxClasses["saturn.core.parsers.BaseParser"] = function(path,handler,done) {
	this.lineCount = 0;
	var _gthis = this;
	saturn.core.Generator.call(this,-1);
	this.doneCB = done;
	this.path = path;
	this.setMaxAtOnce(200);
	this.onEnd(done);
	this.onNext(function(objs,next,c) {
		handler(objs,_gthis);
	});
	if(path != null) {
		this.read();
	}
};
saturn.core.parsers.BaseParser.__name__ = ["saturn","core","parsers","BaseParser"];
saturn.core.parsers.BaseParser.__super__ = saturn.core.Generator;
saturn.core.parsers.BaseParser.prototype = $extend(saturn.core.Generator.prototype,{
	doneCB: null
	,path: null
	,content: null
	,lineCount: null
	,setContent: function(content) {
		this.content = content;
		this.read();
	}
	,read: function() {
		var _gthis = this;
		if(this.path != null) {
			saturn.core.Util.open(this.path,function(err,line) {
				if(err != null) {
					_gthis.die("Error reading file");
				} else {
					_gthis.lineCount++;
					if(line == null) {
						saturn.core.Util.debug("Lines read: " + _gthis.lineCount);
						_gthis.finished();
					} else {
						var obj = _gthis.parseLine(line);
						if(obj != null) {
							_gthis.push(obj);
						}
					}
				}
			});
		} else if(this.content != null) {
			var lines = this.content.split("\n");
			var _g = 0;
			while(_g < lines.length) {
				var line1 = lines[_g];
				++_g;
				var obj1 = this.parseLine(line1);
				if(obj1 != null) {
					this.push(obj1);
				}
			}
			this.finished();
		}
	}
	,parseLine: function(line) {
		return null;
	}
	,__class__: saturn.core.parsers.BaseParser
});
if(!saturn.db) saturn.db = {};
saturn.db.BatchFetch = $hxClasses["saturn.db.BatchFetch"] = function(onError) {
	this.items = new haxe.ds.StringMap();
	this.fetchList = [];
	this.retrieved = new haxe.ds.StringMap();
	this.position = 0;
	this.onError = onError;
};
saturn.db.BatchFetch.__name__ = ["saturn","db","BatchFetch"];
saturn.db.BatchFetch.prototype = {
	fetchList: null
	,userOnError: null
	,userOnComplete: null
	,position: null
	,retrieved: null
	,onComplete: null
	,onError: null
	,provider: null
	,items: null
	,onFinish: function(cb) {
		this.onComplete = cb;
	}
	,getById: function(objectId,clazz,key,callBack) {
		var list = [];
		list.push(objectId);
		return this.getByIds(list,clazz,key,callBack);
	}
	,getByIds: function(objectIds,clazz,key,callBack) {
		var work = new haxe.ds.StringMap();
		work.set("IDS",objectIds);
		work.set("CLASS",clazz);
		work.set("TYPE","getByIds");
		work.set("KEY",key);
		work.set("CALLBACK",callBack);
		this.fetchList.push(work);
		return this;
	}
	,getByValue: function(value,clazz,field,key,callBack) {
		var list = [];
		list.push(value);
		return this.getByValues(list,clazz,field,key,callBack);
	}
	,getByValues: function(values,clazz,field,key,callBack) {
		var work = new haxe.ds.StringMap();
		work.set("VALUES",values);
		work.set("CLASS",clazz);
		work.set("FIELD",field);
		work.set("TYPE","getByValues");
		work.set("KEY",key);
		work.set("CALLBACK",callBack);
		this.fetchList.push(work);
		return this;
	}
	,getByPkey: function(objectId,clazz,key,callBack) {
		var list = [];
		list.push(objectId);
		return this.getByPkeys(list,clazz,key,callBack);
	}
	,getByPkeys: function(objectIds,clazz,key,callBack) {
		var work = new haxe.ds.StringMap();
		work.set("IDS",objectIds);
		work.set("CLASS",clazz);
		work.set("TYPE","getByPkeys");
		work.set("KEY",key);
		work.set("CALLBACK",callBack);
		this.fetchList.push(work);
		return this;
	}
	,append: function(val,field,clazz,cb) {
		var key = Type.getClassName(clazz) + "." + field;
		if(!this.items.exists(key)) {
			this.items.set(key,[]);
		}
		this.items.get(key).push({ val : val, field : field, clazz : clazz, cb : cb});
	}
	,next: function() {
		this.execute();
	}
	,setProvider: function(provider) {
		this.provider = provider;
	}
	,execute: function(cb) {
		var _gthis = this;
		var provider = this.provider;
		if(provider == null) {
			provider = saturn.client.core.CommonCore.getDefaultProvider();
		}
		if(cb != null) {
			this.onFinish(cb);
		}
		var key = this.items.keys();
		while(key.hasNext()) {
			var key1 = key.next();
			var units = this.items.get(key1);
			var work = new haxe.ds.StringMap();
			work.set("TYPE","FETCHITEM");
			work.set("FIELD",units[0].field);
			work.set("CLASS",units[0].clazz);
			work.set("ITEMS",units);
			this.items.remove(key1);
			this.fetchList.push(work);
		}
		if(this.position == this.fetchList.length) {
			this.onComplete();
			return;
		}
		var work1 = this.fetchList[this.position];
		var type = work1.get("TYPE");
		this.position++;
		if(type == "getByIds") {
			provider.getByIds(work1.get("IDS"),work1.get("CLASS"),function(objs,exception) {
				if(exception != null || objs == null) {
					_gthis.onError(objs,exception);
				} else {
					_gthis.retrieved.set(work1.get("KEY"),objs);
					var userCallBack = work1.get("CALLBACK");
					if(userCallBack != null) {
						userCallBack(objs,exception);
					} else if(_gthis.position == _gthis.fetchList.length) {
						_gthis.onComplete();
					} else {
						_gthis.execute();
					}
				}
			});
		} else if(type == "getByValues") {
			provider.getByValues(work1.get("VALUES"),work1.get("CLASS"),work1.get("FIELD"),function(objs1,exception1) {
				if(exception1 != null || objs1 == null) {
					_gthis.onError(objs1,exception1);
				} else {
					_gthis.retrieved.set(work1.get("KEY"),objs1);
					var userCallBack1 = work1.get("CALLBACK");
					if(userCallBack1 != null) {
						userCallBack1(objs1,exception1);
					} else if(_gthis.position == _gthis.fetchList.length) {
						_gthis.onComplete();
					} else {
						_gthis.execute();
					}
				}
			});
		} else if(type == "getByPkeys") {
			provider.getByPkeys(work1.get("IDS"),work1.get("CLASS"),function(obj,exception2) {
				if(exception2 != null || obj == null) {
					_gthis.onError(obj,exception2);
				} else {
					_gthis.retrieved.set(work1.get("KEY"),obj);
					var userCallBack2 = work1.get("CALLBACK");
					if(userCallBack2 != null) {
						userCallBack2(obj,exception2);
					} else if(_gthis.position == _gthis.fetchList.length) {
						_gthis.onComplete();
					} else {
						_gthis.execute();
					}
				}
			});
		} else if(type == "FETCHITEM") {
			var items = work1.get("ITEMS");
			var itemMap = new haxe.ds.StringMap();
			var _g = 0;
			while(_g < items.length) {
				var item = items[_g];
				++_g;
				if(!itemMap.exists(item.val)) {
					var key2 = item.val;
					var value = [];
					itemMap.set(key2,value);
				}
				itemMap.get(item.val).push(item.cb);
			}
			var values = [];
			var key3 = itemMap.keys();
			while(key3.hasNext()) {
				var key4 = key3.next();
				values.push(key4);
			}
			var field = work1.get("FIELD");
			provider.getByValues(values,work1.get("CLASS"),field,function(objs2,exception3) {
				if(exception3 != null || objs2 == null) {
					_gthis.onError(objs2,exception3);
				} else {
					var _g1 = 0;
					while(_g1 < objs2.length) {
						var obj1 = objs2[_g1];
						++_g1;
						var fieldValue = Reflect.field(obj1,field);
						if(itemMap.exists(fieldValue)) {
							var _g11 = 0;
							var _g2 = itemMap.get(fieldValue);
							while(_g11 < _g2.length) {
								var cb1 = _g2[_g11];
								++_g11;
								cb1(obj1);
							}
						}
					}
					if(_gthis.position == _gthis.fetchList.length) {
						_gthis.onComplete();
					} else {
						_gthis.execute();
					}
				}
			});
		}
	}
	,getObject: function(key) {
		return this.retrieved.get(key);
	}
	,__class__: saturn.db.BatchFetch
};
saturn.db.Connection = $hxClasses["saturn.db.Connection"] = function() { };
saturn.db.Connection.__name__ = ["saturn","db","Connection"];
saturn.db.Connection.prototype = {
	execute: null
	,close: null
	,commit: null
	,setAutoCommit: null
	,__class__: saturn.db.Connection
};
saturn.db.Provider = $hxClasses["saturn.db.Provider"] = function() { };
saturn.db.Provider.__name__ = ["saturn","db","Provider"];
saturn.db.Provider.prototype = {
	getById: null
	,getByIds: null
	,getByPkey: null
	,getByPkeys: null
	,getByIdStartsWith: null
	,update: null
	,insert: null
	,'delete': null
	,generateQualifiedName: null
	,updateObjects: null
	,insertObjects: null
	,insertOrUpdate: null
	,rollback: null
	,commit: null
	,isAttached: null
	,sql: null
	,getByNamedQuery: null
	,getObjectFromCache: null
	,activate: null
	,getModel: null
	,getObjectModel: null
	,save: null
	,modelToReal: null
	,attach: null
	,resetCache: null
	,evictNamedQuery: null
	,readModels: null
	,dataBinding: null
	,isDataBinding: null
	,setSelectClause: null
	,_update: null
	,_insert: null
	,_delete: null
	,getByValue: null
	,getByValues: null
	,getObjects: null
	,queryPath: null
	,getModels: null
	,getModelClasses: null
	,connectAsUser: null
	,setConnectAsUser: null
	,enableCache: null
	,generatedLinkedClone: null
	,setUser: null
	,getUser: null
	,closeConnection: null
	,_closeConnection: null
	,setAutoCommit: null
	,setName: null
	,getName: null
	,getConfig: null
	,setConfig: null
	,evictObject: null
	,getByExample: null
	,query: null
	,getQuery: null
	,getProviderType: null
	,getModelByStringName: null
	,getConnection: null
	,uploadFile: null
	,addHook: null
	,__class__: saturn.db.Provider
};
saturn.db.DefaultProvider = $hxClasses["saturn.db.DefaultProvider"] = function(binding_map,config,autoClose) {
	this.user = null;
	this.namedQueryHookConfigs = new haxe.ds.StringMap();
	this.namedQueryHooks = new haxe.ds.StringMap();
	this.connectWithUserCreds = false;
	this.enableBinding = true;
	this.useCache = true;
	this.setPlatform();
	if(binding_map != null) {
		this.setModels(binding_map);
	}
	this.config = config;
	this.autoClose = autoClose;
	this.namedQueryHooks = new haxe.ds.StringMap();
	if(config != null && Reflect.hasField(config,"named_query_hooks")) {
		this.addHooks(Reflect.field(config,"named_query_hooks"));
	}
	var hook = this.namedQueryHooks.keys();
	while(hook.hasNext()) {
		var hook1 = hook.next();
		saturn.core.Util.debug("Installed hook: " + hook1 + "/" + Std.string(this.namedQueryHooks.get(hook1)));
	}
};
saturn.db.DefaultProvider.__name__ = ["saturn","db","DefaultProvider"];
saturn.db.DefaultProvider.__interfaces__ = [saturn.db.Provider];
saturn.db.DefaultProvider.prototype = {
	theBindingMap: null
	,fieldIndexMap: null
	,objectCache: null
	,namedQueryCache: null
	,useCache: null
	,enableBinding: null
	,connectWithUserCreds: null
	,namedQueryHooks: null
	,namedQueryHookConfigs: null
	,modelClasses: null
	,user: null
	,autoClose: null
	,name: null
	,config: null
	,winConversions: null
	,linConversions: null
	,conversions: null
	,regexs: null
	,platform: null
	,setPlatform: function() {
		return;
	}
	,generateQualifiedName: function(schemaName,tableName) {
		return null;
	}
	,getConfig: function() {
		return this.config;
	}
	,setConfig: function(config) {
		this.config = config;
	}
	,setName: function(name) {
		this.name = name;
	}
	,getName: function() {
		return this.name;
	}
	,setUser: function(user) {
		this.user = user;
		this._closeConnection();
	}
	,getUser: function() {
		return this.user;
	}
	,closeConnection: function(connection) {
		if(this.autoClose) {
			this._closeConnection();
		}
	}
	,_closeConnection: function() {
	}
	,generatedLinkedClone: function() {
		var clazz = Type.getClass(this);
		var provider = Type.createEmptyInstance(clazz);
		provider.theBindingMap = this.theBindingMap;
		provider.fieldIndexMap = this.fieldIndexMap;
		provider.namedQueryCache = this.namedQueryCache;
		provider.useCache = this.useCache;
		provider.enableBinding = this.enableBinding;
		provider.connectWithUserCreds = this.connectWithUserCreds;
		provider.namedQueryHooks = this.namedQueryHooks;
		provider.modelClasses = this.modelClasses;
		provider.platform = this.platform;
		provider.linConversions = this.linConversions;
		provider.winConversions = this.winConversions;
		provider.conversions = this.conversions;
		provider.regexs = this.regexs;
		provider.namedQueryHookConfigs = this.namedQueryHookConfigs;
		provider.config = this.config;
		provider.objectCache = new haxe.ds.StringMap();
		return provider;
	}
	,enableCache: function(cached) {
		this.useCache = cached;
	}
	,connectAsUser: function() {
		return this.connectWithUserCreds;
	}
	,setConnectAsUser: function(asUser) {
		this.connectWithUserCreds = asUser;
	}
	,setModels: function(binding_map) {
		this.theBindingMap = binding_map;
		var clazz = binding_map.keys();
		while(clazz.hasNext()) {
			var clazz1 = clazz.next();
			if(binding_map.get(clazz1).exists("polymorphic")) {
				if(!binding_map.get(clazz1).exists("fields.synthetic")) {
					binding_map.get(clazz1).set("fields.synthetic",new haxe.ds.StringMap());
				}
				var d = binding_map.get(clazz1).get("fields.synthetic");
				d.set("polymorphic",binding_map.get(clazz1).get("polymorphic"));
			}
		}
		this.initModelClasses();
		this.resetCache();
	}
	,readModels: function(cb) {
	}
	,postConfigureModels: function() {
		var class_name = this.theBindingMap.keys();
		while(class_name.hasNext()) {
			var class_name1 = class_name.next();
			var d = this.theBindingMap.get(class_name1);
			d.set("provider_name",this.getName());
			saturn.core.Util.debug(class_name1 + " on " + this.getName());
		}
		if(this.isModel(saturn.core.domain.FileProxy)) {
			this.winConversions = this.getModel(saturn.core.domain.FileProxy).getOptions().get("windows_conversions");
			this.linConversions = this.getModel(saturn.core.domain.FileProxy).getOptions().get("linux_conversions");
			if(this.platform == "windows") {
				this.conversions = this.winConversions;
				this.regexs = this.getModel(saturn.core.domain.FileProxy).getOptions().get("windows_allowed_paths_regex");
			} else if(this.platform == "linux") {
				this.conversions = this.linConversions;
				this.regexs = this.getModel(saturn.core.domain.FileProxy).getOptions().get("linux_allowed_paths_regex");
			}
			if(this.regexs != null) {
				var key = this.regexs.keys();
				while(key.hasNext()) {
					var key1 = key.next();
					var s = js.Boot.__cast(this.regexs.get(key1) , String);
					this.regexs.set(key1,new EReg(s,""));
				}
			}
		}
	}
	,getModels: function() {
		return this.theBindingMap;
	}
	,resetCache: function() {
		this.objectCache = new haxe.ds.StringMap();
		if(this.theBindingMap != null) {
			var className = this.theBindingMap.keys();
			while(className.hasNext()) {
				var className1 = className.next();
				this.theBindingMap.get(className1).set("statements",new haxe.ds.StringMap());
				this.objectCache.set(className1,new haxe.ds.StringMap());
				if(this.theBindingMap.get(className1).exists("indexes")) {
					var field = this.theBindingMap.get(className1).get("indexes").keys();
					while(field.hasNext()) {
						var field1 = field.next();
						this.objectCache.get(className1).set(field1,new haxe.ds.StringMap());
					}
				}
			}
		}
		this.namedQueryCache = new haxe.ds.StringMap();
	}
	,getObjectFromCache: function(clazz,field,val) {
		var className = Type.getClassName(clazz);
		if(this.objectCache.exists(className)) {
			if(this.objectCache.get(className).exists(field)) {
				if(this.objectCache.get(className).get(field).exists(val)) {
					return this.objectCache.get(className).get(field).get(val);
				} else {
					return null;
				}
			} else {
				return null;
			}
		} else {
			return null;
		}
	}
	,initialiseObjects: function(idsToFetch,toBind,prefetched,exception,callBack,clazz,bindField,cache,allowAutoBind) {
		if(allowAutoBind == null) {
			allowAutoBind = true;
		}
		if(idsToFetch.length > 0 && toBind == null || clazz == null || toBind != null && toBind.length > 0 && clazz != null && Std["is"](toBind[0],clazz)) {
			callBack(toBind,exception);
		} else {
			var model = this.getModel(clazz);
			if(model == null) {
				var boundObjs = [];
				var _g = 0;
				while(_g < toBind.length) {
					var item = toBind[_g];
					++_g;
					var obj = Type.createInstance(clazz,[]);
					var _g1 = 0;
					var _g2 = Type.getInstanceFields(clazz);
					while(_g1 < _g2.length) {
						var field = _g2[_g1];
						++_g1;
						if(Reflect.hasField(item,field)) {
							Reflect.setField(obj,field,Reflect.field(item,field));
						}
					}
					boundObjs.push(obj);
				}
				callBack(boundObjs,exception);
				return;
			}
			var autoActivate = model.getAutoActivateLevel();
			var surpressSetup = false;
			if(autoActivate != -1 && this.enableBinding && allowAutoBind) {
				surpressSetup = true;
			}
			var boundObjs1 = [];
			if(toBind != null) {
				var _g3 = 0;
				while(_g3 < toBind.length) {
					var obj1 = toBind[_g3];
					++_g3;
					var tmp = this.bindObject(obj1,clazz,cache,bindField,surpressSetup);
					boundObjs1.push(tmp);
				}
			}
			if(autoActivate != -1 && this.enableBinding && allowAutoBind) {
				this.activate(boundObjs1,autoActivate,function(err) {
					if(err == null) {
						var _g4 = 0;
						while(_g4 < boundObjs1.length) {
							var boundObj = boundObjs1[_g4];
							++_g4;
							if(Reflect.isFunction(boundObj.setup)) {
								boundObj.setup();
							}
						}
						if(prefetched != null) {
							var _g5 = 0;
							while(_g5 < prefetched.length) {
								var obj2 = prefetched[_g5];
								++_g5;
								boundObjs1.push(obj2);
							}
						}
						callBack(boundObjs1,exception);
					} else {
						callBack(null,err);
					}
				});
			} else {
				if(prefetched != null) {
					var _g6 = 0;
					while(_g6 < prefetched.length) {
						var obj3 = prefetched[_g6];
						++_g6;
						boundObjs1.push(obj3);
					}
				}
				callBack(boundObjs1,exception);
			}
		}
	}
	,getById: function(id,clazz,callBack) {
		this.getByIds([id],clazz,function(objs,exception) {
			if(objs != null) {
				callBack(objs[0],exception);
			} else {
				callBack(null,exception);
			}
		});
	}
	,getByIds: function(ids,clazz,callBack) {
		var _gthis = this;
		var prefetched = null;
		var idsToFetch = null;
		if(this.useCache) {
			var model = this.getModel(clazz);
			if(model != null) {
				var firstKey = model.getFirstKey();
				prefetched = [];
				idsToFetch = [];
				var _g = 0;
				while(_g < ids.length) {
					var id = ids[_g];
					++_g;
					var cacheObject = this.getObjectFromCache(clazz,firstKey,id);
					if(cacheObject != null) {
						prefetched.push(cacheObject);
					} else {
						idsToFetch.push(id);
					}
				}
			} else {
				idsToFetch = ids;
			}
		} else {
			idsToFetch = ids;
		}
		if(idsToFetch.length > 0) {
			this._getByIds(idsToFetch,clazz,function(toBind,exception) {
				_gthis.initialiseObjects(idsToFetch,toBind,prefetched,exception,callBack,clazz,null,true);
			});
		} else {
			callBack(prefetched,null);
		}
	}
	,_getByIds: function(ids,clazz,callBack) {
	}
	,getByExample: function(obj,cb) {
		var q = this.getQuery();
		q.addExample(obj);
		q.run(cb);
		return q;
	}
	,query: function(query,cb) {
		var _gthis = this;
		this._query(query,function(objs,err) {
			if(_gthis.isDataBinding()) {
				if(err == null) {
					var clazzList = query.getSelectClassList();
					if(query.bindResults() && clazzList != null) {
						if(clazzList.length == 1) {
							var tmp = Type.resolveClass(clazzList[0]);
							_gthis.initialiseObjects([],objs,[],err,cb,tmp,null,true);
						}
					} else {
						cb(objs,err);
					}
				} else {
					cb(null,err);
				}
			} else {
				cb(objs,err);
			}
		});
	}
	,_query: function(query,cb) {
	}
	,getByValue: function(value,clazz,field,callBack) {
		this.getByValues([value],clazz,field,function(objs,exception) {
			if(objs != null) {
				callBack(objs[0],exception);
			} else {
				callBack(null,exception);
			}
		});
	}
	,getByValues: function(ids,clazz,field,callBack) {
		var _gthis = this;
		var prefetched = null;
		var idsToFetch = null;
		saturn.core.Util.debug("Using cache " + Std.string(this.useCache));
		if(this.useCache) {
			saturn.core.Util.debug("Using cache " + Std.string(this.useCache));
			var model = this.getModel(clazz);
			if(model != null) {
				prefetched = [];
				idsToFetch = [];
				var _g = 0;
				while(_g < ids.length) {
					var id = ids[_g];
					++_g;
					var cacheObject = this.getObjectFromCache(clazz,field,id);
					if(cacheObject != null) {
						if((cacheObject instanceof Array) && cacheObject.__enum__ == null) {
							var objArray = cacheObject;
							var _g1 = 0;
							while(_g1 < objArray.length) {
								var obj = objArray[_g1];
								++_g1;
								prefetched.push(obj);
							}
						} else {
							prefetched.push(cacheObject);
						}
					} else {
						idsToFetch.push(id);
					}
				}
			} else {
				idsToFetch = ids;
			}
		} else {
			idsToFetch = ids;
		}
		if(idsToFetch.length > 0) {
			this._getByValues(idsToFetch,clazz,field,function(toBind,exception) {
				_gthis.initialiseObjects(idsToFetch,toBind,prefetched,exception,callBack,clazz,field,true);
			});
		} else {
			callBack(prefetched,null);
		}
	}
	,_getByValues: function(values,clazz,field,callBack) {
	}
	,getObjects: function(clazz,callBack) {
		var _gthis = this;
		this._getObjects(clazz,function(toBind,exception) {
			if(exception != null) {
				callBack(null,exception);
			} else {
				_gthis.initialiseObjects([],toBind,[],exception,callBack,clazz,null,true);
			}
		});
	}
	,_getObjects: function(clazz,callBack) {
	}
	,getByPkey: function(id,clazz,callBack) {
		this.getByPkeys([id],clazz,function(objs,exception) {
			if(objs != null) {
				callBack(objs[0],exception);
			} else {
				callBack(null,exception);
			}
		});
	}
	,getByPkeys: function(ids,clazz,callBack) {
		var _gthis = this;
		var prefetched = null;
		var idsToFetch = null;
		if(this.useCache) {
			var model = this.getModel(clazz);
			if(model != null) {
				var priField = model.getPrimaryKey();
				prefetched = [];
				idsToFetch = [];
				var _g = 0;
				while(_g < ids.length) {
					var id = ids[_g];
					++_g;
					var cacheObject = this.getObjectFromCache(clazz,priField,id);
					if(cacheObject != null) {
						prefetched.push(cacheObject);
					} else {
						idsToFetch.push(id);
					}
				}
			} else {
				idsToFetch = ids;
			}
		} else {
			idsToFetch = ids;
		}
		if(idsToFetch.length > 0) {
			this._getByPkeys(idsToFetch,clazz,function(toBind,exception) {
				_gthis.initialiseObjects(idsToFetch,toBind,prefetched,exception,callBack,clazz,null,true);
			});
		} else {
			callBack(prefetched,null);
		}
	}
	,_getByPkeys: function(ids,clazz,callBack) {
	}
	,getConnection: function(config,cb) {
	}
	,sql: function(sql,parameters,cb) {
		this.getByNamedQuery("saturn.db.provider.hooks.RawSQLHook:SQL",[sql,parameters],null,false,cb);
	}
	,getByNamedQuery: function(queryId,parameters,clazz,cache,callBack) {
		var _gthis = this;
		saturn.core.Util.debug("In getByNamedQuery " + (cache == null ? "null" : "" + cache));
		try {
			if(cache) {
				saturn.core.Util.debug("Looking for cached result");
				var queries = this.namedQueryCache.get(queryId);
				var serialParamString = haxe.Serializer.run(parameters);
				var crc = haxe.crypto.Md5.encode(queryId + "/" + serialParamString);
				if(this.namedQueryCache.exists(crc)) {
					var qResults = this.namedQueryCache.get(crc).queryResults;
					saturn.core.Util.debug("Use cached result");
					callBack(qResults,null);
					return;
				}
			}
			var privateCB = function(toBind,exception) {
				if(toBind == null) {
					callBack(toBind,exception);
				} else {
					_gthis.initialiseObjects([],toBind,[],exception,function(objs,err) {
						if(_gthis.useCache) {
							saturn.core.Util.debug("Caching result");
							var namedQuery = new saturn.db.NamedQueryCache();
							namedQuery.queryName = queryId;
							namedQuery.queryParams = parameters;
							namedQuery.queryParamSerial = haxe.Serializer.run(parameters);
							namedQuery.queryResults = objs;
							var crc1 = haxe.crypto.Md5.encode(queryId + "/" + namedQuery.queryParamSerial);
							_gthis.namedQueryCache.set(crc1,namedQuery);
						}
						callBack(objs,err);
					},clazz,null,cache);
				}
			};
			if(queryId == "saturn.workflow") {
				var jobName = parameters[0];
				var config = parameters[1];
				saturn.core.Util.debug("Got workflow query " + jobName);
				saturn.core.Util.debug(Type.getClassName(Type.getClass(config)));
				if(this.namedQueryHooks.exists(jobName)) {
					this.namedQueryHooks.get(jobName)(config,function(object,error) {
						var tmp = object.getError();
						privateCB([object],tmp);
					});
				} else {
					saturn.core.Util.debug("Unknown workflow query");
					this._getByNamedQuery(queryId,parameters,clazz,privateCB);
				}
			} else if(this.namedQueryHooks.exists(queryId)) {
				saturn.core.Util.debug("Hook is known");
				var config1 = null;
				if(this.namedQueryHookConfigs.exists(queryId)) {
					config1 = this.namedQueryHookConfigs.get(queryId);
				}
				saturn.core.Util.debug("Calling hook");
				this.namedQueryHooks.get(queryId)(queryId,parameters,clazz,privateCB,config1);
			} else {
				saturn.core.Util.debug("Hook is not known");
				this._getByNamedQuery(queryId,parameters,clazz,privateCB);
			}
		} catch( ex ) {
			if (ex instanceof js._Boot.HaxeError) ex = ex.val;
			saturn.core.Util.debug(ex);
			callBack(null,"An unexpected exception has occurred");
		}
	}
	,addHooks: function(hooks) {
		var _g = 0;
		while(_g < hooks.length) {
			var hookdef = hooks[_g];
			++_g;
			var name = Reflect.field(hookdef,"name");
			var hook;
			if(Reflect.hasField(hookdef,"func")) {
				hook = Reflect.field(hookdef,"func");
			} else {
				var clazz = Reflect.field(hookdef,"class");
				var method = Reflect.field(hookdef,"method");
				hook = Reflect.field(Type.resolveClass(clazz),method);
			}
			this.namedQueryHooks.set(name,hook);
			this.namedQueryHookConfigs.set(name,hookdef);
		}
	}
	,addHook: function(hook,name) {
		this.namedQueryHooks.set(name,hook);
	}
	,_getByNamedQuery: function(queryId,parameters,clazz,callBack) {
	}
	,getByIdStartsWith: function(id,field,clazz,limit,callBack) {
		var _gthis = this;
		saturn.core.Util.debug("Starts with using cache " + Std.string(this.useCache));
		var queryId = "__STARTSWITH_" + Type.getClassName(clazz);
		var parameters = [];
		parameters.push(field);
		parameters.push(id);
		var crc = null;
		if(this.useCache) {
			var crc1 = haxe.crypto.Md5.encode(queryId + "/" + haxe.Serializer.run(parameters));
			if(this.namedQueryCache.exists(crc1)) {
				var tmp = this.namedQueryCache.get(crc1);
				callBack(tmp.queryResults,null);
				return;
			}
		}
		this._getByIdStartsWith(id,field,clazz,limit,function(toBind,exception) {
			if(toBind == null) {
				callBack(toBind,exception);
			} else {
				_gthis.initialiseObjects([],toBind,[],exception,function(objs,err) {
					if(_gthis.useCache) {
						var namedQuery = new saturn.db.NamedQueryCache();
						namedQuery.queryName = queryId;
						namedQuery.queryParams = parameters;
						namedQuery.queryResults = objs;
						_gthis.namedQueryCache.set(crc,namedQuery);
					}
					callBack(objs,err);
				},clazz,null,false,false);
			}
		});
	}
	,_getByIdStartsWith: function(id,field,clazz,limit,callBack) {
	}
	,update: function(object,callBack) {
		this.synchronizeInternalLinks([object]);
		var className = Type.getClassName(Type.getClass(object));
		this.evictObject(object);
		var attributeMaps = [];
		attributeMaps.push(this.unbindObject(object));
		this._update(attributeMaps,className,callBack);
	}
	,insert: function(obj,cb) {
		var _gthis = this;
		this.synchronizeInternalLinks([obj]);
		var className = Type.getClassName(Type.getClass(obj));
		this.evictObject(obj);
		var attributeMaps = [];
		attributeMaps.push(this.unbindObject(obj));
		this._insert(attributeMaps,className,function(err) {
			if(err == null) {
				_gthis.attach([obj],true,function(err1) {
					cb(err1);
				});
			} else {
				cb(err);
			}
		});
	}
	,'delete': function(obj,cb) {
		var _gthis = this;
		var className = Type.getClassName(Type.getClass(obj));
		var attributeMaps = [];
		attributeMaps.push(this.unbindObject(obj));
		this.evictObject(obj);
		this._delete(attributeMaps,className,function(err) {
			var model = Type.getClass(obj);
			var model1 = _gthis.getModel(model);
			var field = model1.getPrimaryKey();
			Reflect.setField(obj,field,null);
			cb(err);
		});
	}
	,evictObject: function(object) {
		var clazz = Type.getClass(object);
		var className = Type.getClassName(clazz);
		if(this.objectCache.exists(className)) {
			var indexField = this.objectCache.get(className).keys();
			while(indexField.hasNext()) {
				var indexField1 = indexField.next();
				var val = Reflect.field(object,indexField1);
				if(val != null && val != "") {
					if(this.objectCache.get(className).get(indexField1).exists(val)) {
						this.objectCache.get(className).get(indexField1).remove(val);
					}
				}
			}
		}
	}
	,evictNamedQuery: function(queryId,parameters) {
		var crc = haxe.crypto.Md5.encode(queryId + "/" + haxe.Serializer.run(parameters));
		if(this.namedQueryCache.exists(crc)) {
			this.namedQueryCache.remove(crc);
		}
	}
	,updateObjects: function(objs,callBack) {
		this.synchronizeInternalLinks(objs);
		var className = Type.getClassName(Type.getClass(objs[0]));
		var attributeMaps = [];
		var _g = 0;
		while(_g < objs.length) {
			var object = objs[_g];
			++_g;
			this.evictObject(object);
			attributeMaps.push(this.unbindObject(object));
		}
		this._update(attributeMaps,className,callBack);
	}
	,insertObjects: function(objs,cb) {
		var _gthis = this;
		if(objs.length == 0) {
			cb(null);
			return;
		}
		this.synchronizeInternalLinks(objs);
		this.attach(objs,false,function(err) {
			if(err != null) {
				cb(err);
			} else {
				var className = Type.getClassName(Type.getClass(objs[0]));
				var attributeMaps = [];
				var _g = 0;
				while(_g < objs.length) {
					var object = objs[_g];
					++_g;
					_gthis.evictObject(object);
					var a = _gthis.unbindObject(object);
					attributeMaps.push(a);
				}
				_gthis._insert(attributeMaps,className,function(err1) {
					cb(err1);
				});
			}
		});
	}
	,rollback: function(callBack) {
		this._rollback(callBack);
	}
	,commit: function(callBack) {
		this._commit(callBack);
	}
	,_update: function(attributeMaps,className,callBack) {
	}
	,_insert: function(attributeMaps,className,callBack) {
	}
	,_delete: function(attributeMaps,className,callBack) {
	}
	,_rollback: function(callBack) {
	}
	,_commit: function(cb) {
		cb("Commit not supported");
	}
	,bindObject: function(attributeMap,clazz,cache,indexField,suspendSetup) {
		if(suspendSetup == null) {
			suspendSetup = false;
		}
		if(clazz == null) {
			var _g = 0;
			var _g1 = Reflect.fields(attributeMap);
			while(_g < _g1.length) {
				var key = _g1[_g];
				++_g;
				var val = Reflect.field(attributeMap,key);
				if(saturn.db.DefaultProvider.r_date.match(val)) {
					Reflect.setField(attributeMap,key,new Date(Date.parse(val)));
				}
			}
			return attributeMap;
		}
		if(this.enableBinding) {
			var className = Type.getClassName(clazz);
			var parts = className.split(".");
			var shortName = parts.pop();
			var packageName = parts.join(".");
			var obj = Type.createInstance(clazz,[]);
			if(this.theBindingMap.exists(className)) {
				var map = this.theBindingMap.get(className).get("fields");
				var indexes = this.theBindingMap.get(className).get("indexes");
				var atPriIndex = null;
				var atIndexField = indexes.keys();
				while(atIndexField.hasNext()) {
					var atIndexField1 = atIndexField.next();
					if(indexes.get(atIndexField1) == 1) {
						atPriIndex = atIndexField1;
						break;
					}
				}
				var colPriIndex = null;
				if(atPriIndex != null) {
					colPriIndex = map.get(atPriIndex);
				}
				var priKeyValue = null;
				if(Reflect.hasField(attributeMap,colPriIndex)) {
					priKeyValue = Reflect.field(attributeMap,colPriIndex);
				} else if(Reflect.hasField(attributeMap,colPriIndex.toLowerCase())) {
					priKeyValue = Reflect.field(attributeMap,colPriIndex.toLowerCase());
				}
				var keys = [];
				var key1 = map.keys();
				while(key1.hasNext()) {
					var key2 = key1.next();
					keys.push(key2);
				}
				if(indexField != null && !map.exists(indexField)) {
					keys.push(indexField);
				}
				var _g2 = 0;
				while(_g2 < keys.length) {
					var key3 = keys[_g2];
					++_g2;
					if(!this.objectCache.get(className).exists(key3)) {
						this.objectCache.get(className).set(key3,new haxe.ds.StringMap());
					}
					var atKey = map.get(key3);
					var val1 = null;
					if(Reflect.hasField(attributeMap,atKey)) {
						val1 = Reflect.field(attributeMap,atKey);
					} else if(Reflect.hasField(attributeMap,atKey.toLowerCase())) {
						val1 = Reflect.field(attributeMap,atKey.toLowerCase());
					}
					if(saturn.db.DefaultProvider.r_date.match(val1)) {
						Reflect.setField(obj,key3,new Date(Date.parse(val)));
					} else {
						Reflect.setField(obj,key3,val1);
					}
					if(cache && indexes != null && (indexes.exists(key3) || key3 == indexField) && this.useCache) {
						if(priKeyValue != null) {
							if(this.objectCache.get(className).get(key3).exists(val1)) {
								var mappedObj = this.objectCache.get(className).get(key3).get(val1);
								var toCheck = mappedObj;
								var isArray = (mappedObj instanceof Array) && mappedObj.__enum__ == null;
								if(!isArray) {
									toCheck = [mappedObj];
								}
								var match = false;
								var _g21 = 0;
								var _g11 = toCheck.length;
								while(_g21 < _g11) {
									var i = _g21++;
									var eObj = toCheck[i];
									var priValue = Reflect.field(eObj,atPriIndex);
									if(priValue == priKeyValue) {
										toCheck[i] = obj;
										match = true;
										break;
									}
								}
								if(match == false) {
									toCheck.push(obj);
								}
								if(toCheck.length == 1) {
									this.objectCache.get(className).get(key3).set(val1,toCheck[0]);
								} else {
									this.objectCache.get(className).get(key3).set(val1,toCheck);
								}
								continue;
							}
						}
						this.objectCache.get(className).get(key3).set(val1,obj);
					}
				}
			}
			if(!suspendSetup && Reflect.isFunction(obj.setup)) {
				obj.setup();
			}
			return obj;
		} else {
			return attributeMap;
		}
	}
	,unbindObject: function(object) {
		if(this.enableBinding) {
			var className = Type.getClassName(Type.getClass(object));
			var attributeMap = new haxe.ds.StringMap();
			if(this.theBindingMap.exists(className)) {
				var map = this.theBindingMap.get(className).get("fields");
				var key = map.keys();
				while(key.hasNext()) {
					var key1 = key.next();
					var val = Reflect.field(object,key1);
					attributeMap.set(map.get(key1),val);
				}
				return attributeMap;
			} else {
				return null;
			}
		} else {
			return object;
		}
	}
	,activate: function(objects,depthLimit,callBack) {
		var _gthis = this;
		this._activate(objects,1,depthLimit,function(error) {
			if(error == null) {
				_gthis.merge(objects);
			}
			callBack(error);
		});
	}
	,_activate: function(objects,depth,depthLimit,callBack) {
		var _gthis = this;
		var objectsToFetch = 0;
		var batchQuery = new saturn.db.BatchFetch(function(obj,err) {
		});
		batchQuery.setProvider(this);
		var classToFetch = new haxe.ds.StringMap();
		var _g = 0;
		while(_g < objects.length) {
			var object = objects[_g];
			++_g;
			if(object == null || Std["is"](object,ArrayBuffer) || Std["is"](object,haxe.ds.StringMap)) {
				continue;
			}
			var clazz = Type.getClass(object);
			if(clazz == null) {
				continue;
			}
			var clazzName = Type.getClassName(clazz);
			if(this.theBindingMap.exists(clazzName)) {
				if(this.theBindingMap.get(clazzName).exists("fields.synthetic")) {
					var synthFields = this.theBindingMap.get(clazzName).get("fields.synthetic");
					var synthFieldName = synthFields.keys();
					while(synthFieldName.hasNext()) {
						var synthFieldName1 = synthFieldName.next();
						var synthInfo = synthFields.get(synthFieldName1);
						var fkField = synthInfo.get("fk_field");
						if(fkField == null) {
							Reflect.setField(object,synthFieldName1,Type.createInstance(Type.resolveClass(synthInfo.get("class")),[Reflect.field(object,synthInfo.get("field"))]));
							continue;
						}
						var synthVal = Reflect.field(object,synthFieldName1);
						if(synthVal != null) {
							continue;
						}
						var isPolymorphic = synthInfo.exists("selector_field");
						var synthClass;
						if(isPolymorphic) {
							var selectorField = synthInfo.get("selector_field");
							var objValue = Reflect.field(object,selectorField);
							if(synthInfo.get("selector_values").exists(objValue)) {
								synthClass = synthInfo.get("selector_values").get(objValue);
							} else {
								continue;
							}
							var selectorValue = synthInfo.get("selector_value");
							synthFieldName1 = "_MERGE";
						} else {
							synthClass = synthInfo.get("class");
						}
						var field = synthInfo.get("field");
						var val = Reflect.field(object,field);
						if(val == null || val == "" && !(typeof(val) == "number" && ((val | 0) === val))) {
							Reflect.setField(object,synthFieldName1,null);
						} else {
							var cacheObj = this.getObjectFromCache(Type.resolveClass(synthClass),fkField,val);
							if(cacheObj == null) {
								++objectsToFetch;
								if(!classToFetch.exists(synthClass)) {
									classToFetch.set(synthClass,new haxe.ds.StringMap());
								}
								if(!classToFetch.get(synthClass).exists(fkField)) {
									classToFetch.get(synthClass).set(fkField,new haxe.ds.StringMap());
								}
								classToFetch.get(synthClass).get(fkField).set(val,"");
							} else {
								Reflect.setField(object,synthFieldName1,cacheObj);
							}
						}
					}
				}
			}
		}
		var synthClass1 = classToFetch.keys();
		while(synthClass1.hasNext()) {
			var synthClass2 = synthClass1.next();
			var fkField1 = classToFetch.get(synthClass2).keys();
			while(fkField1.hasNext()) {
				var fkField2 = fkField1.next();
				var objList = [];
				var objId = classToFetch.get(synthClass2).get(fkField2).keys();
				while(objId.hasNext()) {
					var objId1 = objId.next();
					objList.push(objId1);
				}
				batchQuery.getByValues(objList,Type.resolveClass(synthClass2),fkField2,"__IGNORED__",null);
			}
		}
		batchQuery.onComplete = function() {
			var _g1 = 0;
			while(_g1 < objects.length) {
				var object1 = objects[_g1];
				++_g1;
				var clazz1 = Type.getClass(object1);
				if(object1 == null || Std["is"](object1,ArrayBuffer) || clazz1 == null) {
					continue;
				}
				var clazzName1 = Type.getClassName(clazz1);
				if(_gthis.theBindingMap.exists(clazzName1)) {
					if(_gthis.theBindingMap.get(clazzName1).exists("fields.synthetic")) {
						var synthFields1 = _gthis.theBindingMap.get(clazzName1).get("fields.synthetic");
						var synthFieldName2 = synthFields1.keys();
						while(synthFieldName2.hasNext()) {
							var synthFieldName3 = synthFieldName2.next();
							var synthVal1 = Reflect.field(object1,synthFieldName3);
							if(synthVal1 != null) {
								continue;
							}
							var synthInfo1 = synthFields1.get(synthFieldName3);
							var isPolymorphic1 = synthInfo1.exists("selector_field");
							var synthClass3;
							if(isPolymorphic1) {
								var selectorField1 = synthInfo1.get("selector_field");
								var objValue1 = Reflect.field(object1,selectorField1);
								if(synthInfo1.get("selector_values").exists(objValue1)) {
									synthClass3 = synthInfo1.get("selector_values").get(objValue1);
								} else {
									continue;
								}
								var selectorValue1 = synthInfo1.get("selector_value");
								synthFieldName3 = "_MERGE";
							} else {
								synthClass3 = synthInfo1.get("class");
							}
							var field1 = synthInfo1.get("field");
							var val1 = Reflect.field(object1,field1);
							if(val1 != null && val1 != "") {
								var fkField3 = synthInfo1.get("fk_field");
								if(synthInfo1.exists("selector_field")) {
									synthFieldName3 = "_MERGE";
								}
								var cacheObj1 = Type.resolveClass(synthClass3);
								var cacheObj2 = _gthis.getObjectFromCache(cacheObj1,fkField3,val1);
								if(cacheObj2 != null) {
									Reflect.setField(object1,synthFieldName3,cacheObj2);
								}
							}
						}
					}
				}
			}
			var newObjList = [];
			var _g2 = 0;
			while(_g2 < objects.length) {
				var object2 = objects[_g2];
				++_g2;
				var clazz2 = Type.getClass(object2);
				if(object2 == null || Std["is"](object2,ArrayBuffer) || clazz2 == null) {
					continue;
				}
				var model = _gthis.getModel(clazz2);
				if(model != null) {
					var _g11 = 0;
					var _g21 = Reflect.fields(object2);
					while(_g11 < _g21.length) {
						var field2 = _g21[_g11];
						++_g11;
						var val2 = Reflect.field(object2,field2);
						if(!model.isSyntheticallyBound(field2) || val2 == null) {
							continue;
						}
						var objs = Reflect.field(object2,field2);
						if(!((objs instanceof Array) && objs.__enum__ == null)) {
							objs = [objs];
						}
						var _g3 = 0;
						while(_g3 < objs.length) {
							var newObject = objs[_g3];
							++_g3;
							newObjList.push(newObject);
						}
					}
				}
			}
			if(newObjList.length > 0 && depthLimit > depth) {
				_gthis._activate(newObjList,depth + 1,depthLimit,callBack);
			} else {
				callBack(null);
			}
		};
		batchQuery.execute();
	}
	,merge: function(objects) {
		var toVisit = [];
		var _g1 = 0;
		var _g = objects.length;
		while(_g1 < _g) {
			var i = _g1++;
			toVisit.push({ "parent" : objects, "pos" : i, "value" : objects[i]});
		}
		this._merge(toVisit);
	}
	,_merge: function(toVisit) {
		while(toVisit.length != 0) {
			var item = toVisit.pop();
			var original = Reflect.field(item,"value");
			if(Reflect.hasField(original,"_MERGE")) {
				var obj = Reflect.field(original,"_MERGE");
				var _g = 0;
				var _g1 = Reflect.fields(original);
				while(_g < _g1.length) {
					var field = _g1[_g];
					++_g;
					if(field != "_MERGE") {
						Reflect.setField(obj,field,Reflect.field(original,field));
					}
				}
				var parent = Reflect.field(item,"parent");
				if(Reflect.hasField(item,"pos")) {
					parent[Reflect.field(item,"pos")] = obj;
				} else {
					Reflect.setField(parent,Reflect.field(item,"field"),obj);
				}
				original = obj;
			}
			var model = this.getModel(original);
			if(model == null) {
				continue;
			}
			var _g2 = 0;
			var _g11 = model.getAttributes();
			while(_g2 < _g11.length) {
				var field1 = _g11[_g2];
				++_g2;
				var value = Reflect.field(original,field1);
				var isObject = false;
				isObject = Std["is"](value,Object);
				if(isObject) {
					if((value instanceof Array) && value.__enum__ == null) {
						var _g3 = 0;
						var _g21 = value.length;
						while(_g3 < _g21) {
							var i = _g3++;
							toVisit.push({ "parent" : value, "pos" : i, "value" : value[i]});
						}
					} else {
						toVisit.push({ "parent" : original, "value" : value, "field" : field1});
					}
				}
			}
		}
	}
	,getModel: function(clazz) {
		if(clazz == null) {
			return null;
		} else {
			var t = Type.getClass(clazz);
			var className = Type.getClassName(clazz);
			return this.getModelByStringName(className);
		}
	}
	,getObjectModel: function(object) {
		if(object == null) {
			return null;
		} else {
			var clazz = Type.getClass(object);
			return this.getModel(clazz);
		}
	}
	,save: function(object,cb,autoAttach) {
		if(autoAttach == null) {
			autoAttach = false;
		}
		this.insertOrUpdate([object],cb,autoAttach);
	}
	,initModelClasses: function() {
		this.modelClasses = [];
		var classStr = this.theBindingMap.keys();
		while(classStr.hasNext()) {
			var classStr1 = classStr.next();
			saturn.core.Util.debug(classStr1);
			var clazz = Type.resolveClass(classStr1);
			if(clazz != null) {
				this.modelClasses.push(this.getModel(clazz));
			}
		}
	}
	,getModelClasses: function() {
		return this.modelClasses;
	}
	,getModelByStringName: function(className) {
		if(this.theBindingMap.exists(className)) {
			if(this.theBindingMap.get(className).exists("model")) {
				return new saturn.db.Model(this.theBindingMap.get(className),className);
			} else {
				return new saturn.db.Model(this.theBindingMap.get(className),className);
			}
		} else {
			return null;
		}
	}
	,isModel: function(clazz) {
		if(this.theBindingMap != null) {
			return this.theBindingMap.exists(Type.getClassName(clazz));
		} else {
			return false;
		}
	}
	,setSelectClause: function(className,selClause) {
		if(this.theBindingMap.exists(className)) {
			this.theBindingMap.get(className).get("statements").set("SELECT",selClause);
		}
	}
	,modelToReal: function(modelDef,models,cb) {
		var _gthis = this;
		var priKey = modelDef.getPrimaryKey();
		var fields = modelDef.getFields();
		var clazz = modelDef.getClass();
		var syntheticInstanceAttributes = modelDef.getSynthenticFields();
		var syntheticSet = null;
		if(syntheticInstanceAttributes != null) {
			syntheticSet = new haxe.ds.StringMap();
			var instanceName = syntheticInstanceAttributes.keys();
			while(instanceName.hasNext()) {
				var instanceName1 = instanceName.next();
				var fkRel = syntheticInstanceAttributes.get(instanceName1);
				var parentIdColumn = fkRel.get("fk_field");
				var childIdColumn = fkRel.get("field");
				var _g = new haxe.ds.StringMap();
				_g.set("childIdColumn",childIdColumn);
				_g.set("parentIdColumn",fkRel.get("fk_field"));
				_g.set("class",fkRel.get("class"));
				syntheticSet.set(instanceName1,_g);
			}
		}
		var clazzToFieldToIds = new haxe.ds.StringMap();
		var _g1 = 0;
		while(_g1 < models.length) {
			var model = models[_g1];
			++_g1;
			var _g11 = 0;
			var _g2 = modelDef.getAttributes();
			while(_g11 < _g2.length) {
				var field = _g2[_g11];
				++_g11;
				if(field.indexOf(".") > -1) {
					var parts = field.split(".");
					var instanceName2 = parts[0];
					if(syntheticSet != null && syntheticSet.exists(instanceName2)) {
						var lookupField = parts[parts.length - 1];
						var lookupClazz = syntheticSet.get(instanceName2).get("class");
						var val = Reflect.field(model,field);
						if(val == null || val == "" && !(typeof(val) == "number" && ((val | 0) === val))) {
							continue;
						}
						var clazz1 = Type.resolveClass(lookupClazz);
						var cachedObject = this.getObjectFromCache(clazz1,lookupField,val);
						if(cachedObject == null) {
							if(!clazzToFieldToIds.exists(lookupClazz)) {
								clazzToFieldToIds.set(lookupClazz,new haxe.ds.StringMap());
							}
							if(!clazzToFieldToIds.get(lookupClazz).exists(lookupField)) {
								clazzToFieldToIds.get(lookupClazz).set(lookupField,new haxe.ds.StringMap());
							}
							clazzToFieldToIds.get(lookupClazz).get(lookupField).set(val,"");
						}
					}
				}
			}
		}
		var batchFetch = new saturn.db.BatchFetch(function(obj,err) {
			cb(err,obj);
		});
		var clazzStr = clazzToFieldToIds.keys();
		while(clazzStr.hasNext()) {
			var clazzStr1 = clazzStr.next();
			var fieldStr = clazzToFieldToIds.get(clazzStr1).keys();
			while(fieldStr.hasNext()) {
				var fieldStr1 = fieldStr.next();
				var valList = [];
				var val1 = clazzToFieldToIds.get(clazzStr1).get(fieldStr1).keys();
				while(val1.hasNext()) {
					var val2 = val1.next();
					valList.push(val2);
				}
				batchFetch.getByIds(valList,Type.resolveClass(clazzStr1),"__IGNORE__",null);
			}
		}
		batchFetch.onComplete = function(err1,objs) {
			if(err1 != null) {
				cb(err1,null);
			} else {
				var mappedModels = [];
				var _g3 = 0;
				while(_g3 < models.length) {
					var model1 = models[_g3];
					++_g3;
					var mappedModel = Type.createEmptyInstance(clazz);
					var _g12 = 0;
					var _g21 = modelDef.getAttributes();
					while(_g12 < _g21.length) {
						var field1 = _g21[_g12];
						++_g12;
						if(field1.indexOf(".") > -1) {
							var parts1 = field1.split(".");
							var instanceName3 = parts1[0];
							if(syntheticSet.exists(instanceName3)) {
								var lookupField1 = parts1[parts1.length - 1];
								var lookupClazz1 = syntheticSet.get(instanceName3).get("class");
								var val3 = Reflect.field(model1,field1);
								if(val3 == null || val3 == "") {
									continue;
								}
								var clazz2 = Type.resolveClass(lookupClazz1);
								var cachedObject1 = _gthis.getObjectFromCache(clazz2,lookupField1,val3);
								if(cachedObject1 != null) {
									var idColumn = syntheticSet.get(instanceName3).get("parentIdColumn");
									var val4 = Reflect.field(cachedObject1,idColumn);
									if(val4 == null || val4 == "" && !(typeof(val4) == "number" && ((val4 | 0) === val4))) {
										cb("Unexpected mapping error",mappedModels);
										return;
									}
									var dstColumn = syntheticSet.get(instanceName3).get("childIdColumn");
									Reflect.setField(mappedModel,dstColumn,val4);
								} else {
									cb("Unable to find " + val3,mappedModels);
									return;
								}
							}
						} else {
							var val5 = Reflect.field(model1,field1);
							Reflect.setField(mappedModel,field1,val5);
						}
					}
					mappedModels.push(mappedModel);
				}
				cb(null,mappedModels);
			}
		};
		batchFetch.execute();
	}
	,dataBinding: function(enable) {
		this.enableBinding = enable;
	}
	,isDataBinding: function() {
		return this.enableBinding;
	}
	,queryPath: function(fromClazz,queryPath,fieldValue,functionName,cb) {
		var _gthis = this;
		var parts = queryPath.split(".");
		var fieldName = parts.pop();
		var synthField = parts.pop();
		var model = this.getModel(fromClazz);
		if(model.isSynthetic(synthField)) {
			var fieldDef = model.getSynthenticFields().get(synthField);
			var childClazz = Type.resolveClass(fieldDef.get("class"));
			Reflect.callMethod(this,Reflect.field(this,functionName),[[fieldValue],childClazz,fieldName,function(objs,err) {
				if(err == null) {
					var values = [];
					var _g = 0;
					while(_g < objs.length) {
						var obj = objs[_g];
						++_g;
						values.push(Reflect.field(obj,fieldDef.get("fk_field")));
					}
					var parentField = fieldDef.get("field");
					_gthis.getByValues(values,fromClazz,parentField,function(objs1,err1) {
						cb(err1,objs1);
					});
				} else {
					cb(err,null);
				}
			}]);
		}
	}
	,setAutoCommit: function(autoCommit,cb) {
		cb("Set auto commit mode ");
	}
	,attach: function(objs,refreshFields,cb) {
		var _gthis = this;
		var bf = new saturn.db.BatchFetch(function(obj,err) {
			cb(err);
		});
		bf.setProvider(this);
		this._attach(objs,refreshFields,bf);
		bf.onComplete = function() {
			_gthis.synchronizeInternalLinks(objs);
			cb(null);
		};
		bf.execute();
	}
	,synchronizeInternalLinks: function(objs) {
		if(!this.isDataBinding()) {
			return;
		}
		var _g = 0;
		while(_g < objs.length) {
			var obj = objs[_g];
			++_g;
			var clazz = Type.getClass(obj);
			var model = this.getModel(clazz);
			var synthFields = model.getSynthenticFields();
			if(synthFields != null) {
				var synthFieldName = synthFields.keys();
				while(synthFieldName.hasNext()) {
					var synthFieldName1 = synthFieldName.next();
					var synthField = synthFields.get(synthFieldName1);
					var synthObj = Reflect.field(obj,synthFieldName1);
					var field = synthField.get("field");
					var fkField = synthField.get("fk_field");
					if(synthObj != null) {
						if(fkField == null) {
							Reflect.setField(obj,field,synthObj.getValue());
						} else {
							Reflect.setField(obj,field,Reflect.field(synthObj,fkField));
							this.synchronizeInternalLinks([synthObj]);
						}
					}
				}
			}
		}
	}
	,_attach: function(objs,refreshFields,bf) {
		var _g = 0;
		while(_g < objs.length) {
			var obj = [objs[_g]];
			++_g;
			var clazz = Type.getClass(obj[0]);
			var model = this.getModel(clazz);
			var priField = [model.getPrimaryKey()];
			var secField = model.getFirstKey();
			if(Reflect.field(obj[0],priField[0]) == null || Reflect.field(obj[0],priField[0]) == "") {
				var fieldVal = Reflect.field(obj[0],secField);
				if(fieldVal != null) {
					bf.append(fieldVal,secField,clazz,(function(priField1,obj1) {
						return function(dbObj) {
							if(refreshFields) {
								var _g1 = 0;
								var _g2 = Reflect.fields(dbObj);
								while(_g1 < _g2.length) {
									var field = _g2[_g1];
									++_g1;
									Reflect.setField(obj1[0],field,Reflect.field(dbObj,field));
								}
							} else {
								Reflect.setField(obj1[0],priField1[0],Reflect.field(dbObj,priField1[0]));
							}
						};
					})(priField,obj));
				}
			}
			var synthFields = model.getSynthenticFields();
			if(synthFields != null) {
				var synthFieldName = synthFields.keys();
				while(synthFieldName.hasNext()) {
					var synthFieldName1 = synthFieldName.next();
					var synthField = synthFields.get(synthFieldName1);
					var synthObj = Reflect.field(obj[0],synthFieldName1);
					if(synthObj != null) {
						this._attach([synthObj],refreshFields,bf);
					}
				}
			}
		}
	}
	,getQuery: function() {
		var query = new saturn.db.query_lang.Query(this);
		return query;
	}
	,getProviderType: function() {
		return "NONE";
	}
	,isAttached: function(obj) {
		var model = this.getModel(Type.getClass(obj));
		var priField = model.getPrimaryKey();
		var val = Reflect.field(obj,priField);
		if(val == null || val == "") {
			return false;
		} else {
			return true;
		}
	}
	,insertOrUpdate: function(objs,cb,autoAttach) {
		if(autoAttach == null) {
			autoAttach = false;
		}
		var _gthis = this;
		var run = function() {
			var insertList = [];
			var updateList = [];
			var _g = 0;
			while(_g < objs.length) {
				var obj = objs[_g];
				++_g;
				if(!_gthis.isAttached(obj)) {
					insertList.push(obj);
				} else {
					updateList.push(obj);
				}
			}
			if(insertList.length > 0) {
				_gthis.insertObjects(insertList,function(err) {
					if(err == null && updateList.length > 0) {
						_gthis.updateObjects(updateList,cb);
					} else {
						cb(err);
					}
				});
			} else if(updateList.length > 0) {
				_gthis.updateObjects(updateList,cb);
			}
		};
		if(autoAttach) {
			this.attach(objs,false,function(err1) {
				if(err1 == null) {
					run();
				} else {
					cb(err1);
				}
			});
		} else {
			run();
		}
	}
	,uploadFile: function(contents,file_identifier,cb) {
		if(file_identifier == null) {
			bindings.NodeTemp.open_untracked("upload_file",function(err,info) {
				if(err != null) {
					cb(err,null);
				} else {
					var buffer = new Buffer(contents,"base64");
					js.Node.get_fs().writeFile(info.path,buffer,function(err1) {
						if(err1 != null) {
							cb(err1,null);
						} else {
							var client = saturn.app.SaturnServer.getDefaultServer().getRedisClient();
							var uuid = js.Node.require("node-uuid");
							var upload_key = "file_upload:" + uuid.v4();
							client.set(upload_key,info.path);
							cb(null,upload_key);
						}
					});
				}
			});
		} else {
			var client1 = saturn.app.SaturnServer.getDefaultServer().getRedisClient();
			client1.get(file_identifier,function(err2,filePath) {
				if(err2 != null || filePath == null || filePath == "") {
					cb(err2,null);
				} else {
					var decodedContents = new Buffer(contents,"base64");
					js.Node.get_fs().appendFile(filePath,decodedContents,function(err3) {
						cb(err3,file_identifier);
					});
				}
			});
		}
		return null;
	}
	,__class__: saturn.db.DefaultProvider
};
saturn.db.NamedQueryCache = $hxClasses["saturn.db.NamedQueryCache"] = function() {
};
saturn.db.NamedQueryCache.__name__ = ["saturn","db","NamedQueryCache"];
saturn.db.NamedQueryCache.prototype = {
	queryName: null
	,queryParamSerial: null
	,queryParams: null
	,queryResults: null
	,__class__: saturn.db.NamedQueryCache
};
saturn.db.Model = $hxClasses["saturn.db.Model"] = function(model,name) {
	this.customSearchFunctionPath = null;
	this.theModel = model;
	this.theName = name;
	this.alias = "";
	this.actionMap = new haxe.ds.StringMap();
	if(this.theModel.exists("indexes")) {
		var i = 0;
		var keyName = this.theModel.get("indexes").keys();
		while(keyName.hasNext()) {
			var keyName1 = keyName.next();
			if(i == 0) {
				this.busSingleColKey = keyName1;
			}
			if(this.theModel.get("indexes").get(keyName1)) {
				this.priColKey = keyName1;
			}
			++i;
		}
	}
	if(this.theModel.exists("provider_name")) {
		var name1 = js.Boot.__cast(this.theModel.get("provider_name") , String);
		this.setProviderName(name1);
	}
	if(this.theModel.exists("programs")) {
		this.programs = [];
		var program = this.theModel.get("programs").keys();
		while(program.hasNext()) {
			var program1 = program.next();
			this.programs.push(program1);
		}
	}
	this.stripIdPrefix = false;
	this.autoActivate = -1;
	if(this.theModel.exists("options")) {
		var options = this.theModel.get("options");
		if(options.exists("id_pattern")) {
			this.setIdRegEx(options.get("id_pattern"));
		}
		if(options.exists("custom_search_function")) {
			this.customSearchFunctionPath = options.get("custom_search_function");
		}
		if(options.exists("constraints")) {
			if(options.get("constraints").exists("user_constraint_field")) {
				this.userConstraintField = options.get("constraints").get("user_constraint_field");
			}
			if(options.get("constraints").exists("public_constraint_field")) {
				this.publicConstraintField = options.get("constraints").get("public_constraint_field");
			}
		}
		if(options.get("windows_allowed_paths")) {
			options.set("windows_allowed_paths_regex",this.compileRegEx(options.get("windows_allowed_paths")));
		}
		if(options.get("linux_allowed_paths")) {
			options.set("linux_allowed_paths_regex",this.compileRegEx(options.get("linux_allowed_paths")));
		}
		if(options.exists("strip_id_prefix")) {
			this.stripIdPrefix = options.get("strip_id_prefix");
		}
		if(options.exists("alias")) {
			this.alias = options.get("alias");
		}
		if(options.exists("flags")) {
			this.flags = options.get("flags");
		} else {
			this.flags = new haxe.ds.StringMap();
		}
		if(options.exists("file.new.label")) {
			this.file_new_label = options.get("file.new.label");
		}
		if(options.exists("auto_activate")) {
			this.autoActivate = Std.parseInt(options.get("auto_activate"));
		}
		if(options.exists("actions")) {
			var actionTypeMap = options.get("actions");
			var actionType = actionTypeMap.keys();
			while(actionType.hasNext()) {
				var actionType1 = actionType.next();
				var actions = actionTypeMap.get(actionType1);
				this.actionMap.set(actionType1,new haxe.ds.StringMap());
				var actionName = actions.keys();
				while(actionName.hasNext()) {
					var actionName1 = actionName.next();
					var actionDef = actions.get(actionName1);
					if(!actionDef.exists("user_suffix")) {
						throw new js._Boot.HaxeError(new saturn.util.HaxeException(actionName1 + " action definition for " + this.getName() + " is missing user_suffix option"));
					}
					if(!actionDef.exists("function")) {
						throw new js._Boot.HaxeError(new saturn.util.HaxeException(actionName1 + " action definition for " + this.getName() + " is missing function option"));
					}
					var action = new saturn.db.ModelAction(actionName1,actionDef.get("user_suffix"),actionDef.get("function"),actionDef.get("icon"));
					if(actionType1 == "search_bar") {
						var clazz = Type.resolveClass(action.className);
						if(clazz == null) {
							throw new js._Boot.HaxeError(new saturn.util.HaxeException(action.className + " does not exist for action " + actionName1));
						}
						var instanceFields = Type.getInstanceFields(clazz);
						var match = false;
						var _g = 0;
						while(_g < instanceFields.length) {
							var field = instanceFields[_g];
							++_g;
							if(field == action.functionName) {
								match = true;
								break;
							}
						}
						if(!match) {
							throw new js._Boot.HaxeError(new saturn.util.HaxeException(action.className + " does not have function " + action.functionName + " for action " + actionName1));
						}
					}
					this.actionMap.get(actionType1).set(actionName1,action);
				}
			}
		}
	} else {
		this.flags = new haxe.ds.StringMap();
		this.actionMap.set("searchBar",new haxe.ds.StringMap());
	}
	if(this.theModel.exists("search")) {
		var fts = this.theModel.get("search");
		this.ftsColumns = new haxe.ds.StringMap();
		var key = fts.keys();
		while(key.hasNext()) {
			var key1 = key.next();
			var searchDef = fts.get(key1);
			var searchObj = new saturn.db.SearchDef();
			if(searchDef != null) {
				if(typeof(searchDef) == "boolean" && searchDef) {
					this.ftsColumns.set(key1,searchObj);
				} else if(typeof(searchDef) == "string") {
					searchObj.regex = new EReg(searchDef,"");
				} else {
					if(searchDef.exists("search_when")) {
						var regexStr = searchDef.get("search_when");
						if(regexStr != null && regexStr != "") {
							searchObj.regex = new EReg(regexStr,"");
						}
					}
					if(searchDef.exists("replace_with")) {
						searchObj.replaceWith = searchDef.get("replace_with");
					}
				}
			}
			this.ftsColumns.set(key1,searchObj);
		}
	}
	if(this.alias == null || this.alias == "") {
		this.alias = this.theName;
	}
};
saturn.db.Model.__name__ = ["saturn","db","Model"];
saturn.db.Model.generateIDMap = function(objs) {
	if(objs == null || objs.length == 0) {
		return null;
	} else {
		var map = new haxe.ds.StringMap();
		var model = saturn.core.Util.getProvider().getModel(Type.getClass(objs[0]));
		var firstKey = model.getFirstKey();
		var priKey = model.getPrimaryKey();
		var _g = 0;
		while(_g < objs.length) {
			var obj = objs[_g];
			++_g;
			map.set(Reflect.field(obj,firstKey),Reflect.field(obj,priKey));
		}
		return map;
	}
};
saturn.db.Model.generateUniqueList = function(objs) {
	if(objs == null || objs.length == 0) {
		return null;
	} else {
		var model = saturn.core.Util.getProvider().getModel(Type.getClass(objs[0]));
		var firstKey = model.getFirstKey();
		return saturn.db.Model.generateUniqueListWithField(objs,firstKey);
	}
};
saturn.db.Model.generateUniqueListWithField = function(objs,field) {
	var set = new haxe.ds.StringMap();
	var _g = 0;
	while(_g < objs.length) {
		var obj = objs[_g];
		++_g;
		set.set(saturn.db.Model.extractField(obj,field),null);
	}
	var ids = [];
	var key = set.keys();
	while(key.hasNext()) {
		var key1 = key.next();
		ids.push(key1);
	}
	return ids;
};
saturn.db.Model.extractField = function(obj,field) {
	if(field.indexOf(".") < 0) {
		return Reflect.field(obj,field);
	} else {
		var a = field.indexOf(".") - 1;
		var nextField = field.substring(0,a + 1);
		var nextObj = Reflect.field(obj,nextField);
		var remaining = field.substring(a + 2,field.length);
		return saturn.db.Model.extractField(nextObj,remaining);
	}
};
saturn.db.Model.setField = function(obj,field,value,newTerminal) {
	if(newTerminal == null) {
		newTerminal = false;
	}
	if(field.indexOf(".") < 0) {
		Reflect.setField(obj,field,value);
	} else {
		var a = field.indexOf(".") - 1;
		var nextField = field.substring(0,a + 1);
		var nextObj = Reflect.field(obj,nextField);
		var remaining = field.substring(a + 2,field.length);
		if(nextObj == null || newTerminal && remaining.indexOf(".") < 0) {
			var clazz = Type.getClass(obj);
			if(clazz != null) {
				var model = saturn.core.Util.getProvider().getModel(clazz);
				var synthDef = model.getSynthenticFields().get(nextField);
				if(synthDef != null) {
					var clazzStr = synthDef.get("class");
					nextObj = Type.createInstance(Type.resolveClass(clazzStr),[]);
					Reflect.setField(obj,nextField,nextObj);
					Reflect.setField(obj,synthDef.field,null);
				}
			}
		}
		saturn.db.Model.setField(nextObj,remaining,value);
	}
};
saturn.db.Model.getModel = function(obj) {
	return saturn.core.Util.getProvider().getModel(Type.getClass(obj));
};
saturn.db.Model.generateMap = function(objs) {
	var model = saturn.db.Model.getModel(objs[0]);
	var firstKey = model.getFirstKey();
	return saturn.db.Model.generateMapWithField(objs,firstKey);
};
saturn.db.Model.generateMapWithField = function(objs,field) {
	var map = new haxe.ds.StringMap();
	var _g = 0;
	while(_g < objs.length) {
		var obj = objs[_g];
		++_g;
		map.set(saturn.db.Model.extractField(obj,field),obj);
	}
	return map;
};
saturn.db.Model.prototype = {
	theModel: null
	,theName: null
	,busSingleColKey: null
	,priColKey: null
	,idRegEx: null
	,stripIdPrefix: null
	,file_new_label: null
	,searchMap: null
	,ftsColumns: null
	,alias: null
	,programs: null
	,flags: null
	,autoActivate: null
	,actionMap: null
	,providerName: null
	,publicConstraintField: null
	,userConstraintField: null
	,customSearchFunctionPath: null
	,getFileNewLabel: function() {
		return this.file_new_label;
	}
	,isProgramSaveAs: function(clazzName) {
		if(this.theModel.exists("programs") && this.theModel.get("programs").get(clazzName)) {
			return true;
		} else if(this.theModel.get("options").exists("canSave")) {
			return this.theModel.get("options").get("canSave").get(clazzName);
		} else {
			return false;
		}
	}
	,getProviderName: function() {
		return this.providerName;
	}
	,setProviderName: function(name) {
		this.providerName = name;
	}
	,getActions: function(actionType) {
		if(this.actionMap.exists(actionType)) {
			return this.actionMap.get(actionType);
		} else {
			return new haxe.ds.StringMap();
		}
	}
	,getAutoActivateLevel: function() {
		return this.autoActivate;
	}
	,hasFlag: function(flag) {
		if(this.flags.exists(flag)) {
			return this.flags.get(flag);
		} else {
			return false;
		}
	}
	,getCustomSearchFunction: function() {
		return this.customSearchFunctionPath;
	}
	,getPrograms: function() {
		return this.programs;
	}
	,getAlias: function() {
		return this.alias;
	}
	,getFTSColumns: function() {
		if(this.ftsColumns != null) {
			return this.ftsColumns;
		} else {
			return null;
		}
	}
	,getSearchMap: function() {
		return this.searchMap;
	}
	,getOptions: function() {
		return this.theModel.get("options");
	}
	,compileRegEx: function(regexs) {
		var cregexs = new haxe.ds.StringMap();
		var key = regexs.keys();
		while(key.hasNext()) {
			var key1 = key.next();
			var regex = regexs.get(key1);
			if(regex != "") {
				cregexs.set(key1,new EReg(regex,""));
			}
		}
		return cregexs;
	}
	,setIdRegEx: function(idRegExStr) {
		this.idRegEx = new EReg(idRegExStr,"");
	}
	,getIdRegEx: function() {
		return this.idRegEx;
	}
	,isValidId: function(id) {
		if(this.idRegEx != null) {
			return this.idRegEx.match(id);
		} else {
			return false;
		}
	}
	,stripPrefixes: function() {
		return this.stripIdPrefix;
	}
	,processId: function(id) {
		if(this.stripIdPrefix) {
			id = this.idRegEx.replace(id,"");
		}
		return id;
	}
	,getIndexes: function() {
		var indexFields = [];
		var keyName = this.theModel.get("indexes").keys();
		while(keyName.hasNext()) {
			var keyName1 = keyName.next();
			indexFields.push(keyName1);
		}
		return indexFields;
	}
	,getAutoFunctions: function() {
		if(this.theModel.exists("auto_functions")) {
			return this.theModel.get("auto_functions");
		} else {
			return null;
		}
	}
	,getFields: function() {
		var fields = [];
		var field = this.theModel.get("model").iterator();
		while(field.hasNext()) {
			var field1 = field.next();
			fields.push(field1);
		}
		return fields;
	}
	,getAttributes: function() {
		var fields = [];
		if(this.theModel.exists("fields")) {
			var field = this.theModel.get("fields").keys();
			while(field.hasNext()) {
				var field1 = field.next();
				fields.push(field1);
			}
		}
		return fields;
	}
	,isField: function(field) {
		return this.theModel.get("fields").exists(field);
	}
	,isRDBMSField: function(rdbmsField) {
		var fields = this.theModel.get("fields");
		var field = fields.keys();
		while(field.hasNext()) {
			var field1 = field.next();
			if(fields.get(field1) == rdbmsField) {
				return true;
			}
		}
		return false;
	}
	,modelAtrributeToRDBMS: function(field) {
		return this.theModel.get("fields").get(field);
	}
	,hasDefaults: function() {
		return this.theModel.exists("defaults");
	}
	,hasOptions: function() {
		return this.theModel.exists("options");
	}
	,getFieldDefault: function(field) {
		if(this.hasDefaults() && this.theModel.get("defaults").exists(field)) {
			return this.theModel.get("defaults").get(field);
		} else {
			return null;
		}
	}
	,hasRequired: function() {
		return this.theModel.exists("required");
	}
	,isRequired: function(field) {
		if(this.hasRequired()) {
			if(this.theModel.get("required").exists(field)) {
				return true;
			} else if(field.indexOf(".") > 0) {
				var cmps = field.split(".");
				var refField = this.getSyntheticallyBoundField(cmps[0]);
				return this.isRequired(refField);
			}
		}
		return false;
	}
	,getFieldDefs: function() {
		var fields = [];
		var defaults = null;
		if(this.theModel.exists("defaults")) {
			defaults = this.theModel.get("defaults");
		} else {
			return this.getFields();
		}
		var field = this.theModel.get("model").iterator();
		while(field.hasNext()) {
			var field1 = field.next();
			var val = null;
			if(defaults.exists(field1)) {
				val = this.theModel.get("defaults").get(field1);
			}
			fields.push({ name : field1, defaultValue : val});
		}
		return fields;
	}
	,getUserFieldDefinitions: function() {
		var fields = [];
		var defaults = null;
		if(this.theModel.exists("defaults")) {
			defaults = this.theModel.get("defaults");
		} else {
			defaults = new haxe.ds.StringMap();
		}
		var model = this.theModel.get("model");
		if(model == null) {
			return null;
		}
		var field = model.keys();
		while(field.hasNext()) {
			var field1 = field.next();
			var val = null;
			if(defaults.exists(field1)) {
				val = this.theModel.get("defaults").get(field1);
			}
			fields.push({ name : field1, defaultValue : val, field : this.theModel.get("model").get(field1)});
		}
		return fields;
	}
	,convertUserFieldName: function(userFieldName) {
		if(this.theModel.exists("model")) {
			if(this.theModel.get("model").exists(userFieldName)) {
				return this.theModel.get("model").get(userFieldName);
			} else {
				return null;
			}
		} else {
			return null;
		}
	}
	,getExtTableDefinition: function() {
		var tableDefinition = [];
		var name = this.theModel.get("model").keys();
		while(name.hasNext()) {
			var name1 = name.next();
			var field = this.theModel.get("model").get(name1);
			var def = { header : name1, dataIndex : field, editor : "textfield"};
			if(this.isRequired(field)) {
				def.tdCls = "required-column";
				def.allowBlank = false;
			}
			tableDefinition.push(def);
		}
		return tableDefinition;
	}
	,getSynthenticFields: function() {
		return this.theModel.get("fields.synthetic");
	}
	,isSyntheticallyBound: function(fieldName) {
		var synthFields = this.theModel.get("fields.synthetic");
		if(synthFields != null) {
			var syntheticFieldName = synthFields.keys();
			while(syntheticFieldName.hasNext()) {
				var syntheticFieldName1 = syntheticFieldName.next();
				if(synthFields.get(syntheticFieldName1).get("field") == fieldName) {
					return true;
				}
			}
		}
		return false;
	}
	,isSynthetic: function(fieldName) {
		if(this.theModel.exists("fields.synthetic")) {
			return this.theModel.get("fields.synthetic").exists(fieldName);
		} else {
			return false;
		}
	}
	,getPseudoSyntheticObjectName: function(fieldName) {
		if(this.theModel.exists("fields.synthetic")) {
			var objName = this.theModel.get("fields.synthetic").keys();
			while(objName.hasNext()) {
				var objName1 = objName.next();
				if(this.theModel.get("fields.synthetic").get(objName1).get("fk_field") == null) {
					var boundField = this.theModel.get("fields.synthetic").get(objName1).get("field");
					if(fieldName == boundField) {
						return objName1;
					}
				}
			}
		}
		return null;
	}
	,getSyntheticallyBoundField: function(syntheticFieldName) {
		if(this.theModel.exists("fields.synthetic")) {
			if(this.theModel.get("fields.synthetic").exists(syntheticFieldName)) {
				return this.theModel.get("fields.synthetic").get(syntheticFieldName).get("field");
			}
		}
		return null;
	}
	,getClass: function() {
		return Type.resolveClass(this.theName);
	}
	,getFirstKey: function() {
		return this.busSingleColKey;
	}
	,getIcon: function() {
		if(this.hasOptions()) {
			if(this.getOptions().exists("icon")) {
				return this.getOptions().get("icon");
			}
		}
		return "";
	}
	,getWorkspaceWrapper: function() {
		if(this.hasOptions()) {
			if(this.getOptions().exists("workspace_wrapper")) {
				return this.getOptions().get("workspace_wrapper");
			}
		}
		return "";
	}
	,getWorkspaceWrapperClass: function() {
		return Type.resolveClass(this.getWorkspaceWrapper());
	}
	,getPrimaryKey: function() {
		return this.priColKey;
	}
	,getName: function() {
		return this.theName;
	}
	,getExtModelName: function() {
		return this.theName + ".MODEL";
	}
	,getExtStoreName: function() {
		return this.theName + ".STORE";
	}
	,getFirstKey_rdbms: function() {
		return this.theModel.get("fields").get(this.getFirstKey());
	}
	,getSqlColumn: function(field) {
		return this.theModel.get("fields").get(field);
	}
	,unbindFieldName: function(field) {
		return this.getSqlColumn(field);
	}
	,getPrimaryKey_rdbms: function() {
		return this.theModel.get("fields").get(this.getPrimaryKey());
	}
	,getSchemaName: function() {
		return this.theModel.get("table_info").get("schema");
	}
	,getTableName: function() {
		return this.theModel.get("table_info").get("name");
	}
	,getQualifiedTableName: function() {
		var schemaName = this.getSchemaName();
		if(schemaName == null || schemaName == "") {
			return this.getTableName();
		} else {
			return this.getSchemaName() + "." + this.getTableName();
		}
	}
	,hasTableInfo: function() {
		return this.theModel.exists("table_info");
	}
	,getSelectClause: function() {
		return this.theModel.get("statements").get("SELECT");
	}
	,setInsertClause: function(insertClause) {
		this.theModel.get("statements").set("INSERT",insertClause);
	}
	,getInsertClause: function() {
		return this.theModel.get("statements").get("INSERT");
	}
	,setUpdateClause: function(updateClause) {
		this.theModel.get("statements").set("UPDATE",updateClause);
	}
	,getUpdateClause: function() {
		return this.theModel.get("statements").get("UPDATE");
	}
	,setDeleteClause: function(deleteClause) {
		this.theModel.get("statements").set("DELETE",deleteClause);
	}
	,getDeleteClause: function() {
		return this.theModel.get("statements").get("DELETE");
	}
	,setSelectKeyClause: function(selKeyClause) {
		this.theModel.get("statements").set("SELECT_KEY",selKeyClause);
	}
	,getSelectKeyClause: function() {
		return this.theModel.get("statements").get("SELECT_KEY");
	}
	,setColumns: function(columns) {
		this.theModel.get("statements").set("COLUMNS",columns);
		var colSet = new haxe.ds.StringMap();
		var _g = 0;
		while(_g < columns.length) {
			var column = columns[_g];
			++_g;
			colSet.set(column,"");
		}
		this.theModel.get("statements").set("COLUMNS_SET",colSet);
	}
	,getColumns: function() {
		return this.theModel.get("statements").get("COLUMNS");
	}
	,getColumnSet: function() {
		return this.theModel.get("statements").get("COLUMNS_SET");
	}
	,getSelectorField: function() {
		if(this.theModel.exists("selector")) {
			return this.theModel.get("selector").get("polymorph_key");
		} else {
			return null;
		}
	}
	,getSelectorValue: function() {
		return this.theModel.get("selector").get("value");
	}
	,isPolymorph: function() {
		return this.theModel.exists("selector");
	}
	,getUserConstraintField: function() {
		return this.userConstraintField;
	}
	,getPublicConstraintField: function() {
		return this.publicConstraintField;
	}
	,__class__: saturn.db.Model
};
saturn.db.SearchDef = $hxClasses["saturn.db.SearchDef"] = function() {
	this.replaceWith = null;
	this.regex = null;
};
saturn.db.SearchDef.__name__ = ["saturn","db","SearchDef"];
saturn.db.SearchDef.prototype = {
	regex: null
	,replaceWith: null
	,__class__: saturn.db.SearchDef
};
saturn.db.ModelAction = $hxClasses["saturn.db.ModelAction"] = function(name,userSuffix,qName,icon) {
	this.name = name;
	this.userSuffix = userSuffix;
	this.setQualifiedName(qName);
	this.icon = icon;
};
saturn.db.ModelAction.__name__ = ["saturn","db","ModelAction"];
saturn.db.ModelAction.prototype = {
	name: null
	,userSuffix: null
	,functionName: null
	,className: null
	,icon: null
	,setQualifiedName: function(qName) {
		var i = qName.lastIndexOf(".");
		this.functionName = qName.substring(i + 1,qName.length);
		this.className = qName.substring(0,i);
	}
	,run: function(obj,cb) {
		Reflect.callMethod(obj,Reflect.field(obj,this.functionName),[cb]);
	}
	,__class__: saturn.db.ModelAction
};
saturn.db.NodePool = $hxClasses["saturn.db.NodePool"] = function() { };
saturn.db.NodePool.__name__ = ["saturn","db","NodePool"];
saturn.db.NodePool.generatePool = function(name,max,min,idleTimeout,log,createCb,destroyCb) {
	var genericPool = js.Node.require("generic-pool");
	var d = { "name" : name, "create" : createCb, "destroy" : destroyCb, "max" : max, "min" : min, "idleTimeoutMillis" : idleTimeout, "log" : log};
	var pool = genericPool.Pool(d);
	return pool;
};
saturn.db.Pool = $hxClasses["saturn.db.Pool"] = function() { };
saturn.db.Pool.__name__ = ["saturn","db","Pool"];
saturn.db.Pool.prototype = {
	acquire: null
	,release: null
	,drain: null
	,destroyAllNow: null
	,__class__: saturn.db.Pool
};
if(!saturn.db.mapping) saturn.db.mapping = {};
if(!saturn.db.mapping.templates) saturn.db.mapping.templates = {};
saturn.db.mapping.templates.DefaultMapping = $hxClasses["saturn.db.mapping.templates.DefaultMapping"] = function() {
	this.buildModels();
};
saturn.db.mapping.templates.DefaultMapping.__name__ = ["saturn","db","mapping","templates","DefaultMapping"];
saturn.db.mapping.templates.DefaultMapping.prototype = {
	models: null
	,buildModels: function() {
		this.models = new haxe.ds.StringMap();
	}
	,__class__: saturn.db.mapping.templates.DefaultMapping
};
if(!saturn.db.provider) saturn.db.provider = {};
saturn.db.provider.GenericRDBMSProvider = $hxClasses["saturn.db.provider.GenericRDBMSProvider"] = function(models,config,autoClose) {
	this.modelsToProcess = 0;
	this.theConnection = null;
	this.debug = (js.Node.require("debug"))("saturn:sql");
	saturn.db.DefaultProvider.call(this,models,config,autoClose);
	this.config = config;
	this.user = new saturn.core.User();
	this.user.username = config.username;
	this.user.password = config.password;
	var hook = this.namedQueryHooks.keys();
	while(hook.hasNext()) {
		var hook1 = hook.next();
		this.debug("Installed hook: " + hook1 + "/" + Std.string(this.namedQueryHooks.get(hook1)));
	}
	this.debug("Platform: " + js.Node.process.platform);
	this.debug("Platform key: " + this.platform);
};
saturn.db.provider.GenericRDBMSProvider.__name__ = ["saturn","db","provider","GenericRDBMSProvider"];
saturn.db.provider.GenericRDBMSProvider.__super__ = saturn.db.DefaultProvider;
saturn.db.provider.GenericRDBMSProvider.prototype = $extend(saturn.db.DefaultProvider.prototype,{
	debug: null
	,theConnection: null
	,modelsToProcess: null
	,setPlatform: function() {
		if(js.Node.process.platform == "win32") {
			this.platform = "windows";
		} else {
			this.platform = js.Node.process.platform;
		}
	}
	,setUser: function(user) {
		this.debug("User called");
		saturn.db.DefaultProvider.prototype.setUser.call(this,user);
	}
	,generatedLinkedClone: function() {
		var provider = saturn.db.DefaultProvider.prototype.generatedLinkedClone.call(this);
		provider.config = this.config;
		provider.debug = this.debug;
		provider.modelsToProcess = this.modelsToProcess;
		provider.theConnection = null;
		provider.user = this.user;
		return provider;
	}
	,readModels: function(cb) {
		var _gthis = this;
		var modelClazzes = [];
		var modelClazz = this.theBindingMap.keys();
		while(modelClazz.hasNext()) {
			var modelClazz1 = modelClazz.next();
			modelClazzes.push(modelClazz1);
		}
		this.modelsToProcess = modelClazzes.length;
		this.getConnection(this.config,function(err,conn) {
			if(err != null) {
				_gthis.debug("Error getting connection for reading models");
				_gthis.debug(err);
				cb(err);
			} else {
				_gthis.debug("Querying database for model information");
				_gthis._readModels(modelClazzes,_gthis,conn,cb);
			}
		});
	}
	,_readModels: function(modelClazzes,provider,connection,cb) {
		var _gthis = this;
		var modelClazz = modelClazzes.pop();
		this.debug("Processing model: " + modelClazz);
		var model = provider.getModelByStringName(modelClazz);
		var captured_super = $bind(this,this.postConfigureModels);
		if(model.hasTableInfo()) {
			var keyCol = model.getFirstKey_rdbms();
			var priCol = model.getPrimaryKey_rdbms();
			var tableName = model.getTableName();
			var schemaName = model.getSchemaName();
			var qName = this.generateQualifiedName(schemaName,tableName);
			var func = function(err,cols) {
				if(err != null) {
					cb(err);
				} else {
					var func1 = "SELECT DISTINCT " + cols.join(",") + " FROM " + qName;
					provider.setSelectClause(modelClazz,func1);
					model.setInsertClause("INSERT INTO " + qName);
					var func2 = "DELETE FROM " + qName + "WHERE " + priCol + " = " + _gthis.dbSpecificParamPlaceholder(1);
					model.setDeleteClause(func2);
					model.setUpdateClause("UPDATE " + qName);
					model.setSelectKeyClause("SELECT DISTINCT " + keyCol + ", " + priCol + " FROM " + qName + " ");
					model.setColumns(cols);
					_gthis.modelsToProcess--;
					_gthis.debug("Model processed: " + modelClazz);
					_gthis.debug(cols);
					if(_gthis.modelsToProcess == 0) {
						_gthis.postConfigureModels();
						_gthis.closeConnection(connection);
						if(cb != null) {
							_gthis.debug("All Models have been processed (handing back control to caller callback)");
							cb(null);
						}
					} else {
						_gthis._readModels(modelClazzes,provider,connection,cb);
					}
				}
			};
			this.getColumns(connection,schemaName,tableName,func);
		} else if(modelClazzes.length == 0 && this.modelsToProcess == 1) {
			this.postConfigureModels();
			this.closeConnection(connection);
			if(cb != null) {
				this.debug("All Models have been processed (handing back control to caller callback2)");
				cb(null);
			}
		} else {
			this.modelsToProcess--;
			this._readModels(modelClazzes,provider,connection,cb);
		}
	}
	,generateQualifiedName: function(schemaName,tableName) {
		return schemaName + "." + tableName;
	}
	,getColumns: function(connection,schemaName,tableName,cb) {
		connection.execute("select COLUMN_NAME from ALL_TAB_COLUMNS where OWNER=:1 AND TABLE_NAME=:2",[schemaName,tableName],function(err,results) {
			if(err == null) {
				var cols = [];
				var _g = 0;
				while(_g < results.length) {
					var row = results[_g];
					++_g;
					cols.push(Reflect.field(row,"COLUMN_NAME"));
				}
				cb(null,cols);
			} else {
				cb(err,null);
			}
		});
	}
	,_closeConnection: function() {
		this.debug("Closing connection!");
		if(this.theConnection != null) {
			this.theConnection.close();
			this.theConnection = null;
		}
	}
	,getConnection: function(config,cb) {
		var _gthis = this;
		if(!this.autoClose && this.theConnection != null) {
			this.debug("Using existing connection");
			cb(null,this.theConnection);
			return;
		}
		this._getConnection(function(err,conn) {
			_gthis.theConnection = conn;
			cb(err,conn);
		});
	}
	,_getConnection: function(cb) {
	}
	,_getByIds: function(ids,clazz,callBack) {
		var _gthis = this;
		if(clazz == saturn.core.domain.FileProxy) {
			this.handleFileRequests(ids,clazz,callBack);
			return;
		}
		var model = this.getModel(clazz);
		var selectClause = model.getSelectClause();
		var keyCol = model.getFirstKey_rdbms();
		var _g1 = 0;
		var _g = ids.length;
		while(_g1 < _g) {
			var i = _g1++;
			var tmp = ids[i].toUpperCase();
			ids[i] = tmp;
		}
		var selectorSQL = this.getSelectorFieldConstraintSQL(clazz);
		if(selectorSQL != "") {
			selectorSQL = " AND " + selectorSQL;
		}
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				callBack(null,err);
			} else {
				var sql = selectClause + "  WHERE UPPER(" + _gthis.columnToStringCommand(keyCol) + ") " + _gthis.buildSqlInClause(ids.length,0,"upper") + " " + selectorSQL;
				var additionalSQL = _gthis.generateUserConstraintSQL(clazz);
				if(additionalSQL != null) {
					sql += " AND " + additionalSQL;
				}
				sql += " ORDER BY " + keyCol;
				_gthis.debug("SQL" + sql);
				try {
					connection.execute(sql,ids,function(err1,results) {
						if(err1 != null) {
							callBack(null,err1);
						} else {
							_gthis.debug("Sending results");
							callBack(results,null);
						}
						_gthis.closeConnection(connection);
					});
				} catch( e ) {
					if (e instanceof js._Boot.HaxeError) e = e.val;
					_gthis.closeConnection(connection);
					saturn.core.Util.debug(e);
					callBack(null,e);
				}
			}
		});
	}
	,_getObjects: function(clazz,callBack) {
		var _gthis = this;
		var model = this.getModel(clazz);
		var selectClause = model.getSelectClause();
		var selectorSQL = this.getSelectorFieldConstraintSQL(clazz);
		if(selectorSQL != "") {
			selectorSQL = " WHERE " + selectorSQL;
		}
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				callBack(null,err);
			} else {
				var sql = selectClause + " " + selectorSQL;
				var additionalSQL = _gthis.generateUserConstraintSQL(clazz);
				if(additionalSQL != null) {
					sql += " AND " + additionalSQL;
				}
				sql += " ORDER BY " + model.getFirstKey_rdbms();
				_gthis.debug(sql);
				try {
					connection.execute(sql,[],function(err1,results) {
						if(err1 != null) {
							callBack(null,err1);
						} else {
							callBack(results,null);
						}
						_gthis.closeConnection(connection);
					});
				} catch( e ) {
					if (e instanceof js._Boot.HaxeError) e = e.val;
					_gthis.closeConnection(connection);
					saturn.core.Util.debug(e);
					callBack(null,e);
				}
			}
		});
	}
	,_getByValues: function(values,clazz,field,callBack) {
		var _gthis = this;
		if(clazz == saturn.core.domain.FileProxy) {
			this.handleFileRequests(values,clazz,callBack);
			return;
		}
		var model = this.getModel(clazz);
		var selectClause = model.getSelectClause();
		var sqlField = model.getSqlColumn(field);
		var selectorSQL = this.getSelectorFieldConstraintSQL(clazz);
		if(selectorSQL != "") {
			selectorSQL = " AND " + selectorSQL;
		}
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				callBack(null,err);
			} else {
				var sql = selectClause + "  WHERE " + sqlField + " " + _gthis.buildSqlInClause(values.length) + " " + selectorSQL;
				var additionalSQL = _gthis.generateUserConstraintSQL(clazz);
				if(additionalSQL != null) {
					sql += " AND " + additionalSQL;
				}
				sql += " ORDER BY " + sqlField;
				_gthis.debug(sql);
				_gthis.debug(values);
				try {
					connection.execute(sql,values,function(err1,results) {
						if(err1 != null) {
							callBack(null,err1);
						} else {
							_gthis.debug("Result count: " + Std.string(results) + " " + Std.string(values));
							callBack(results,null);
						}
						_gthis.closeConnection(connection);
					});
				} catch( e ) {
					if (e instanceof js._Boot.HaxeError) e = e.val;
					_gthis.closeConnection(connection);
					saturn.core.Util.debug(e);
					callBack(null,e);
				}
			}
		});
	}
	,getSelectorFieldConstraintSQL: function(clazz) {
		var model = this.getModel(clazz);
		var selectorField = model.getSelectorField();
		if(selectorField != null) {
			var selectorValue = model.getSelectorValue();
			return selectorField + " = \"" + selectorValue + "\"";
		} else {
			return "";
		}
	}
	,buildSqlInClause: function(numIds,nextVal,func) {
		if(nextVal == null) {
			nextVal = 0;
		}
		var inClause = new StringBuf();
		inClause.add("IN(");
		var _g1 = 0;
		var _g = numIds;
		while(_g1 < _g) {
			var i = _g1++;
			var def = this.dbSpecificParamPlaceholder(i + 1 + nextVal);
			if(func != null) {
				def = func + "(" + def + ")";
			}
			inClause.add(def);
			if(i != numIds - 1) {
				inClause.add(",");
			}
		}
		inClause.add(")");
		return inClause.toString();
	}
	,_getByPkeys: function(ids,clazz,callBack) {
		var _gthis = this;
		if(clazz == saturn.core.domain.FileProxy) {
			this.handleFileRequests(ids,clazz,callBack);
			return;
		}
		var model = this.getModel(clazz);
		var selectClause = model.getSelectClause();
		var keyCol = model.getPrimaryKey_rdbms();
		var selectorSQL = this.getSelectorFieldConstraintSQL(clazz);
		if(selectorSQL != "") {
			selectorSQL = " AND " + selectorSQL;
		}
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				callBack(null,err);
			} else {
				var sql = selectClause + "  WHERE " + keyCol + " " + _gthis.buildSqlInClause(ids.length) + selectorSQL;
				var additionalSQL = _gthis.generateUserConstraintSQL(clazz);
				if(additionalSQL != null) {
					sql += " AND " + additionalSQL;
				}
				sql += " " + " ORDER BY " + keyCol;
				_gthis.debug(sql);
				try {
					connection.execute(sql,ids,function(err1,results) {
						if(err1 != null) {
							callBack(null,err1);
						} else {
							callBack(results,null);
						}
						_gthis.closeConnection(connection);
					});
				} catch( e ) {
					if (e instanceof js._Boot.HaxeError) e = e.val;
					_gthis.closeConnection(connection);
					callBack(null,e);
				}
			}
		});
	}
	,_query: function(query,cb) {
		var _gthis = this;
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				cb(null,err);
			} else {
				try {
					var visitor = new saturn.db.query_lang.SQLVisitor(_gthis);
					var sql = visitor.translate(query);
					_gthis.debug(sql);
					_gthis.debug(visitor.getValues());
					var tmp = visitor.getValues();
					connection.execute(sql,tmp,function(err1,results) {
						if(err1 != null) {
							cb(null,err1);
						} else {
							results = visitor.getProcessedResults(results);
							cb(results,null);
						}
						_gthis.closeConnection(connection);
					});
				} catch( e ) {
					if (e instanceof js._Boot.HaxeError) e = e.val;
					_gthis.closeConnection(connection);
					_gthis.debug("Error !!!!!!!!!!!!!" + Std.string(e.stack));
					cb(null,e);
				}
			}
		});
	}
	,_getByIdStartsWith: function(id,field,clazz,limit,callBack) {
		var _gthis = this;
		var model = this.getModel(clazz);
		this.debug("Provider class" + Type.getClassName(Type.getClass(this)));
		this.debug("Provider: " + model.getProviderName());
		var keyCol = null;
		if(field == null) {
			keyCol = model.getFirstKey_rdbms();
		} else if(model.isRDBMSField(field)) {
			keyCol = field;
		}
		var busKey = model.getFirstKey_rdbms();
		var priCol = model.getPrimaryKey_rdbms();
		var tableName = model.getTableName();
		var schemaName = model.getSchemaName();
		var qName = this.generateQualifiedName(schemaName,tableName);
		var selectClause = "SELECT DISTINCT " + busKey + ", " + priCol;
		if(keyCol != busKey && keyCol != priCol) {
			selectClause += ", " + keyCol;
		}
		selectClause += " FROM " + qName;
		id = id.toUpperCase();
		var selectorSQL = this.getSelectorFieldConstraintSQL(clazz);
		if(selectorSQL != "") {
			selectorSQL = " AND " + selectorSQL;
		}
		if(!this.limitAtEndPosition()) {
			if(limit != null && limit != 0 && limit != -1) {
				selectorSQL += this.generateLimitClause(limit);
			}
		}
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				callBack(null,err);
			} else {
				var sql = selectClause + "  WHERE UPPER(" + _gthis.columnToStringCommand(keyCol) + ") like " + _gthis.dbSpecificParamPlaceholder(1) + " " + selectorSQL;
				var additionalSQL = _gthis.generateUserConstraintSQL(clazz);
				if(additionalSQL != null) {
					sql += " AND " + additionalSQL;
				}
				sql += " ORDER BY " + keyCol;
				if(_gthis.limitAtEndPosition()) {
					if(limit != null && limit != 0 && limit != -1) {
						sql += _gthis.generateLimitClause(limit);
					}
				}
				id = "%" + id + "%";
				_gthis.debug("startswith" + sql);
				try {
					connection.execute(sql,[id],function(err1,results) {
						if(err1 != null) {
							callBack(null,err1);
						} else {
							callBack(results,null);
						}
						_gthis.closeConnection(connection);
					});
				} catch( e ) {
					if (e instanceof js._Boot.HaxeError) e = e.val;
					saturn.core.Util.debug(e);
					_gthis.closeConnection(connection);
					callBack(null,e);
				}
			}
		});
	}
	,limitAtEndPosition: function() {
		return false;
	}
	,generateLimitClause: function(limit) {
		return " AND ROWNUM < " + Std["int"](limit);
	}
	,columnToStringCommand: function(columnName) {
		return columnName;
	}
	,convertComplexQuery: function(parameters) {
	}
	,_getByNamedQuery: function(queryId,parameters,clazz,cb) {
		var _gthis = this;
		if(!Reflect.hasField(this.config.named_queries,queryId)) {
			this.debug("Hook is missing");
			cb(null,"Query " + queryId + " not found ");
		} else {
			this.debug("Calling SQL query");
			var sql = Reflect.field(this.config.named_queries,queryId);
			var realParameters = [];
			if((parameters instanceof Array) && parameters.__enum__ == null) {
				this.debug("Named query passed an Array");
				var re = new EReg("(<IN>)","");
				if(re.match(sql)) {
					var sql1 = this.buildSqlInClause(parameters.length);
					sql = re.replace(sql,sql1);
				}
				realParameters = parameters;
			} else {
				this.debug("Named query with other object type");
				var dbPlaceHolderI = 0;
				var attributes = Reflect.fields(parameters);
				if(attributes.length == 0) {
					cb(null,"Unknown parameter collection type");
					return;
				} else {
					this.debug("Named query passed object");
					var re_in = new EReg("^IN:","");
					var re1 = new EReg("<:([^>]+)>","");
					var convertedSQL = "";
					var matchMe = sql;
					while(matchMe != null) {
						this.debug("Looping: " + matchMe);
						this.debug("SQL: " + convertedSQL);
						if(re1.matchSub(matchMe,0)) {
							var matchLeft = re1.matchedLeft();
							var tagName = re1.matched(1);
							this.debug("MatchLeft: " + matchLeft);
							this.debug("Tag:" + tagName);
							convertedSQL += matchLeft;
							if(re_in.matchSub(tagName,0)) {
								this.debug("Found IN");
								tagName = re_in.replace(tagName,"");
								this.debug("Real Tag Name" + tagName);
								if(Reflect.hasField(parameters,tagName)) {
									this.debug("Found array");
									var paramArray = Reflect.field(parameters,tagName);
									if((paramArray instanceof Array) && paramArray.__enum__ == null) {
										convertedSQL += this.buildSqlInClause(paramArray.length);
										var _g1 = 0;
										var _g = paramArray.length;
										while(_g1 < _g) {
											var i = _g1++;
											realParameters.push(paramArray[i]);
										}
									} else {
										cb(null,"Value to attribute " + tagName + " should be an Array");
										return;
									}
								} else {
									cb(null,"Missing attribute " + tagName);
									return;
								}
							} else {
								this.debug("Found non IN argument");
								if(Reflect.hasField(parameters,tagName)) {
									convertedSQL += this.dbSpecificParamPlaceholder(dbPlaceHolderI++);
									var value = Reflect.field(parameters,tagName);
									realParameters.push(value);
								} else {
									cb(null,"Missing attribute " + tagName);
									return;
								}
							}
							matchMe = re1.matchedRight();
							this.debug("Found right " + matchMe);
						} else {
							convertedSQL += matchMe;
							matchMe = null;
							this.debug("Terminating while");
						}
					}
					sql = convertedSQL;
				}
			}
			this.debug("SQL: " + sql);
			this.debug("Parameters: " + Std.string(realParameters));
			this.getConnection(this.config,function(err,connection) {
				if(err != null) {
					cb(null,err);
				} else {
					_gthis.debug(sql);
					try {
						connection.execute(sql,realParameters,function(err1,results) {
							_gthis.debug("Named query returning");
							if(err1 != null) {
								cb(null,err1);
							} else {
								cb(results,null);
							}
							_gthis.closeConnection(connection);
						});
					} catch( e ) {
						if (e instanceof js._Boot.HaxeError) e = e.val;
						_gthis.closeConnection(connection);
						cb(null,e);
					}
				}
			});
		}
	}
	,_update: function(attributeMaps,className,cb) {
		var _gthis = this;
		this.applyFunctions(attributeMaps,className);
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				cb(err);
			} else {
				var clazz = Type.resolveClass(className);
				var model = _gthis.getModel(clazz);
				_gthis._updateRecursive(attributeMaps,model,cb,connection);
			}
		});
	}
	,_insert: function(attributeMaps,className,cb) {
		var _gthis = this;
		this.applyFunctions(attributeMaps,className);
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				cb(err);
			} else {
				var clazz = Type.resolveClass(className);
				var model = _gthis.getModel(clazz);
				_gthis._insertRecursive(attributeMaps,model,cb,connection);
			}
		});
	}
	,cloneConfig: function() {
		var cloneData = haxe.Serializer.run(this.config);
		var unserObj = haxe.Unserializer.run(cloneData);
		return unserObj;
	}
	,_insertRecursive: function(attributeMaps,model,cb,connection) {
		var _gthis = this;
		this.debug("Inserting  " + Type.getClassName(model.getClass()));
		var insertClause = model.getInsertClause();
		var cols = model.getColumnSet();
		var attributeMap = attributeMaps.pop();
		var colStr = new StringBuf();
		var valList = [];
		var valStr = new StringBuf();
		var i = 0;
		var hasWork = false;
		var attribute = attributeMap.keys();
		while(attribute.hasNext()) {
			var attribute1 = attribute.next();
			if(cols != null && cols.exists(attribute1)) {
				if(i > 0) {
					colStr.add(",");
					valStr.add(",");
				}
				++i;
				colStr.add(attribute1);
				valStr.add(this.dbSpecificParamPlaceholder(i));
				var val = attributeMap.get(attribute1);
				if(val == "" && !(typeof(val) == "number" && ((val | 0) === val))) {
					val = null;
				}
				valList.push(val);
				hasWork = true;
			}
		}
		if(model.isPolymorph()) {
			++i;
			colStr.add("," + model.getSelectorField());
			valStr.add("," + this.dbSpecificParamPlaceholder(i));
			valList.push(model.getSelectorValue());
			hasWork = true;
		}
		if(!hasWork) {
			this.debug("No work - returning error");
			var tmp = "Insert failure: no mapped fields for " + Type.getClassName(model.getClass());
			cb(tmp);
			return;
		}
		var sql = insertClause + " (" + Std.string(colStr) + ") VALUES(" + Std.string(valStr) + ")";
		var keyCol = model.getFirstKey_rdbms();
		var keyVal = attributeMap.get(keyCol);
		this.debug("MAP:" + attributeMap.toString());
		this.debug("SQL" + sql);
		this.debug("Values" + Std.string(valList));
		try {
			connection.execute(sql,valList,function(err,results) {
				if(err != null) {
					var error = { message : StringTools.replace(err == null ? "null" : "" + err,"\n",""), source : keyVal};
					cb(error);
					_gthis.closeConnection(connection);
				} else if(attributeMaps.length == 0) {
					cb(null);
					_gthis.closeConnection(connection);
				} else {
					_gthis._insertRecursive(attributeMaps,model,cb,connection);
				}
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			this.closeConnection(connection);
			var error1 = { message : StringTools.replace(Std.string(e),"\n",""), source : keyVal};
			cb(error1);
		}
	}
	,_updateRecursive: function(attributeMaps,model,cb,connection) {
		var _gthis = this;
		var updateClause = model.getUpdateClause();
		var cols = model.getColumnSet();
		var attributeMap = attributeMaps.pop();
		var valList = [];
		var updateStr = new StringBuf();
		var i = 0;
		var attribute = attributeMap.keys();
		while(attribute.hasNext()) {
			var attribute1 = attribute.next();
			if(cols.exists(attribute1) && attribute1 != model.getPrimaryKey_rdbms()) {
				if(attribute1 == "DATESTAMP") {
					continue;
				}
				if(i > 0) {
					updateStr.add(",");
				}
				++i;
				updateStr.add(attribute1 + " = " + this.dbSpecificParamPlaceholder(i));
				var val = attributeMap.get(attribute1);
				if(val == "") {
					val = null;
				}
				valList.push(val);
			}
		}
		++i;
		var keyCol = model.getPrimaryKey_rdbms();
		var sql = updateClause + " SET " + Std.string(updateStr) + " WHERE " + keyCol + " = " + this.dbSpecificParamPlaceholder(i);
		var additionalSQL = this.generateUserConstraintSQL(model.getClass());
		if(additionalSQL != null) {
			sql += " AND " + additionalSQL;
		}
		valList.push(attributeMap.get(keyCol));
		this.debug("SQL" + sql);
		this.debug("Values" + Std.string(valList));
		try {
			connection.execute(sql,valList,function(err,results) {
				if(err != null) {
					saturn.core.Util.debug("Error: " + err);
					cb(err);
					_gthis.closeConnection(connection);
				} else if(attributeMaps.length == 0) {
					cb(null);
					_gthis.closeConnection(connection);
				} else {
					_gthis._updateRecursive(attributeMaps,model,cb,connection);
				}
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			this.closeConnection(connection);
			cb(e);
		}
	}
	,_delete: function(attributeMaps,className,cb) {
		var _gthis = this;
		var model = this.getModelByStringName(className);
		var priField = model.getPrimaryKey();
		var priFieldSql = model.getPrimaryKey_rdbms();
		var pkeys = [];
		var _g = 0;
		while(_g < attributeMaps.length) {
			var attributeMap = attributeMaps[_g];
			++_g;
			pkeys.push(attributeMap.get(priFieldSql));
		}
		var d = attributeMaps;
		var sql = "DELETE FROM " + this.generateQualifiedName(model.getSchemaName(),model.getTableName()) + " WHERE " + priFieldSql + " " + this.buildSqlInClause(pkeys.length);
		var additionalSQL = this.generateUserConstraintSQL(model.getClass());
		if(additionalSQL != null) {
			sql += " AND " + additionalSQL;
		}
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				cb(err);
			} else {
				try {
					connection.execute(sql,pkeys,function(err1,results) {
						if(err1 != null) {
							saturn.core.Util.debug("Error: " + err1);
							cb(err1);
							_gthis.closeConnection(connection);
						} else {
							cb(null);
						}
					});
				} catch( e ) {
					if (e instanceof js._Boot.HaxeError) e = e.val;
					_gthis.closeConnection(connection);
					cb(e);
				}
			}
		});
	}
	,postConfigureModels: function() {
		saturn.db.DefaultProvider.prototype.postConfigureModels.call(this);
	}
	,parseObjectList: function(data) {
		return null;
	}
	,dbSpecificParamPlaceholder: function(i) {
		return ":" + i;
	}
	,getProviderType: function() {
		return "ORACLE";
	}
	,applyFunctions: function(attributeMaps,className) {
		var context = this.user;
		var model = this.getModelByStringName(className);
		var functions = model.getAutoFunctions();
		if(functions != null) {
			var field = functions.keys();
			while(field.hasNext()) {
				var field1 = field.next();
				var functionString = functions.get(field1);
				var func = null;
				if(functionString == "insert.username") {
					func = $bind(this,this.setUserName);
				} else {
					continue;
				}
				var _g = 0;
				while(_g < attributeMaps.length) {
					var attributeMap = attributeMaps[_g];
					++_g;
					if(attributeMap.exists(field1)) {
						attributeMap.set(field1,Reflect.callMethod(this,func,[attributeMap.get(field1),context]));
					}
				}
			}
		}
		return attributeMaps;
	}
	,setUserName: function(value,context) {
		if(context != null && context.username != null) {
			return context.username.toUpperCase();
		} else {
			return value;
		}
	}
	,handleFileRequests: function(values,clazz,callBack) {
		var _gthis = this;
		var i = 0;
		var next = null;
		var results = [];
		next = function() {
			if(i < values.length) {
				var value = values[i];
				var key = value;
				_gthis.debug("Processing file requests");
				_gthis.debug(_gthis.conversions);
				var conversion = _gthis.conversions.keys();
				while(conversion.hasNext()) {
					var conversion1 = conversion.next();
					var replacement = _gthis.conversions.get(conversion1);
					value = StringTools.replace(value,conversion1,replacement);
				}
				if(_gthis.platform == "windows") {
					value = StringTools.replace(value,"/","\\");
				}
				_gthis.debug("Unlinking path " + value);
				js.Node.get_fs().realpath(value,function(err,abspath) {
					if(err != null) {
						_gthis.debug("File realpath error: " + err);
						var next1 = saturn.app.SaturnServer.getStandardUserInputError();
						callBack(null,next1);
					} else {
						var match = false;
						var key1 = _gthis.regexs.keys();
						while(key1.hasNext()) {
							var key2 = key1.next();
							if(_gthis.regexs.get(key2).match(value)) {
								match = true;
								break;
							}
						}
						if(match) {
							_gthis.debug("Reading path: " + abspath);
							js.Node.get_fs().readFile(abspath,null,function(err1,content) {
								if(err1 != null) {
									_gthis.debug("File read error: " + err1 + "/" + abspath);
									var next2 = saturn.app.SaturnServer.getStandardUserInputError();
									callBack(null,next2);
								} else {
									var match1 = false;
									var key3 = _gthis.regexs.keys();
									while(key3.hasNext()) {
										var key4 = key3.next();
										if(_gthis.regexs.get(key4).match(value)) {
											match1 = true;
											break;
										}
									}
									i += 1;
									results.push({ "PATH" : key, "CONTENT" : content});
									next();
								}
							});
						} else {
							_gthis.debug("File read error: " + err);
							var next3 = saturn.app.SaturnServer.getStandardUserInputError();
							callBack(null,next3);
						}
					}
				});
			} else {
				callBack(results,null);
			}
		};
		next();
	}
	,setConnection: function(conn) {
		this.theConnection = conn;
	}
	,_commit: function(cb) {
		this.getConnection(this.config,function(err,connection) {
			if(err != null) {
				cb(err);
			} else {
				connection.commit(cb);
			}
		});
	}
	,setAutoCommit: function(autoCommit,cb) {
		this.getConnection(this.config,function(err,conn) {
			if(err == null) {
				conn.setAutoCommit(autoCommit);
				cb(null);
			} else {
				cb(err);
			}
		});
	}
	,generateUserConstraintSQL: function(clazz) {
		var model = this.getModel(clazz);
		var publicConstraintField = model.getPublicConstraintField();
		var userConstraintField = model.getUserConstraintField();
		var sql = null;
		if(publicConstraintField != null) {
			var columnName = model.getSqlColumn(publicConstraintField);
			sql = " " + columnName + " = 'yes' ";
		}
		if(userConstraintField != null) {
			var inBlock = false;
			if(sql != null) {
				sql = "(" + sql + " OR ";
				inBlock = true;
			}
			var columnName1 = model.getSqlColumn(userConstraintField);
			sql = sql + columnName1 + " = '" + this.getUser().username.toUpperCase() + "'";
			if(inBlock) {
				sql += " ) ";
			}
		}
		return sql;
	}
	,__class__: saturn.db.provider.GenericRDBMSProvider
});
saturn.db.provider.MySQLProvider = $hxClasses["saturn.db.provider.MySQLProvider"] = function(models,config,autoClose) {
	saturn.db.provider.GenericRDBMSProvider.call(this,models,config,autoClose);
};
saturn.db.provider.MySQLProvider.__name__ = ["saturn","db","provider","MySQLProvider"];
saturn.db.provider.MySQLProvider.__super__ = saturn.db.provider.GenericRDBMSProvider;
saturn.db.provider.MySQLProvider.prototype = $extend(saturn.db.provider.GenericRDBMSProvider.prototype,{
	getColumns: function(connection,schemaName,tableName,cb) {
		var _gthis = this;
		connection.query("DESCRIBE " + schemaName + "." + tableName,[],function(err,rows) {
			if(err != null) {
				_gthis.debug("Got DESCRIBE exception on  " + tableName);
				cb(err,null);
			} else {
				var cols = [];
				var _g = 0;
				while(_g < rows.length) {
					var row = rows[_g];
					++_g;
					cols.push(row.Field.toUpperCase());
				}
				cb(null,cols);
			}
		});
	}
	,getProviderType: function() {
		return "MYSQL";
	}
	,_closeConnection: function() {
		this.debug("Closing connection!");
		if(this.theConnection != null) {
			var d = this.theConnection;
			this.debug(Reflect.fields(d));
			d.close();
			this.theConnection = null;
		}
	}
	,limitAtEndPosition: function() {
		return true;
	}
	,generateLimitClause: function(limit) {
		return " limit " + Std["int"](limit);
	}
	,generateQualifiedName: function(schemaName,tableName) {
		return schemaName + "." + tableName;
	}
	,_getConnection: function(cb) {
		var _gthis = this;
		this.debug("Obtaining MySQL theDB");
		try {
			var mysql = js.Node.require("mysql2");
			var connection = mysql.createConnection({ host : this.config.host, user : this.user.username, password : this.user.password, database : this.config.database});
			this.debug("Connecting to " + Std.string(this.config.database) + " as " + this.user.username + " with password " + this.user.password + " on host " + Std.string(this.config.host));
			connection.on("connect",function(connect) {
				if(connect) {
					_gthis.debug("Connected");
					connection.execute = connection.query;
					cb(null,connection);
				} else {
					_gthis.debug("Unable to connect");
					cb("Unable to connect",null);
				}
			});
			connection.on("error",function(err) {
				_gthis.debug("Error connecting " + Std.string(err));
				_gthis.debug("Waiting to attempt reconnect");
				if(_gthis.config.auto_reconnect) {
					haxe.Timer.delay(function() {
						_gthis.debug("Reconnecting");
						_gthis._getConnection(function(err1,conn) {
							if(err1 != null) {
								throw new js._Boot.HaxeError("Unable to reconnect MySQL session");
							} else {
								_gthis.theConnection = conn;
							}
						});
					},500);
				}
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			this.debug("Error" + Std.string(e));
			cb(e,null);
			return;
		}
	}
	,dbSpecificParamPlaceholder: function(i) {
		return "?";
	}
	,__class__: saturn.db.provider.MySQLProvider
});
saturn.db.provider.OracleProvider = $hxClasses["saturn.db.provider.OracleProvider"] = function(models,config,autoClose) {
	saturn.db.provider.GenericRDBMSProvider.call(this,models,config,autoClose);
};
saturn.db.provider.OracleProvider.__name__ = ["saturn","db","provider","OracleProvider"];
saturn.db.provider.OracleProvider.__super__ = saturn.db.provider.GenericRDBMSProvider;
saturn.db.provider.OracleProvider.prototype = $extend(saturn.db.provider.GenericRDBMSProvider.prototype,{
	_getConnection: function(cb) {
	}
	,__class__: saturn.db.provider.OracleProvider
});
saturn.db.provider.PostgreSQLProvider = $hxClasses["saturn.db.provider.PostgreSQLProvider"] = function(models,config,autoClose) {
	saturn.db.provider.GenericRDBMSProvider.call(this,models,config,autoClose);
};
saturn.db.provider.PostgreSQLProvider.__name__ = ["saturn","db","provider","PostgreSQLProvider"];
saturn.db.provider.PostgreSQLProvider.__super__ = saturn.db.provider.GenericRDBMSProvider;
saturn.db.provider.PostgreSQLProvider.prototype = $extend(saturn.db.provider.GenericRDBMSProvider.prototype,{
	getProviderType: function() {
		return "PGSQL";
	}
	,getColumns: function(connection,schemaName,tableName,cb) {
		connection.execute("\n            SELECT\n                column_name\n            FROM\n                INFORMATION_SCHEMA.columns\n            WHERE\n                LOWER(table_schema)=LOWER($1) AND\n                LOWER(table_name)=LOWER($2)",[schemaName,tableName],function(err,rows) {
			var cols = [];
			var _g = 0;
			while(_g < rows.length) {
				var row = rows[_g];
				++_g;
				cols.push(row.column_name);
			}
			cb(null,cols);
		});
	}
	,limitAtEndPosition: function() {
		return true;
	}
	,dbSpecificParamPlaceholder: function(i) {
		return "$" + i;
	}
	,generateLimitClause: function(limit) {
		return " LIMIT " + Std["int"](limit);
	}
	,columnToStringCommand: function(columnName) {
		return " cast(" + columnName + " as TEXT) ";
	}
	,_getConnection: function(cb) {
		var _gthis = this;
		var conString = "postgres://" + this.user.username + ":" + this.user.password + "@" + Std.string(this.config.host) + "/" + Std.string(this.config.database);
		var pg = js.Node.require("pg");
		pg.connect(conString,function(err,client) {
			if(err != null) {
				_gthis.debug("Error connecting to PostgreSQL");
				cb(err,null);
			} else {
				client.execute = function(sql,args,cb1) {
					client.query(sql,args,function(err1,results) {
						if(err1 == null) {
							cb1(null,results.rows);
						} else {
							cb1(err1,null);
						}
					});
				};
				cb(null,client);
			}
		});
	}
	,__class__: saturn.db.provider.PostgreSQLProvider
});
saturn.db.provider.SQLiteProvider = $hxClasses["saturn.db.provider.SQLiteProvider"] = function(models,config,autoClose) {
	saturn.db.provider.GenericRDBMSProvider.call(this,models,config,autoClose);
};
saturn.db.provider.SQLiteProvider.__name__ = ["saturn","db","provider","SQLiteProvider"];
saturn.db.provider.SQLiteProvider.__super__ = saturn.db.provider.GenericRDBMSProvider;
saturn.db.provider.SQLiteProvider.prototype = $extend(saturn.db.provider.GenericRDBMSProvider.prototype,{
	getProviderType: function() {
		return "SQLITE";
	}
	,getColumns: function(connection,schemaName,tableName,cb) {
		var _gthis = this;
		this.debug("Getting columns for " + tableName);
		connection.serialize(function() {
			connection.all("PRAGMA table_info(" + tableName + ")",[],function(err,rows) {
				if(err != null) {
					_gthis.debug("Got pragma exception on  " + tableName);
					cb(err,null);
				} else {
					var cols = [];
					var _g = 0;
					while(_g < rows.length) {
						var row = rows[_g];
						++_g;
						cols.push(row.name);
					}
					cb(null,cols);
				}
			});
		});
	}
	,generateQualifiedName: function(schemaName,tableName) {
		return tableName;
	}
	,_getConnection: function(cb) {
		try {
			var conn = new Sqlite3(this.config.file_name);
			this.debug("Got connection");
			conn.execute = conn.all;
			cb(null,conn);
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			this.debug("Error" + Std.string(e));
			cb(e,null);
		}
	}
	,limitAtEndPosition: function() {
		return true;
	}
	,generateLimitClause: function(limit) {
		return " limit " + Std["int"](limit);
	}
	,__class__: saturn.db.provider.SQLiteProvider
});
if(!saturn.db.provider.hooks) saturn.db.provider.hooks = {};
saturn.db.provider.hooks.ExternalJsonHook = $hxClasses["saturn.db.provider.hooks.ExternalJsonHook"] = function() { };
saturn.db.provider.hooks.ExternalJsonHook.__name__ = ["saturn","db","provider","hooks","ExternalJsonHook"];
saturn.db.provider.hooks.ExternalJsonHook.run = function(query,params,clazz,cb,hookConfig) {
	saturn.core.Util.debug("Running external command");
	if(hookConfig == null) {
		cb(null,"Hook configuration is missing");
		return;
	}
	var program = null;
	if(Reflect.hasField(hookConfig,"program")) {
		program = Reflect.field(hookConfig,"program");
	} else {
		cb(null,"Invalid configuration, program field missing");
		return;
	}
	var progArguments = [];
	if(Reflect.hasField(hookConfig,"arguments")) {
		var localprogArguments = Reflect.field(hookConfig,"arguments");
		var _g = 0;
		while(_g < localprogArguments.length) {
			var arg = localprogArguments[_g];
			++_g;
			progArguments.push(arg);
		}
	}
	var config = params[0];
	bindings.NodeTemp.open("input_json",function(err,fh_input) {
		if(err != null) {
			saturn.core.Util.debug("Error generating temporary input file name");
			cb(null,err);
		} else {
			var run = function() {
				var inputJsonStr = js.Node.get_json().stringify(config);
				js.Node.get_fs().writeFileSync(fh_input.path,inputJsonStr);
				bindings.NodeTemp.open("output_json",function(err1,fh_output) {
					if(err1 != null) {
						saturn.core.Util.debug("Error generating temporary output file name");
						cb(null,err1);
					} else {
						progArguments.push(fh_input.path);
						progArguments.push(fh_output.path);
						saturn.core.Util.inspect(progArguments);
						saturn.core.Util.print(program);
						var p = js.Node.get_child_process().spawn(program,progArguments);
						p.stderr.on("data",function(data) {
							saturn.core.Util.debug(data.toString());
						});
						p.stdout.on("data",function(data1) {
							saturn.core.Util.debug(data1.toString());
						});
						p.on("close",function(retVal) {
							if(retVal == "0") {
								var jsonStr = js.Node.get_fs().readFileSync(fh_output.path,{ encoding : "utf8"});
								js.Node.get_fs().unlinkSync(fh_output.path);
								js.Node.get_fs().unlinkSync(fh_input.path);
								var jsonObj = js.Node.get_json().parse(jsonStr);
								var error = null;
								if(Reflect.hasField(jsonObj,"error")) {
									error = Reflect.field(jsonObj,"error");
								}
								cb([jsonObj],error);
							} else {
								saturn.core.Util.debug("External process has failed");
								cb(null,"External process returned a non-zero exit status");
							}
						});
					}
				});
			};
			var fields = Reflect.fields(config);
			var next = null;
			next = function() {
				if(fields.length == 0) {
					run();
				} else {
					var field = fields.pop();
					if(field.indexOf("upload_key") == 0) {
						saturn.core.Util.debug("Found upload key");
						var saturn1 = saturn.app.SaturnServer.getDefaultServer();
						var redis = saturn1.getRedisClient();
						var upload_key = Reflect.field(config,field);
						var path = redis.get(upload_key,function(err2,path1) {
							if(path1 == null) {
								cb(null,"Invalid file upload key " + upload_key);
								return;
							} else {
								Reflect.setField(config,field,path1);
								next();
							}
						});
					} else if(field.indexOf("out_file") == 0) {
						var saturn2 = saturn.app.SaturnServer.getDefaultServer();
						var baseFolder = saturn2.getRelativePublicOuputFolder();
						Reflect.setField(config,field,baseFolder);
						next();
					} else {
						next();
					}
				}
			};
			next();
		}
	});
};
saturn.db.provider.hooks.RawSQLHook = $hxClasses["saturn.db.provider.hooks.RawSQLHook"] = function() { };
saturn.db.provider.hooks.RawSQLHook.__name__ = ["saturn","db","provider","hooks","RawSQLHook"];
saturn.db.provider.hooks.RawSQLHook.run = function(query,params,clazz,cb,hookConfig) {
	var sql = params[0];
	var args = params[1];
	saturn.core.Util.getProvider().getConnection(null,function(err,conn) {
		conn.execute(sql,args,function(err1,results) {
			cb(results,err1);
		});
	});
};
if(!saturn.db.query_lang) saturn.db.query_lang = {};
saturn.db.query_lang.Token = $hxClasses["saturn.db.query_lang.Token"] = function(tokens) {
	this.tokens = tokens;
	if(this.tokens != null) {
		var _g1 = 0;
		var _g = this.tokens.length;
		while(_g1 < _g) {
			var i = _g1++;
			var value = this.tokens[i];
			if(value != null) {
				if(!Std["is"](value,saturn.db.query_lang.Token)) {
					this.tokens[i] = new saturn.db.query_lang.Value(value);
				}
			}
		}
	}
};
saturn.db.query_lang.Token.__name__ = ["saturn","db","query_lang","Token"];
saturn.db.query_lang.Token.prototype = {
	tokens: null
	,name: null
	,'as': function(name) {
		this.name = name;
		return this;
	}
	,getTokens: function() {
		return this.tokens;
	}
	,setTokens: function(tokens) {
		this.tokens = tokens;
	}
	,addToken: function(token) {
		if(!Std["is"](token,saturn.db.query_lang.Token)) {
			token = new saturn.db.query_lang.Value(saturn.db.query_lang.Token);
		}
		if(this.tokens == null) {
			this.tokens = [];
		}
		this.tokens.push(token);
		return this;
	}
	,field: function(clazz,attributeName,clazzAlias) {
		var f = new saturn.db.query_lang.Field(clazz,attributeName,clazzAlias);
		this.add(f);
		return f;
	}
	,add: function(token) {
		if(Std["is"](token,saturn.db.query_lang.Operator)) {
			var n = new saturn.db.query_lang.Token();
			n.add(this);
			n.addToken(token);
			return n;
		} else {
			return this.addToken(token);
		}
	}
	,removeToken: function(token) {
		HxOverrides.remove(this.tokens,token);
	}
	,like: function(token) {
		var l = new saturn.db.query_lang.Like();
		if(token != null) {
			l.add(token);
		}
		return this.add(l);
	}
	,concat: function(token) {
		var c = new saturn.db.query_lang.Concat([this,token]);
		return c;
	}
	,substr: function(position,length) {
		return new saturn.db.query_lang.Substr(this,position,length);
	}
	,instr: function(substring,position,occurrence) {
		return new saturn.db.query_lang.Instr(this,substring,position,occurrence);
	}
	,max: function() {
		return new saturn.db.query_lang.Max(this);
	}
	,length: function() {
		return new saturn.db.query_lang.Length(this);
	}
	,plus: function(token) {
		var c = new saturn.db.query_lang.Plus(token);
		return this.add(c);
	}
	,minus: function(token) {
		var c = new saturn.db.query_lang.Minus(token);
		return this.add(c);
	}
	,getClassList: function() {
		var list = [];
		var tokens = this.getTokens();
		if(tokens != null && tokens.length > 0) {
			var _g = 0;
			while(_g < tokens.length) {
				var token = tokens[_g];
				++_g;
				if(Std["is"](token,saturn.db.query_lang.ClassToken)) {
					var cToken = js.Boot.__cast(token , saturn.db.query_lang.ClassToken);
					if(cToken.getClass() != null) {
						list.push(cToken.getClass());
					}
				} else {
					var list2 = token.getClassList();
					var _g1 = 0;
					while(_g1 < list2.length) {
						var item = list2[_g1];
						++_g1;
						list.push(item);
					}
				}
			}
		}
		return list;
	}
	,or: function() {
		this.add(new saturn.db.query_lang.Or());
	}
	,__class__: saturn.db.query_lang.Token
};
saturn.db.query_lang.Operator = $hxClasses["saturn.db.query_lang.Operator"] = function(token) {
	if(token != null) {
		saturn.db.query_lang.Token.call(this,[token]);
	} else {
		saturn.db.query_lang.Token.call(this,null);
	}
};
saturn.db.query_lang.Operator.__name__ = ["saturn","db","query_lang","Operator"];
saturn.db.query_lang.Operator.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.Operator.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.Operator
});
saturn.db.query_lang.And = $hxClasses["saturn.db.query_lang.And"] = function() {
	saturn.db.query_lang.Operator.call(this,null);
};
saturn.db.query_lang.And.__name__ = ["saturn","db","query_lang","And"];
saturn.db.query_lang.And.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.And.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.And
});
saturn.db.query_lang.Function = $hxClasses["saturn.db.query_lang.Function"] = function(tokens) {
	saturn.db.query_lang.Token.call(this,tokens);
};
saturn.db.query_lang.Function.__name__ = ["saturn","db","query_lang","Function"];
saturn.db.query_lang.Function.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.Function.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.Function
});
saturn.db.query_lang.Cast = $hxClasses["saturn.db.query_lang.Cast"] = function(expression,type) {
	saturn.db.query_lang.Function.call(this,[expression,type]);
};
saturn.db.query_lang.Cast.__name__ = ["saturn","db","query_lang","Cast"];
saturn.db.query_lang.Cast.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.Cast.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.Cast
});
saturn.db.query_lang.CastAsInt = $hxClasses["saturn.db.query_lang.CastAsInt"] = function(token) {
	saturn.db.query_lang.Function.call(this,[token]);
};
saturn.db.query_lang.CastAsInt.__name__ = ["saturn","db","query_lang","CastAsInt"];
saturn.db.query_lang.CastAsInt.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.CastAsInt.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.CastAsInt
});
saturn.db.query_lang.ClassToken = $hxClasses["saturn.db.query_lang.ClassToken"] = function(clazz) {
	this.setClass(clazz);
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.ClassToken.__name__ = ["saturn","db","query_lang","ClassToken"];
saturn.db.query_lang.ClassToken.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.ClassToken.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	clazz: null
	,getClass: function() {
		return this.clazz;
	}
	,setClass: function(clazz) {
		if(Std["is"](clazz,Class)) {
			var c = js.Boot.__cast(clazz , Class);
			this.clazz = Type.getClassName(c);
		} else {
			this.clazz = clazz;
		}
	}
	,__class__: saturn.db.query_lang.ClassToken
});
saturn.db.query_lang.Concat = $hxClasses["saturn.db.query_lang.Concat"] = function(tokens) {
	saturn.db.query_lang.Function.call(this,tokens);
};
saturn.db.query_lang.Concat.__name__ = ["saturn","db","query_lang","Concat"];
saturn.db.query_lang.Concat.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.Concat.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.Concat
});
saturn.db.query_lang.ConcatOperator = $hxClasses["saturn.db.query_lang.ConcatOperator"] = function(token) {
	saturn.db.query_lang.Operator.call(this,token);
};
saturn.db.query_lang.ConcatOperator.__name__ = ["saturn","db","query_lang","ConcatOperator"];
saturn.db.query_lang.ConcatOperator.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.ConcatOperator.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.ConcatOperator
});
saturn.db.query_lang.Count = $hxClasses["saturn.db.query_lang.Count"] = function(token) {
	saturn.db.query_lang.Function.call(this,[token]);
};
saturn.db.query_lang.Count.__name__ = ["saturn","db","query_lang","Count"];
saturn.db.query_lang.Count.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.Count.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.Count
});
saturn.db.query_lang.EndBlock = $hxClasses["saturn.db.query_lang.EndBlock"] = function() {
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.EndBlock.__name__ = ["saturn","db","query_lang","EndBlock"];
saturn.db.query_lang.EndBlock.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.EndBlock.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.EndBlock
});
saturn.db.query_lang.Equals = $hxClasses["saturn.db.query_lang.Equals"] = function(token) {
	saturn.db.query_lang.Operator.call(this,token);
};
saturn.db.query_lang.Equals.__name__ = ["saturn","db","query_lang","Equals"];
saturn.db.query_lang.Equals.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.Equals.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.Equals
});
saturn.db.query_lang.Field = $hxClasses["saturn.db.query_lang.Field"] = function(clazz,attributeName,clazzAlias) {
	this.setClass(clazz);
	this.attributeName = attributeName;
	this.clazzAlias = clazzAlias;
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.Field.__name__ = ["saturn","db","query_lang","Field"];
saturn.db.query_lang.Field.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.Field.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	clazz: null
	,clazzAlias: null
	,attributeName: null
	,getClass: function() {
		return this.clazz;
	}
	,setClass: function(clazz) {
		if(Std["is"](clazz,Class)) {
			var c = js.Boot.__cast(clazz , Class);
			this.clazz = Type.getClassName(c);
		} else {
			this.clazz = clazz;
		}
	}
	,getAttributeName: function() {
		return this.attributeName;
	}
	,setAttributeName: function(name) {
		this.attributeName = name;
	}
	,__class__: saturn.db.query_lang.Field
});
saturn.db.query_lang.From = $hxClasses["saturn.db.query_lang.From"] = function() {
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.From.__name__ = ["saturn","db","query_lang","From"];
saturn.db.query_lang.From.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.From.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.From
});
saturn.db.query_lang.GreaterThan = $hxClasses["saturn.db.query_lang.GreaterThan"] = function(token) {
	saturn.db.query_lang.Operator.call(this,token);
};
saturn.db.query_lang.GreaterThan.__name__ = ["saturn","db","query_lang","GreaterThan"];
saturn.db.query_lang.GreaterThan.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.GreaterThan.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.GreaterThan
});
saturn.db.query_lang.GreaterThanOrEqualTo = $hxClasses["saturn.db.query_lang.GreaterThanOrEqualTo"] = function(token) {
	saturn.db.query_lang.Operator.call(this,token);
};
saturn.db.query_lang.GreaterThanOrEqualTo.__name__ = ["saturn","db","query_lang","GreaterThanOrEqualTo"];
saturn.db.query_lang.GreaterThanOrEqualTo.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.GreaterThanOrEqualTo.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.GreaterThanOrEqualTo
});
saturn.db.query_lang.Group = $hxClasses["saturn.db.query_lang.Group"] = function() {
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.Group.__name__ = ["saturn","db","query_lang","Group"];
saturn.db.query_lang.Group.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.Group.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.Group
});
saturn.db.query_lang.In = $hxClasses["saturn.db.query_lang.In"] = function(token) {
	saturn.db.query_lang.Operator.call(this,token);
};
saturn.db.query_lang.In.__name__ = ["saturn","db","query_lang","In"];
saturn.db.query_lang.In.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.In.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.In
});
saturn.db.query_lang.Instr = $hxClasses["saturn.db.query_lang.Instr"] = function(value,substring,position,occurrence) {
	if(position == null) {
		position = new saturn.db.query_lang.Value(1);
	}
	if(occurrence == null) {
		occurrence = new saturn.db.query_lang.Value(1);
	}
	saturn.db.query_lang.Function.call(this,[value,substring,position,occurrence]);
};
saturn.db.query_lang.Instr.__name__ = ["saturn","db","query_lang","Instr"];
saturn.db.query_lang.Instr.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.Instr.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.Instr
});
saturn.db.query_lang.IsNotNull = $hxClasses["saturn.db.query_lang.IsNotNull"] = function() {
	saturn.db.query_lang.Operator.call(this,null);
};
saturn.db.query_lang.IsNotNull.__name__ = ["saturn","db","query_lang","IsNotNull"];
saturn.db.query_lang.IsNotNull.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.IsNotNull.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.IsNotNull
});
saturn.db.query_lang.IsNull = $hxClasses["saturn.db.query_lang.IsNull"] = function() {
	this.empty = "NULL";
	saturn.db.query_lang.Operator.call(this,null);
};
saturn.db.query_lang.IsNull.__name__ = ["saturn","db","query_lang","IsNull"];
saturn.db.query_lang.IsNull.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.IsNull.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	empty: null
	,__class__: saturn.db.query_lang.IsNull
});
saturn.db.query_lang.Length = $hxClasses["saturn.db.query_lang.Length"] = function(value) {
	saturn.db.query_lang.Function.call(this,[value]);
};
saturn.db.query_lang.Length.__name__ = ["saturn","db","query_lang","Length"];
saturn.db.query_lang.Length.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.Length.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.Length
});
saturn.db.query_lang.LessThan = $hxClasses["saturn.db.query_lang.LessThan"] = function(token) {
	saturn.db.query_lang.Operator.call(this,token);
};
saturn.db.query_lang.LessThan.__name__ = ["saturn","db","query_lang","LessThan"];
saturn.db.query_lang.LessThan.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.LessThan.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.LessThan
});
saturn.db.query_lang.LessThanOrEqualTo = $hxClasses["saturn.db.query_lang.LessThanOrEqualTo"] = function(token) {
	saturn.db.query_lang.Operator.call(this,token);
};
saturn.db.query_lang.LessThanOrEqualTo.__name__ = ["saturn","db","query_lang","LessThanOrEqualTo"];
saturn.db.query_lang.LessThanOrEqualTo.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.LessThanOrEqualTo.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.LessThanOrEqualTo
});
saturn.db.query_lang.Like = $hxClasses["saturn.db.query_lang.Like"] = function() {
	saturn.db.query_lang.Operator.call(this,null);
};
saturn.db.query_lang.Like.__name__ = ["saturn","db","query_lang","Like"];
saturn.db.query_lang.Like.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.Like.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.Like
});
saturn.db.query_lang.Limit = $hxClasses["saturn.db.query_lang.Limit"] = function(limit) {
	saturn.db.query_lang.Token.call(this,[limit]);
};
saturn.db.query_lang.Limit.__name__ = ["saturn","db","query_lang","Limit"];
saturn.db.query_lang.Limit.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.Limit.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.Limit
});
saturn.db.query_lang.Max = $hxClasses["saturn.db.query_lang.Max"] = function(value) {
	saturn.db.query_lang.Function.call(this,[value]);
};
saturn.db.query_lang.Max.__name__ = ["saturn","db","query_lang","Max"];
saturn.db.query_lang.Max.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.Max.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.Max
});
saturn.db.query_lang.Minus = $hxClasses["saturn.db.query_lang.Minus"] = function(value) {
	if(value == null) {
		saturn.db.query_lang.Operator.call(this,null);
	} else {
		saturn.db.query_lang.Operator.call(this,value);
	}
};
saturn.db.query_lang.Minus.__name__ = ["saturn","db","query_lang","Minus"];
saturn.db.query_lang.Minus.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.Minus.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.Minus
});
saturn.db.query_lang.NotEquals = $hxClasses["saturn.db.query_lang.NotEquals"] = function(token) {
	saturn.db.query_lang.Operator.call(this,token);
};
saturn.db.query_lang.NotEquals.__name__ = ["saturn","db","query_lang","NotEquals"];
saturn.db.query_lang.NotEquals.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.NotEquals.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.NotEquals
});
saturn.db.query_lang.Or = $hxClasses["saturn.db.query_lang.Or"] = function() {
	saturn.db.query_lang.Operator.call(this,null);
};
saturn.db.query_lang.Or.__name__ = ["saturn","db","query_lang","Or"];
saturn.db.query_lang.Or.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.Or.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.Or
});
saturn.db.query_lang.OrderBy = $hxClasses["saturn.db.query_lang.OrderBy"] = function() {
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.OrderBy.__name__ = ["saturn","db","query_lang","OrderBy"];
saturn.db.query_lang.OrderBy.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.OrderBy.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.OrderBy
});
saturn.db.query_lang.OrderByItem = $hxClasses["saturn.db.query_lang.OrderByItem"] = function(token,descending) {
	if(descending == null) {
		descending = false;
	}
	this.descending = false;
	this.descending = descending;
	saturn.db.query_lang.Token.call(this,[token]);
};
saturn.db.query_lang.OrderByItem.__name__ = ["saturn","db","query_lang","OrderByItem"];
saturn.db.query_lang.OrderByItem.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.OrderByItem.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	descending: null
	,__class__: saturn.db.query_lang.OrderByItem
});
saturn.db.query_lang.Plus = $hxClasses["saturn.db.query_lang.Plus"] = function(value) {
	if(value == null) {
		saturn.db.query_lang.Operator.call(this,null);
	} else {
		saturn.db.query_lang.Operator.call(this,value);
	}
};
saturn.db.query_lang.Plus.__name__ = ["saturn","db","query_lang","Plus"];
saturn.db.query_lang.Plus.__super__ = saturn.db.query_lang.Operator;
saturn.db.query_lang.Plus.prototype = $extend(saturn.db.query_lang.Operator.prototype,{
	__class__: saturn.db.query_lang.Plus
});
saturn.db.query_lang.Query = $hxClasses["saturn.db.query_lang.Query"] = function(provider) {
	saturn.db.query_lang.Token.call(this,null);
	this.provider = provider;
	this.selectToken = new saturn.db.query_lang.Select();
	this.whereToken = new saturn.db.query_lang.Where();
	this.fromToken = new saturn.db.query_lang.From();
	this.groupToken = new saturn.db.query_lang.Group();
	this.orderToken = new saturn.db.query_lang.OrderBy();
};
saturn.db.query_lang.Query.__name__ = ["saturn","db","query_lang","Query"];
saturn.db.query_lang.Query.deserialise = function(querySer) {
	var clone = haxe.Unserializer.run(querySer);
	saturn.db.query_lang.Query.deserialiseToken(clone);
	return clone;
};
saturn.db.query_lang.Query.deserialiseToken = function(token) {
	if(token == null) {
		return;
	}
	if(token.getTokens() != null) {
		var _g = 0;
		var _g1 = token.getTokens();
		while(_g < _g1.length) {
			var token1 = _g1[_g];
			++_g;
			saturn.db.query_lang.Query.deserialiseToken(token1);
		}
	}
	if(Std["is"](token,saturn.db.query_lang.Query)) {
		var qToken = js.Boot.__cast(token , saturn.db.query_lang.Query);
		qToken.provider = null;
	}
};
saturn.db.query_lang.Query.startsWith = function(value) {
	var t = new saturn.db.query_lang.Like();
	t.add(new saturn.db.query_lang.Value(value).concat("%"));
	return t;
};
saturn.db.query_lang.Query.getByExample = function(provider,example,cb) {
	var q = new saturn.db.query_lang.Query(provider);
	q.addExample(example);
	q.run(cb);
	return q;
};
saturn.db.query_lang.Query.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.Query.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	selectToken: null
	,fromToken: null
	,whereToken: null
	,groupToken: null
	,orderToken: null
	,provider: null
	,rawResults: null
	,pageOn: null
	,pageSize: null
	,lastPagedRowValue: null
	,results: null
	,error: null
	,setPageOnToken: function(t) {
		this.pageOn = t;
	}
	,getPageOnToken: function() {
		return this.pageOn;
	}
	,setLastPagedRowValue: function(t) {
		this.lastPagedRowValue = t;
	}
	,getLastPagedRowValue: function() {
		return this.lastPagedRowValue;
	}
	,setPageSize: function(t) {
		this.pageSize = t;
	}
	,getPageSize: function() {
		return this.pageSize;
	}
	,isPaging: function() {
		if(this.pageOn != null) {
			return this.pageSize != null;
		} else {
			return false;
		}
	}
	,configurePaging: function(pageOn,pageSize) {
		this.pageOn = pageOn;
		this.pageSize = pageSize;
	}
	,fetchRawResults: function() {
		this.rawResults = true;
	}
	,bindResults: function() {
		return !this.rawResults;
	}
	,getTokens: function() {
		var tokens = [];
		var checkTokens = [this.selectToken,this.whereToken];
		var _g = 0;
		while(_g < checkTokens.length) {
			var token = checkTokens[_g];
			++_g;
			this.addClassToken(token);
		}
		if(this.fromToken.getTokens() != null) {
			var seen = new haxe.ds.StringMap();
			var tokens1 = [];
			var _g1 = 0;
			var _g11 = this.fromToken.getTokens();
			while(_g1 < _g11.length) {
				var token1 = _g11[_g1];
				++_g1;
				if(Std["is"](token1,saturn.db.query_lang.ClassToken)) {
					var cToken = js.Boot.__cast(token1 , saturn.db.query_lang.ClassToken);
					if(cToken.getClass() != null) {
						var clazzName = cToken.getClass();
						if(!seen.exists(clazzName)) {
							tokens1.push(cToken);
							seen.set(clazzName,"");
						}
					} else {
						tokens1.push(cToken);
					}
				} else {
					tokens1.push(token1);
				}
			}
			this.fromToken.setTokens(tokens1);
			saturn.core.Util.print("Num targets" + this.fromToken.getTokens().length);
		}
		tokens.push(this.selectToken);
		tokens.push(this.fromToken);
		if(this.whereToken.getTokens() != null && this.whereToken.getTokens().length > 0) {
			tokens.push(this.whereToken);
			if(this.isPaging() && this.lastPagedRowValue != null) {
				tokens.push(new saturn.db.query_lang.And());
				tokens.push(this.pageOn);
				tokens.push(new saturn.db.query_lang.GreaterThan());
				tokens.push(this.lastPagedRowValue);
			}
		}
		if(this.groupToken.getTokens() != null && this.groupToken.getTokens().length > 0) {
			tokens.push(this.groupToken);
		}
		if(this.orderToken.getTokens() != null && this.orderToken.getTokens().length > 0) {
			tokens.push(this.orderToken);
		}
		if(this.isPaging()) {
			tokens.push(new saturn.db.query_lang.OrderBy());
			tokens.push(new saturn.db.query_lang.OrderByItem(this.pageOn));
			tokens.push(new saturn.db.query_lang.Limit(this.pageSize));
		}
		if(this.tokens != null && this.tokens.length > 0) {
			var _g2 = 0;
			var _g12 = this.tokens;
			while(_g2 < _g12.length) {
				var token2 = _g12[_g2];
				++_g2;
				tokens.push(token2);
			}
		}
		return tokens;
	}
	,or: function() {
		this.getWhere().addToken(new saturn.db.query_lang.Or());
	}
	,and: function() {
		this.getWhere().addToken(new saturn.db.query_lang.And());
	}
	,equals: function(clazz,field,value) {
		this.getWhere().addToken(new saturn.db.query_lang.Field(clazz,field));
		this.getWhere().addToken(new saturn.db.query_lang.Equals());
		this.getWhere().addToken(new saturn.db.query_lang.Value(value));
	}
	,select: function(clazz,field) {
		this.getSelect().addToken(new saturn.db.query_lang.Field(clazz,field));
	}
	,getSelect: function() {
		return this.selectToken;
	}
	,getFrom: function() {
		return this.fromToken;
	}
	,getWhere: function() {
		return this.whereToken;
	}
	,getGroup: function() {
		return this.groupToken;
	}
	,clone: function() {
		var str = this.serialise();
		return saturn.db.query_lang.Query.deserialise(str);
	}
	,serialise: function() {
		var keepMe = this.provider;
		this.provider = null;
		var newMe = haxe.Serializer.run(this);
		this.provider = keepMe;
		return newMe;
	}
	,__getstate__: function() {
		var state = Syntax.pythonCode("dict(self.__dict__)");
		Syntax.pythonCode("del state['provider']");
		return state;
	}
	,run: function(cb) {
		var _gthis = this;
		var clone = this.clone();
		clone.provider = null;
		clone.getTokens();
		this.provider.query(clone,function(objs,err) {
			if(err == null && objs.length > 0 && _gthis.isPaging()) {
				var fieldName = null;
				if(_gthis.pageOn.name != null) {
					fieldName = _gthis.pageOn.name;
				} else if(Std["is"](_gthis.pageOn,saturn.db.query_lang.Field)) {
					var fToken = js.Boot.__cast(_gthis.pageOn , saturn.db.query_lang.Field);
					fieldName = fToken.getAttributeName();
				}
				if(fieldName == null) {
					err = "Unable to determine value of last paged row";
				} else {
					var tmp = Reflect.field(objs[objs.length - 1],fieldName);
					_gthis.setLastPagedRowValue(new saturn.db.query_lang.Value(tmp));
				}
			}
			_gthis.results = objs;
			_gthis.error = err;
			if(cb != null) {
				cb(objs,err);
			}
		});
	}
	,getSelectClassList: function() {
		var set = new haxe.ds.StringMap();
		var _g = 0;
		var _g1 = this.selectToken.getTokens();
		while(_g < _g1.length) {
			var token = _g1[_g];
			++_g;
			if(Std["is"](token,saturn.db.query_lang.Field)) {
				var cToken = js.Boot.__cast(token , saturn.db.query_lang.Field);
				var clazz = cToken.getClass();
				if(clazz != null) {
					set.set(clazz,clazz);
				}
			}
		}
		var list = [];
		var className = set.keys();
		while(className.hasNext()) {
			var className1 = className.next();
			list.push(set.get(className1));
		}
		return list;
	}
	,unbindFields: function(token) {
		if(token == null) {
			return;
		}
		if(Std["is"](token,saturn.db.query_lang.Field)) {
			var cToken = js.Boot.__cast(token , saturn.db.query_lang.Field);
			var clazz = cToken.getClass();
			var field = cToken.getAttributeName();
			var model = this.provider.getModelByStringName(clazz);
			if(model != null) {
				if(field != "*") {
					var unboundFieldName = model.unbindFieldName(field);
					cToken.setAttributeName(unboundFieldName);
				}
			}
		}
		if(token.getTokens() != null) {
			var _g = 0;
			var _g1 = token.getTokens();
			while(_g < _g1.length) {
				var token1 = _g1[_g];
				++_g;
				this.unbindFields(token1);
			}
		}
	}
	,addClassToken: function(token) {
		if(Std["is"](token,saturn.db.query_lang.Query) || token == null) {
			return;
		}
		if(Std["is"](token,saturn.db.query_lang.Field)) {
			var fToken = js.Boot.__cast(token , saturn.db.query_lang.Field);
			if(fToken.getClass() != null) {
				var cToken = new saturn.db.query_lang.ClassToken(fToken.getClass());
				if(fToken.clazzAlias != null) {
					cToken.name = fToken.clazzAlias;
				}
				this.fromToken.addToken(cToken);
			}
		}
		if(token.getTokens() != null) {
			var _g = 0;
			var _g1 = token.getTokens();
			while(_g < _g1.length) {
				var token1 = _g1[_g];
				++_g;
				this.addClassToken(token1);
			}
		}
	}
	,addExample: function(obj,fieldList) {
		var clazz = Type.getClass(obj);
		var model = this.provider.getModel(clazz);
		if(fieldList != null) {
			if(fieldList.length > 0) {
				var _g = 0;
				while(_g < fieldList.length) {
					var field = fieldList[_g];
					++_g;
					this.getSelect().addToken(new saturn.db.query_lang.Field(clazz,field));
				}
			}
		} else {
			this.getSelect().addToken(new saturn.db.query_lang.Field(clazz,"*"));
		}
		var fields = model.getAttributes();
		var hasPrevious = false;
		this.getWhere().addToken(new saturn.db.query_lang.StartBlock());
		var _g1 = 0;
		var _g2 = fields.length;
		while(_g1 < _g2) {
			var i = _g1++;
			var field1 = fields[i];
			var value = Reflect.field(obj,field1);
			if(value != null) {
				if(hasPrevious) {
					this.getWhere().addToken(new saturn.db.query_lang.And());
				}
				var fieldToken = new saturn.db.query_lang.Field(clazz,field1);
				this.getWhere().addToken(fieldToken);
				if(Std["is"](value,saturn.db.query_lang.IsNull)) {
					saturn.core.Util.print("Found NULL");
					this.getWhere().addToken(new saturn.db.query_lang.IsNull());
				} else if(Std["is"](value,saturn.db.query_lang.IsNotNull)) {
					this.getWhere().addToken(new saturn.db.query_lang.IsNotNull());
				} else if(Std["is"](value,saturn.db.query_lang.Operator)) {
					this.getWhere().addToken(value);
				} else {
					this.getWhere().addToken(new saturn.db.query_lang.Equals());
					if(Std["is"](value,saturn.db.query_lang.Token)) {
						this.getWhere().addToken(value);
					} else {
						saturn.core.Util.print("Found value" + Type.getClassName(Type.getClass(value)));
						this.getWhere().addToken(new saturn.db.query_lang.Value(value));
					}
				}
				hasPrevious = true;
			}
		}
		this.getWhere().addToken(new saturn.db.query_lang.EndBlock());
	}
	,getResults: function() {
		return this.results;
	}
	,hasResults: function() {
		if(this.results != null) {
			return this.results.length > 0;
		} else {
			return false;
		}
	}
	,getError: function() {
		return this.error;
	}
	,__class__: saturn.db.query_lang.Query
});
saturn.db.query_lang.QueryTests = $hxClasses["saturn.db.query_lang.QueryTests"] = function() {
};
saturn.db.query_lang.QueryTests.__name__ = ["saturn","db","query_lang","QueryTests"];
saturn.db.query_lang.QueryTests.prototype = {
	test1: function() {
		var query = new saturn.db.query_lang.Query(saturn.core.Util.getProvider());
		query.getSelect().addToken(new saturn.db.query_lang.Field(saturn.core.domain.SgcAllele,"alleleId",null));
		var visitor = new saturn.db.query_lang.SQLVisitor(saturn.core.Util.getProvider());
		visitor.translate(query);
	}
	,__class__: saturn.db.query_lang.QueryTests
};
saturn.db.query_lang.QueryVisitor = $hxClasses["saturn.db.query_lang.QueryVisitor"] = function() { };
saturn.db.query_lang.QueryVisitor.__name__ = ["saturn","db","query_lang","QueryVisitor"];
saturn.db.query_lang.QueryVisitor.prototype = {
	translateQuery: null
	,__class__: saturn.db.query_lang.QueryVisitor
};
saturn.db.query_lang.RegexpLike = $hxClasses["saturn.db.query_lang.RegexpLike"] = function(field,expression) {
	saturn.db.query_lang.Function.call(this,[field,expression]);
};
saturn.db.query_lang.RegexpLike.__name__ = ["saturn","db","query_lang","RegexpLike"];
saturn.db.query_lang.RegexpLike.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.RegexpLike.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.RegexpLike
});
saturn.db.query_lang.SQLVisitor = $hxClasses["saturn.db.query_lang.SQLVisitor"] = function(provider,valPos,aliasToGenerated,nextAliasId) {
	if(nextAliasId == null) {
		nextAliasId = 0;
	}
	if(valPos == null) {
		valPos = 1;
	}
	this.provider = provider;
	this.values = [];
	this.valPos = valPos;
	if(aliasToGenerated == null) {
		this.aliasToGenerated = new haxe.ds.StringMap();
	} else {
		this.aliasToGenerated = aliasToGenerated;
	}
	this.nextAliasId = nextAliasId;
};
saturn.db.query_lang.SQLVisitor.__name__ = ["saturn","db","query_lang","SQLVisitor"];
saturn.db.query_lang.SQLVisitor.prototype = {
	provider: null
	,values: null
	,valPos: null
	,nextAliasId: null
	,aliasToGenerated: null
	,generatedToAlias: null
	,generateId: function(alias,baseValue) {
		if(baseValue == null) {
			baseValue = "ALIAS_";
		}
		if(this.aliasToGenerated.exists(alias)) {
			return this.aliasToGenerated.get(alias);
		}
		this.nextAliasId++;
		var id = baseValue + this.nextAliasId;
		this.aliasToGenerated.set(alias,id);
		saturn.core.Util.debug("Mapping" + alias + " to  " + id);
		return id;
	}
	,getNextValuePosition: function() {
		return this.valPos;
	}
	,getNextAliasId: function() {
		return this.nextAliasId;
	}
	,getValues: function() {
		return this.values;
	}
	,translate: function(token) {
		var sqlTranslation = "";
		if(token != null) {
			if(Std["is"](token,saturn.db.query_lang.Query)) {
				var query = js.Boot.__cast(token , saturn.db.query_lang.Query);
				this.postProcess(query);
				var sqlQuery = "";
				var tokens = query.getTokens();
				var _g = 0;
				while(_g < tokens.length) {
					var token1 = tokens[_g];
					++_g;
					sqlTranslation += Std.string(this.translate(token1));
				}
			} else {
				var nestedTranslation = "";
				if(token.getTokens() != null) {
					var tokenTranslations = [];
					if(Std["is"](token,saturn.db.query_lang.Instr)) {
						if(this.provider.getProviderType() == "SQLITE" || this.provider.getProviderType() == "MYSQL") {
							token.tokens.pop();
							token.tokens.pop();
						}
					}
					var _g1 = 0;
					var _g11 = token.getTokens();
					while(_g1 < _g11.length) {
						var token2 = _g11[_g1];
						++_g1;
						if(Std["is"](token2,saturn.db.query_lang.Query)) {
							var subVisitor = new saturn.db.query_lang.SQLVisitor(this.provider,this.valPos,this.aliasToGenerated,this.nextAliasId);
							this.valPos = subVisitor.getNextValuePosition();
							this.nextAliasId = subVisitor.getNextAliasId();
							var generatedAlias = "";
							if(token2.name != null && token2.name != "") {
								generatedAlias = this.generateId(token2.name);
							}
							tokenTranslations.push("(" + Std.string(subVisitor.translate(token2)) + ") " + generatedAlias + " ");
							var _g2 = 0;
							var _g3 = subVisitor.getValues();
							while(_g2 < _g3.length) {
								var value = _g3[_g2];
								++_g2;
								this.values.push(value);
							}
						} else {
							tokenTranslations.push(this.translate(token2));
						}
					}
					var joinSep = " ";
					if(Std["is"](token,saturn.db.query_lang.Select) || Std["is"](token,saturn.db.query_lang.From) || Std["is"](token,saturn.db.query_lang.Function) || Std["is"](token,saturn.db.query_lang.Group) || Std["is"](token,saturn.db.query_lang.OrderBy)) {
						joinSep = ",";
					}
					nestedTranslation = tokenTranslations.join(joinSep);
				}
				if(Std["is"](token,saturn.db.query_lang.Value)) {
					var cToken = js.Boot.__cast(token , saturn.db.query_lang.Value);
					this.values.push(cToken.getValue());
					sqlTranslation += " " + this.getParameterNotation(this.valPos++) + " " + nestedTranslation + " ";
				} else if(Std["is"](token,saturn.db.query_lang.Function)) {
					if(Std["is"](token,saturn.db.query_lang.Trim)) {
						if(this.provider.getProviderType() == "SQLITE") {
							sqlTranslation += "ltrim(" + nestedTranslation + ",'0'" + ")";
						} else {
							sqlTranslation += "Trim( leading '0' from " + nestedTranslation + ")";
						}
					} else {
						var funcName = "";
						var specialCastAsInt = false;
						if(Std["is"](token,saturn.db.query_lang.Max)) {
							funcName = "MAX";
						} else if(Std["is"](token,saturn.db.query_lang.Count)) {
							funcName = "COUNT";
						} else if(Std["is"](token,saturn.db.query_lang.Instr)) {
							funcName = "INSTR";
						} else if(Std["is"](token,saturn.db.query_lang.Substr)) {
							funcName = "SUBSTR";
						} else if(Std["is"](token,saturn.db.query_lang.Length)) {
							funcName = "LENGTH";
						} else if(Std["is"](token,saturn.db.query_lang.Concat)) {
							funcName = "CONCAT";
						} else if(Std["is"](token,saturn.db.query_lang.RegexpLike)) {
							funcName = "REGEXP_LIKE";
						} else if(Std["is"](token,saturn.db.query_lang.ToNumber)) {
							if(this.provider.getProviderType() == "MYSQL") {
								funcName = "cast";
								specialCastAsInt = true;
							} else {
								funcName = "to_number";
							}
						} else if(Std["is"](token,saturn.db.query_lang.CastAsInt)) {
							funcName = "cast";
							specialCastAsInt = true;
						}
						if(!specialCastAsInt) {
							sqlTranslation += funcName + "( " + nestedTranslation + " )";
						} else {
							sqlTranslation += funcName + "( " + nestedTranslation + " as int)";
						}
					}
				} else if(Std["is"](token,saturn.db.query_lang.Select)) {
					sqlTranslation += " SELECT " + nestedTranslation;
				} else if(Std["is"](token,saturn.db.query_lang.Field)) {
					var cToken1 = js.Boot.__cast(token , saturn.db.query_lang.Field);
					var clazzName = cToken1.getClass();
					var fieldPrefix = null;
					var fieldName = null;
					if(cToken1.clazzAlias != null) {
						fieldPrefix = this.generateId(cToken1.clazzAlias);
					}
					if(clazzName != null) {
						var model = this.provider.getModelByStringName(clazzName);
						fieldName = model.getSqlColumn(cToken1.getAttributeName());
						if(fieldPrefix == null) {
							var tableName = model.getTableName();
							var schemaName = model.getSchemaName();
							fieldPrefix = this.provider.generateQualifiedName(schemaName,tableName);
						}
					} else {
						fieldName = this.generateId(cToken1.attributeName);
					}
					if(cToken1.getAttributeName() == "*") {
						sqlTranslation += fieldPrefix + ".*";
					} else {
						sqlTranslation += fieldPrefix + "." + fieldName;
					}
					sqlTranslation += " " + nestedTranslation + " ";
				} else if(Std["is"](token,saturn.db.query_lang.Where)) {
					sqlTranslation += " WHERE " + nestedTranslation;
				} else if(Std["is"](token,saturn.db.query_lang.Group)) {
					sqlTranslation += " GROUP BY " + nestedTranslation;
				} else if(Std["is"](token,saturn.db.query_lang.From)) {
					sqlTranslation += " FROM " + nestedTranslation;
				} else if(Std["is"](token,saturn.db.query_lang.OrderBy)) {
					sqlTranslation += " ORDER BY " + nestedTranslation;
				} else if(Std["is"](token,saturn.db.query_lang.OrderByItem)) {
					var oToken = js.Boot.__cast(token , saturn.db.query_lang.OrderByItem);
					var direction = "ASC";
					if(oToken.descending) {
						direction = "DESC";
					}
					sqlTranslation += nestedTranslation + " " + direction;
				} else if(Std["is"](token,saturn.db.query_lang.ClassToken)) {
					var cToken2 = js.Boot.__cast(token , saturn.db.query_lang.ClassToken);
					var model1 = this.provider.getModelByStringName(cToken2.getClass());
					var tableName1 = model1.getTableName();
					var schemaName1 = model1.getSchemaName();
					var name = this.provider.generateQualifiedName(schemaName1,tableName1);
					sqlTranslation += " " + name + " ";
				} else if(Std["is"](token,saturn.db.query_lang.Operator)) {
					if(Std["is"](token,saturn.db.query_lang.And)) {
						sqlTranslation += " AND " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.Plus)) {
						sqlTranslation += " + " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.Minus)) {
						sqlTranslation += " - " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.Or)) {
						sqlTranslation += " OR " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.Equals)) {
						sqlTranslation += " = " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.IsNull)) {
						sqlTranslation += " IS NULL " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.IsNotNull)) {
						sqlTranslation += " IS NOT NULL " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.GreaterThan)) {
						sqlTranslation += " > " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.GreaterThanOrEqualTo)) {
						sqlTranslation += " >= " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.LessThan)) {
						sqlTranslation += " < " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.LessThanOrEqualTo)) {
						sqlTranslation += " <= " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.In)) {
						sqlTranslation += " IN " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.Concat)) {
						sqlTranslation += " || " + nestedTranslation;
					} else if(Std["is"](token,saturn.db.query_lang.Like)) {
						sqlTranslation += " LIKE " + nestedTranslation;
					}
				} else if(Std["is"](token,saturn.db.query_lang.ValueList)) {
					var cToken3 = js.Boot.__cast(token , saturn.db.query_lang.ValueList);
					var values = cToken3.getValues();
					var itemStrings = [];
					var _g12 = 0;
					var _g4 = values.length;
					while(_g12 < _g4) {
						var i = _g12++;
						itemStrings.push(this.getParameterNotation(this.valPos++));
						values.push(values[i]);
					}
					sqlTranslation += " ( " + itemStrings.join(",") + " ) ";
				} else if(Std["is"](token,saturn.db.query_lang.Limit)) {
					var cToken4 = js.Boot.__cast(token , saturn.db.query_lang.Limit);
					sqlTranslation += this.getLimitClause(nestedTranslation);
				} else if(Std["is"](token,saturn.db.query_lang.StartBlock)) {
					sqlTranslation += " ( ";
				} else if(Std["is"](token,saturn.db.query_lang.EndBlock)) {
					sqlTranslation += " ) ";
				} else {
					sqlTranslation += " " + nestedTranslation + " ";
				}
			}
		}
		if(token != null && token.name != null && !Std["is"](token,saturn.db.query_lang.Query)) {
			var generatedAlias1 = this.generateId(token.name);
			sqlTranslation += "  \"" + generatedAlias1 + "\"";
		}
		return sqlTranslation;
	}
	,getProcessedResults: function(results) {
		if(results.length > 0) {
			this.generatedToAlias = new haxe.ds.StringMap();
			var generated = this.aliasToGenerated.keys();
			while(generated.hasNext()) {
				var generated1 = generated.next();
				this.generatedToAlias.set(this.aliasToGenerated.get(generated1),generated1);
			}
			var fields = Reflect.fields(results[0]);
			var toRename = [];
			var _g = 0;
			while(_g < fields.length) {
				var field = fields[_g];
				++_g;
				if(this.generatedToAlias.exists(field)) {
					toRename.push(field);
				}
			}
			if(toRename.length > 0) {
				var _g1 = 0;
				while(_g1 < results.length) {
					var row = results[_g1];
					++_g1;
					var _g11 = 0;
					while(_g11 < toRename.length) {
						var field1 = toRename[_g11];
						++_g11;
						var val = Reflect.field(row,field1);
						Reflect.deleteField(row,field1);
						Reflect.setField(row,this.generatedToAlias.get(field1),val);
					}
				}
			}
		}
		return results;
	}
	,getParameterNotation: function(i) {
		if(this.provider.getProviderType() == "ORACLE") {
			return ":" + i;
		} else if(this.provider.getProviderType() == "MYSQL") {
			return "?";
		} else if(this.provider.getProviderType() == "PGSQL") {
			return "$" + i;
		} else {
			return "?";
		}
	}
	,postProcess: function(query) {
		if(this.provider.getProviderType() == "ORACLE") {
			if(query.tokens != null && query.tokens.length > 0) {
				var _g = 0;
				var _g1 = query.tokens;
				while(_g < _g1.length) {
					var token = _g1[_g];
					++_g;
					if(Std["is"](token,saturn.db.query_lang.Limit)) {
						if(query.whereToken == null) {
							query.whereToken = new saturn.db.query_lang.Where();
						}
						var where = query.getWhere();
						where.add(token);
						HxOverrides.remove(query.tokens,token);
					}
				}
			}
		}
	}
	,getLimitClause: function(txt) {
		if(this.provider.getProviderType() == "ORACLE") {
			return " ROWNUM < " + txt;
		} else if(this.provider.getProviderType() == "MYSQL") {
			return " limit " + txt;
		} else if(this.provider.getProviderType() == "PGSQL") {
			return " LIMIT " + txt;
		} else {
			return " limit " + txt;
		}
	}
	,buildSqlInClause: function(numIds,nextVal,func) {
		if(nextVal == null) {
			nextVal = 0;
		}
		var inClause = new StringBuf();
		inClause.add("IN(");
		inClause.add(")");
		return inClause.toString();
	}
	,__class__: saturn.db.query_lang.SQLVisitor
};
saturn.db.query_lang.Select = $hxClasses["saturn.db.query_lang.Select"] = function() {
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.Select.__name__ = ["saturn","db","query_lang","Select"];
saturn.db.query_lang.Select.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.Select.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.Select
});
saturn.db.query_lang.StartBlock = $hxClasses["saturn.db.query_lang.StartBlock"] = function() {
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.StartBlock.__name__ = ["saturn","db","query_lang","StartBlock"];
saturn.db.query_lang.StartBlock.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.StartBlock.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.StartBlock
});
saturn.db.query_lang.Substr = $hxClasses["saturn.db.query_lang.Substr"] = function(value,position,length) {
	saturn.db.query_lang.Function.call(this,[value,position,length]);
};
saturn.db.query_lang.Substr.__name__ = ["saturn","db","query_lang","Substr"];
saturn.db.query_lang.Substr.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.Substr.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.Substr
});
saturn.db.query_lang.ToNumber = $hxClasses["saturn.db.query_lang.ToNumber"] = function(token) {
	saturn.db.query_lang.Function.call(this,[token]);
};
saturn.db.query_lang.ToNumber.__name__ = ["saturn","db","query_lang","ToNumber"];
saturn.db.query_lang.ToNumber.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.ToNumber.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.ToNumber
});
saturn.db.query_lang.Trim = $hxClasses["saturn.db.query_lang.Trim"] = function(value) {
	saturn.db.query_lang.Function.call(this,[value]);
};
saturn.db.query_lang.Trim.__name__ = ["saturn","db","query_lang","Trim"];
saturn.db.query_lang.Trim.__super__ = saturn.db.query_lang.Function;
saturn.db.query_lang.Trim.prototype = $extend(saturn.db.query_lang.Function.prototype,{
	__class__: saturn.db.query_lang.Trim
});
saturn.db.query_lang.Value = $hxClasses["saturn.db.query_lang.Value"] = function(value) {
	saturn.db.query_lang.Token.call(this,null);
	this.value = value;
};
saturn.db.query_lang.Value.__name__ = ["saturn","db","query_lang","Value"];
saturn.db.query_lang.Value.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.Value.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	value: null
	,getValue: function() {
		return this.value;
	}
	,__class__: saturn.db.query_lang.Value
});
saturn.db.query_lang.ValueList = $hxClasses["saturn.db.query_lang.ValueList"] = function(values) {
	this.values = values;
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.ValueList.__name__ = ["saturn","db","query_lang","ValueList"];
saturn.db.query_lang.ValueList.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.ValueList.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	values: null
	,getValues: function() {
		return this.values;
	}
	,__class__: saturn.db.query_lang.ValueList
});
saturn.db.query_lang.Where = $hxClasses["saturn.db.query_lang.Where"] = function() {
	saturn.db.query_lang.Token.call(this,null);
};
saturn.db.query_lang.Where.__name__ = ["saturn","db","query_lang","Where"];
saturn.db.query_lang.Where.__super__ = saturn.db.query_lang.Token;
saturn.db.query_lang.Where.prototype = $extend(saturn.db.query_lang.Token.prototype,{
	__class__: saturn.db.query_lang.Where
});
if(!saturn.server) saturn.server = {};
if(!saturn.server.plugins) saturn.server.plugins = {};
if(!saturn.server.plugins.core) saturn.server.plugins.core = {};
saturn.server.plugins.core.AuthenticationManager = $hxClasses["saturn.server.plugins.core.AuthenticationManager"] = function() { };
saturn.server.plugins.core.AuthenticationManager.__name__ = ["saturn","server","plugins","core","AuthenticationManager"];
saturn.server.plugins.core.AuthenticationManager.prototype = {
	authenticate: null
	,__class__: saturn.server.plugins.core.AuthenticationManager
};
saturn.server.plugins.core.BaseServerPlugin = $hxClasses["saturn.server.plugins.core.BaseServerPlugin"] = function(saturn1,config) {
	this.debug = (js.Node.require("debug"))("saturn:plugin");
	this.saturn = saturn1;
	this.config = config;
	this.plugins = [];
	this.processConfig();
	this.registerPlugins();
};
saturn.server.plugins.core.BaseServerPlugin.__name__ = ["saturn","server","plugins","core","BaseServerPlugin"];
saturn.server.plugins.core.BaseServerPlugin.prototype = {
	saturn: null
	,config: null
	,plugins: null
	,debug: null
	,processConfig: function() {
	}
	,registerPlugins: function() {
		var clazzName = Type.getClassName(Type.getClass(this));
		if(Reflect.hasField(this.config,"plugins")) {
			var pluginDefs = Reflect.field(this.config,"plugins");
			var _g = 0;
			while(_g < pluginDefs.length) {
				var pluginDef = pluginDefs[_g];
				++_g;
				var clazzStr = Reflect.field(pluginDef,"clazz");
				var clazz = Type.resolveClass(clazzStr);
				var plugin = Type.createInstance(clazz,[this,pluginDef]);
				this.debug("CHILD_PLUGIN" + Type.getClassName(clazz));
				this.plugins.push(plugin);
			}
		}
	}
	,getSaturnServer: function() {
		return this.saturn;
	}
	,__class__: saturn.server.plugins.core.BaseServerPlugin
};
saturn.server.plugins.core.AuthenticationPlugin = $hxClasses["saturn.server.plugins.core.AuthenticationPlugin"] = function(server,config) {
	saturn.server.plugins.core.BaseServerPlugin.call(this,server,config);
	this.configureAuthenticationManager();
	this.installAuth();
	if(config.password_in_token) {
		this.debug("Warning passwords will be stored in JSON web tokens using AES encryption.  " + "To disable set password_in_token to false in your confirguation file");
	}
};
saturn.server.plugins.core.AuthenticationPlugin.__name__ = ["saturn","server","plugins","core","AuthenticationPlugin"];
saturn.server.plugins.core.AuthenticationPlugin.__super__ = saturn.server.plugins.core.BaseServerPlugin;
saturn.server.plugins.core.AuthenticationPlugin.prototype = $extend(saturn.server.plugins.core.BaseServerPlugin.prototype,{
	authManager: null
	,installAuth: function() {
		var _gthis = this;
		var jwt = js.Node.require("jsonwebtoken");
		var uuid = js.Node.require("node-uuid");
		var crypto = js.Node.require("crypto");
		this.saturn.getServer().post("/login",function(req,res,next) {
			var username = req.params.username;
			var password = req.params.password;
			_gthis.authManager.authenticate(username,password,function(user) {
				var db = _gthis.saturn.getRedisClient();
				user.uuid = uuid.v4();
				user.username = username;
				if(_gthis.config.password_in_token) {
					var iv = crypto.randomBytes(_gthis.config.encrypt_iv_length);
					var cipher = crypto.createCipheriv(_gthis.config.algorithm,new Buffer(_gthis.config.encrypt_password),iv);
					var crypted = cipher.update(password,"utf8","hex");
					crypted += cipher["final"]("hex");
					password = crypted;
					user.password = iv.toString("hex") + ":" + password;
				}
				db.set("USER_UUID: " + user.uuid,user.username);
				var token = jwt.sign({ firstname : user.firstname, lastname : user.lastname, email : user.email, uuid : user.uuid, username : user.username, password : user.password},_gthis.config.jwt_secret,{ expiresIn : Std.string(_gthis.config.jwt_timeout) + "m"});
				res.header("Set-Cookie","saturn_token=" + token);
				res.send(200,{ token : token, full_name : user.firstname + " " + user.lastname, email : user.email, "projects" : user.projects});
				next();
			},function(err) {
				res.send(200,{ error : "Unable to authenticate"});
				next();
			},req.connection.remoteAddress);
		});
		var socketioJwt = js.Node.require("socketio-jwt");
		this.saturn.getServerSocket().on("connection",socketioJwt.authorize({ required : false, secret : this.config.jwt_secret, timeout : 15000, additional_auth : $bind(this,this.additionalAuth)})).on("authenticated",function(socket) {
			socket.on("logout",function(data) {
				_gthis.saturn.getSocketUser(socket,function(authUser) {
					if(authUser != null) {
						var db1 = _gthis.saturn.getRedisClient();
						db1.del("USER_UUID: " + authUser.uuid);
						_gthis.saturn.setUser(socket,null);
					}
				});
			});
		});
		this.saturn.setAuthenticationPlugin(this);
	}
	,configureAuthenticationManager: function() {
		var clazzStr = this.config.authentication_manager.clazz;
		var clazz = Type.resolveClass(clazzStr);
		this.authManager = Type.createInstance(clazz,[this.config.authentication_manager,this]);
		if(!Std["is"](this.authManager,saturn.server.plugins.core.AuthenticationManager)) {
			throw new js._Boot.HaxeError("Unable to setup authentication manager\n" + clazzStr + " should implement " + Std.string(saturn.server.plugins.core.AuthenticationManager));
		}
	}
	,additionalAuth: function(user,onSuccess,onFailure) {
		var db = this.saturn.getRedisClient();
		this.saturn.isUserAuthenticated(user,function(authUser) {
			if(authUser != null) {
				onSuccess();
			} else {
				onFailure("On Error","invalid_token");
			}
		});
	}
	,decryptUserPassword: function(user,cb) {
		var crypto = js.Node.require("crypto");
		var dBuffer = Buffer;
		var parts = user.password.split(":");
		var decipher = this.config.algorithm;
		var decipher1 = new Buffer(this.config.encrypt_password);
		var decipher2 = dBuffer.from(parts[0],"hex");
		var decipher3 = crypto.createDecipheriv(decipher,decipher1,decipher2);
		var dec = decipher3.update(parts[1],"hex","utf8");
		dec += decipher3["final"]("utf8");
		var userClone = new saturn.core.User();
		userClone.firstname = user.firstname;
		userClone.lastname = user.lastname;
		userClone.password = dec;
		userClone.username = user.username;
		cb(null,userClone);
	}
	,isUserAuthenticated: function(user,cb) {
		if(user == null) {
			cb(null);
		} else {
			var db = this.saturn.getRedisClient();
			db.get("USER_UUID: " + user.uuid,function(err,reply) {
				if(err || reply == null) {
					cb(null);
				} else {
					cb(user);
				}
			});
		}
	}
	,__class__: saturn.server.plugins.core.AuthenticationPlugin
});
saturn.server.plugins.core.ConfigurationPlugin = $hxClasses["saturn.server.plugins.core.ConfigurationPlugin"] = function() { };
saturn.server.plugins.core.ConfigurationPlugin.__name__ = ["saturn","server","plugins","core","ConfigurationPlugin"];
saturn.server.plugins.core.ConfigurationPlugin.getConfiguration = function(query,params,clazz,cb,hookConfig) {
	saturn.core.Util.debug("Returning configuration");
	if(hookConfig == null) {
		cb(null,"Hook configuration is missing");
	} else if(Reflect.hasField(hookConfig,"config")) {
		cb(Reflect.field(hookConfig,"config"),null);
	} else {
		cb(null,"ConfigurationPlugin configuration block is missing config attribute from JSON");
	}
};
saturn.server.plugins.core.DefaultProviderPlugin = $hxClasses["saturn.server.plugins.core.DefaultProviderPlugin"] = function(server,config) {
	saturn.server.plugins.core.BaseServerPlugin.call(this,server,config);
	this.configureProviders();
};
saturn.server.plugins.core.DefaultProviderPlugin.__name__ = ["saturn","server","plugins","core","DefaultProviderPlugin"];
saturn.server.plugins.core.DefaultProviderPlugin.__super__ = saturn.server.plugins.core.BaseServerPlugin;
saturn.server.plugins.core.DefaultProviderPlugin.prototype = $extend(saturn.server.plugins.core.BaseServerPlugin.prototype,{
	configureProviders: function() {
		var connections = this.config.connections;
		var _g = 0;
		while(_g < connections.length) {
			var connection = connections[_g];
			++_g;
			this._configureProvider(connection);
		}
	}
	,configureProviderold: function() {
		var _gthis = this;
		var driver = this.config.connection.driver;
		var clazz = null;
		try {
			clazz = Type.resolveClass(driver);
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			js.Node.console.log(e);
			js.Node.process.exit(-1);
		}
		var models = null;
		try {
			models = Type.createInstance(Type.resolveClass(this.config.connection.model_mapping),[]).models;
			this.debug("Hello World");
		} catch( e1 ) {
			if (e1 instanceof js._Boot.HaxeError) e1 = e1.val;
			js.Node.console.log(e1);
			js.Node.process.exit(-1);
		}
		if(this.config.connection.use_pool) {
			var pool = saturn.db.NodePool.generatePool("main_db",3,3,2000000,true,function(cb) {
				_gthis.debug("Configuring provider");
				var provider = Type.createInstance(clazz,[models,_gthis.config.connection,false]);
				provider.dataBinding(false);
				provider.readModels(function(err) {
					cb(err,provider);
					_gthis.debug(err);
				});
				provider.enableCache(_gthis.config.enable_cache);
			},function(resource) {
			});
			saturn.client.core.CommonCore.setPool(this.config.name,pool,this.config.default_provider);
		} else {
			this.debug("Configuring provider");
			var provider1 = Type.createInstance(clazz,[models,this.config.connection,false]);
			provider1.enableCache(this.config.enable_cache);
			provider1.dataBinding(false);
			provider1.readModels(function(err1) {
				if(err1 != null) {
					_gthis.debug(err1);
					js.Node.process.exit(-1);
				}
			});
			saturn.client.core.CommonCore.setDefaultProvider(provider1,this.config.name,this.config.default_provider);
		}
	}
	,_configureProvider: function(config) {
		var _gthis = this;
		var driver = config.driver;
		var clazz = null;
		try {
			clazz = Type.resolveClass(driver);
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			js.Node.console.log(e);
			js.Node.process.exit(-1);
		}
		var models = null;
		try {
			models = Type.createInstance(Type.resolveClass(config.model_mapping),[]).models;
			this.debug("Hello World " + config.model_mapping);
		} catch( e1 ) {
			if (e1 instanceof js._Boot.HaxeError) e1 = e1.val;
			js.Node.console.log(e1);
			js.Node.process.exit(-1);
		}
		if(config.use_pool) {
			var pool = saturn.db.NodePool.generatePool("main_db",3,3,2000000,true,function(cb) {
				_gthis.debug("Configuring provider");
				var provider = Type.createInstance(clazz,[models,config,false]);
				provider.dataBinding(false);
				provider.setName(config.name);
				provider.readModels(function(err) {
					cb(err,provider);
					_gthis.debug(err);
				});
				provider.enableCache(config.enable_cache);
			},function(resource) {
			});
			saturn.client.core.CommonCore.setPool(config.name,pool,config.default_provider);
		} else {
			this.debug("Configuring provider");
			var provider1 = Type.createInstance(clazz,[models,config,false]);
			provider1.enableCache(config.enable_cache);
			provider1.dataBinding(false);
			provider1.setName(config.name);
			provider1.readModels(function(err1) {
				if(err1 != null) {
					_gthis.debug(err1);
					js.Node.process.exit(-1);
				}
			});
			saturn.client.core.CommonCore.setDefaultProvider(provider1,config.name,config.default_provider);
		}
	}
	,__class__: saturn.server.plugins.core.DefaultProviderPlugin
});
saturn.server.plugins.core.ExternalAuthenticationPlugin = $hxClasses["saturn.server.plugins.core.ExternalAuthenticationPlugin"] = function(config) {
	this.config = config;
};
saturn.server.plugins.core.ExternalAuthenticationPlugin.__name__ = ["saturn","server","plugins","core","ExternalAuthenticationPlugin"];
saturn.server.plugins.core.ExternalAuthenticationPlugin.__interfaces__ = [saturn.server.plugins.core.AuthenticationManager];
saturn.server.plugins.core.ExternalAuthenticationPlugin.prototype = {
	config: null
	,authenticate: function(username,password,onSuccess,onFailure,src) {
		var hookConfig = this.config.external_hook;
		var authObj = [{ "username" : username, "password" : password, "mode" : "authenticate", "src" : src}];
		saturn.db.provider.hooks.ExternalJsonHook.run("Authenticate",authObj,null,function(objs,error) {
			if(error != null) {
				saturn.core.Util.debug(error);
				onFailure("Internal server error");
			} else {
				saturn.core.Util.debug("Authentication manager returned");
				var authResponse = objs[0];
				if(authResponse.outcome == "success") {
					var user = new saturn.core.User();
					user.firstname = authResponse.firstName;
					user.lastname = authResponse.lastName;
					user.email = authResponse.email;
					user.projects = authResponse.projects;
					saturn.core.Util.debug("Returning success");
					onSuccess(user);
				} else {
					saturn.core.Util.debug("Returning error");
					onFailure("Unable to authenticate");
				}
			}
		},hookConfig);
	}
	,__class__: saturn.server.plugins.core.ExternalAuthenticationPlugin
};
saturn.server.plugins.core.MySQLAuthPlugin = $hxClasses["saturn.server.plugins.core.MySQLAuthPlugin"] = function(config) {
	this.config = config;
};
saturn.server.plugins.core.MySQLAuthPlugin.__name__ = ["saturn","server","plugins","core","MySQLAuthPlugin"];
saturn.server.plugins.core.MySQLAuthPlugin.__interfaces__ = [saturn.server.plugins.core.AuthenticationManager];
saturn.server.plugins.core.MySQLAuthPlugin.prototype = {
	config: null
	,authenticate: function(username,password,onSuccess,onFailure,src) {
		var mysql = js.Node.require("mysql2");
		saturn.core.Util.debug("Connecting as " + username + " to " + username + " with password " + password + " on " + Std.string(this.config.hostname));
		var connection = mysql.createConnection({ host : this.config.hostname, user : username, password : password, database : username});
		connection.on("connect",function(connect) {
			if(connect) {
				connection.query("\n                    SELECT\n                     *\n                    FROM\n                        icmdb_page_secure.V_USERS\n                    WHERE\n                        Name=?\n                ",[username],function(err,res) {
					if(err) {
						js.Node.console.log("Error connecting");
						onFailure("Unable to connect");
					} else {
						js.Node.console.log("Success");
						if(res.length == 0) {
							js.Node.console.log("Unable to connect");
							onFailure("Unable to connect");
						} else {
							var userRow = res[0];
							var user = new saturn.core.User();
							user.firstname = userRow.First_Name;
							user.lastname = userRow.Last_Name;
							user.email = userRow.EMail;
							js.Node.console.log("Login succeded!");
							onSuccess(user);
						}
					}
					connection.end();
				});
			} else {
				js.Node.console.log("Unable to connect");
				onFailure("Unable to connect");
			}
		});
		connection.on("error",function(err1) {
			js.Node.console.log("Error: " + (err1 == null ? "null" : "" + err1));
			onFailure("Unable to connect");
		});
	}
	,__class__: saturn.server.plugins.core.MySQLAuthPlugin
};
saturn.server.plugins.core.ProxyPlugin = $hxClasses["saturn.server.plugins.core.ProxyPlugin"] = function(server,config) {
	saturn.server.plugins.core.BaseServerPlugin.call(this,server,config);
	this.configure();
};
saturn.server.plugins.core.ProxyPlugin.__name__ = ["saturn","server","plugins","core","ProxyPlugin"];
saturn.server.plugins.core.ProxyPlugin.__super__ = saturn.server.plugins.core.BaseServerPlugin;
saturn.server.plugins.core.ProxyPlugin.prototype = $extend(saturn.server.plugins.core.BaseServerPlugin.prototype,{
	proxy: null
	,configure: function() {
		var _gthis = this;
		var httpProxy = js.Node.require("http-proxy");
		var Agent = js.Node.require("agentkeepalive");
		var agent = new Agent({
            maxSockets: 100,
            keepAlive: true,
            maxFreeSockets: 20,
            keepAliveMsecs:100000,
            timeout: 600000,
            keepAliveTimeout: 300000 // free socket keepalive for 30 seconds
        });
		this.proxy = httpProxy.createProxyServer({ agent : agent, changeOrigin : true});
		var server = this.getSaturnServer().getServer();
		var restify = js.Node.require("restify");
		var _g = 0;
		var _g1 = Reflect.fields(this.config.routes);
		while(_g < _g1.length) {
			var route = _g1[_g];
			++_g;
			var routeConfig = [Reflect.field(this.config.routes,route)];
			this.debug("Routing " + route + " to " + routeConfig[0].target);
			if(routeConfig[0].prestart != null) {
				var proc = js.Node.get_child_process().spawn(routeConfig[0].prestart,routeConfig[0].args,{ env : js.Node.process.env, cwd : routeConfig[0].cwd});
				proc.stderr.on("data",(function() {
					return function(error) {
						_gthis.debug(error);
					};
				})());
				proc.stdout.on("data",(function() {
					return function(error1) {
						_gthis.debug(error1);
					};
				})());
				proc.on("exit",(function() {
					return function() {
						_gthis.debug("Exited");
					};
				})());
			}
			if(routeConfig[0].GET) {
				this.debug("Adding GET proxy");
				var tmp = (function(routeConfig1) {
					return function(req,res) {
						_gthis.debug("Request: " + req.getPath());
						_gthis.proxyRequest(req,res,routeConfig1[0].target);
					};
				})(routeConfig);
				server.get(route,tmp);
			}
			if(routeConfig[0].POST) {
				this.debug("Adding POST proxy");
				var tmp1 = (function(routeConfig2) {
					return function(req1,res1) {
						_gthis.proxyRequest(req1,res1,routeConfig2[0].target);
					};
				})(routeConfig);
				server.post(route,tmp1);
			}
		}
		this.proxy.on("error",function(error2,req2,res2) {
			var json;
			_gthis.debug("proxy error",error2);
			if(!res2.headersSent) {
				res2.writeHead(500,{ "content-type" : "application/json"});
			}
			json = { error : "proxy_error", reason : error2.message};
			var tmp2 = haxe.Json.stringify(json);
			res2.end(tmp2);
		});
	}
	,proxyRequest: function(req,res,target) {
		this.proxy.web(req,res,{ target : target});
	}
	,wrapMiddleware: function(middleware) {
		var _gthis = this;
		return function(req,res,next) {
			if(StringTools.startsWith(req.path(),"/GlycanBuilder")) {
				_gthis.debug("Skipping " + req.getPath());
				next();
			} else {
				_gthis.debug("Playing " + req.getPath());
				if((middleware instanceof Array) && middleware.__enum__ == null) {
					middleware[0](req,res,function() {
						middleware[1](req,res,next);
					});
				} else {
					middleware(req,res,next);
				}
			}
		};
	}
	,__class__: saturn.server.plugins.core.ProxyPlugin
});
saturn.server.plugins.core.RESTSocketWrapperPlugin = $hxClasses["saturn.server.plugins.core.RESTSocketWrapperPlugin"] = function(server,config) {
	this.uuidToJobInfo = new haxe.ds.StringMap();
	this.uuidToResponse = new haxe.ds.StringMap();
	this.uuidToToken = new haxe.ds.StringMap();
	this.uuidModule = js.Node.require("node-uuid");
	saturn.server.plugins.core.BaseServerPlugin.call(this,server,config);
	this.registerListeners();
};
saturn.server.plugins.core.RESTSocketWrapperPlugin.__name__ = ["saturn","server","plugins","core","RESTSocketWrapperPlugin"];
saturn.server.plugins.core.RESTSocketWrapperPlugin.fetch_compound = function(path,req,res,next,handle_function) {
	var command = "_remote_provider_._data_request_objects_namedquery";
	var d = { };
	var json = { };
	if(Reflect.hasField(req.params,"format") && req.params.format == "svg") {
		json.action = "as_svg";
		json.ctab_content = req.params.molblock;
	}
	d.queryId = "saturn.db.provider.hooks.ExternalJsonHook:Fetch";
	d.parameters = haxe.Serializer.run([json]);
	handle_function(path,req,res,next,command,d);
};
saturn.server.plugins.core.RESTSocketWrapperPlugin.__super__ = saturn.server.plugins.core.BaseServerPlugin;
saturn.server.plugins.core.RESTSocketWrapperPlugin.prototype = $extend(saturn.server.plugins.core.BaseServerPlugin.prototype,{
	uuidModule: null
	,uuidToToken: null
	,uuidToResponse: null
	,uuidToJobInfo: null
	,extractAuthenticationToken: function(req) {
		var cookies = req.cookies;
		if(cookies != null && cookies.saturn_token != null) {
			return cookies.saturn_token;
		} else {
			return req.params.token;
		}
	}
	,invalidAuthentication: function(req,res,next) {
		res.status(403);
		res.send("Bad token");
		next();
	}
	,registerListeners: function() {
		var _gthis = this;
		this.saturn.getServer().post("/api/queue/:uuid",function(req,res,next) {
			var token = _gthis.extractAuthenticationToken(req);
			if(token == null) {
				_gthis.invalidAuthentication(req,res,next);
				return;
			}
			var uuid = req.params.uuid;
			if(_gthis.uuidToToken.exists(uuid)) {
				if(_gthis.uuidToToken.get(uuid) == token) {
					if(_gthis.uuidToResponse.exists(uuid)) {
						var response = _gthis.uuidToResponse.get(uuid);
						res.status(200);
						res.send(response);
						next();
					} else {
						res.status(102);
						next();
					}
				} else {
					res.status(403);
					res.send("Token/uuid missmatch expected " + _gthis.uuidToToken.get(uuid) + " and you passed " + token);
					next();
				}
			} else {
				res.status(403);
				res.send("Bad uuid");
				next();
			}
		});
		var handle_function = function(path,req1,res1,next1,command,json) {
			_gthis.debug("In Function");
			var token1 = _gthis.extractAuthenticationToken(req1);
			if(token1 == null) {
				_gthis.invalidAuthentication(req1,res1,next1);
				return;
			}
			if(command == null && json == null) {
				command = req1.params.command;
				json = js.Node.parse(req1.params.json);
				if(path == "/api/command/") {
					if(command == "_remote_provider_._data_request_objects_namedquery") {
						var d = { };
						d.queryId = json.queryId;
						d.parameters = haxe.Serializer.run(json.parameters);
						json = d;
					}
				} else if(path == "/api/provider/command/") {
					var d1 = { };
					d1.queryId = command;
					command = "_remote_provider_._data_request_objects_namedquery";
					d1.parameters = haxe.Serializer.run(json.parameters);
					json = d1;
				}
			}
			var wait = "no";
			if(Reflect.hasField(req1.params,"wait")) {
				wait = req1.params.wait;
				_gthis.debug("Going to wait");
				if(wait != "no" && wait != "yes") {
					res1.status(403);
					res1.send("Wait setting must be yes or no");
					next1();
					return;
				}
			}
			var uuid1 = _gthis.uuidModule.v4();
			_gthis.uuidToToken.set(uuid1,token1);
			res1.header("Location","/api/queue/" + uuid1);
			if(wait == "no") {
				res1.status(202);
				res1.send();
				next1();
			} else {
				next1();
			}
			var io = js.Node.require("socket.io-client");
			var protocol = "ws";
			if(_gthis.saturn.isEncrypted()) {
				protocol = "wss";
			}
			var conStr = protocol + "://" + _gthis.saturn.getInternalConnectionHostName() + ":" + Std.string(_gthis.saturn.getServerConfig().port);
			_gthis.debug("Connecting to " + conStr);
			var socket = io.connect(conStr,{ port : 8091});
			var openTime = new Date().getTime();
			var status = new haxe.ds.StringMap();
			status.set("connected",false);
			status.set("disconnected",false);
			socket.on("error",function(data) {
				_gthis.respond(uuid1,500,socket,wait,"Unknown error",status,res1);
			});
			socket.on("authenticated",function(data1) {
				_gthis.runCommand(socket,command,json,uuid1);
			});
			socket.on("unauthorized",function(data2) {
				_gthis.respond(uuid1,403,socket,wait,"Unauthorised",status,res1);
			});
			socket.on("receiveError",function(data3) {
				_gthis.respond(uuid1,200,socket,wait,data3,status,res1);
			});
			socket.on("__response__",function(data4) {
				_gthis.respond(uuid1,200,socket,wait,data4,status,res1);
			});
			socket.on("connect",function(data5) {
				status.set("connected",true);
				socket.emit("authenticate",{ token : token1});
			});
			var cleanUp = null;
			cleanUp = function() {
				var currentTime = new Date().getTime();
				if(!status.get("disconnected")) {
					if((currentTime - openTime) / 1000 > 300) {
						socket.disconnect();
						status.set("disconnected",true);
						if(wait == "yes") {
							_gthis.debug("Sending response");
							res1.status(200);
							res1.send("Connection time-out");
						}
					} else {
						haxe.Timer.delay(cleanUp,10000);
					}
				}
			};
			cleanUp();
		};
		this.saturn.getServer().post("/api",function(req2,res2,next2) {
			handle_function("/api/",req2,res2,next2);
		});
		this.saturn.getServer().post("/api/command/:command",function(req3,res3,next3) {
			handle_function("/api/command/",req3,res3,next3);
		});
		this.saturn.getServer().post("/api/provider/command/:command",function(req4,res4,next4) {
			handle_function("/api/provider/command/",req4,res4,next4);
		});
		if(Reflect.hasField(this.config,"commands")) {
			var commands = Reflect.field(this.config,"commands");
			var _g = 0;
			while(_g < commands.length) {
				var command1 = commands[_g];
				++_g;
				var route = [command1.route];
				var format_method_clazz = [command1.format_request_clazz];
				var format_method_method = [command1.format_request_method];
				var http_method = command1.http_method;
				if(http_method == "POST") {
					this.saturn.getServer().post(route[0],(function(format_method_method1,format_method_clazz1,route1) {
						return function(req5,res5,next5) {
							var clazz = Type.resolveClass(format_method_clazz1[0]);
							(Reflect.field(clazz,format_method_method1[0]))(route1[0],req5,res5,next5,handle_function);
						};
					})(format_method_method,format_method_clazz,route));
				} else if(http_method == "PUT") {
					this.saturn.getServer().put(route[0],(function(format_method_method2,format_method_clazz2,route2) {
						return function(req6,res6,next6) {
							var clazz1 = Type.resolveClass(format_method_clazz2[0]);
							(Reflect.field(clazz1,format_method_method2[0]))(route2[0],req6,res6,next6,handle_function);
						};
					})(format_method_method,format_method_clazz,route));
				} else if(http_method == "DELETE") {
					this.saturn.getServer().del(route[0],(function(format_method_method3,format_method_clazz3,route3) {
						return function(req7,res7,next7) {
							var clazz2 = Type.resolveClass(format_method_clazz3[0]);
							(Reflect.field(clazz2,format_method_method3[0]))(route3[0],req7,res7,next7,handle_function);
						};
					})(format_method_method,format_method_clazz,route));
				} else if(http_method == "GET") {
					this.saturn.getServer().get(route[0],(function(format_method_method4,format_method_clazz4,route4) {
						return function(req8,res8,next8) {
							var clazz3 = Type.resolveClass(format_method_clazz4[0]);
							(Reflect.field(clazz3,format_method_method4[0]))(route4[0],req8,res8,next8,handle_function);
						};
					})(format_method_method,format_method_clazz,route));
				}
			}
		}
	}
	,respond: function(uuid,statusCode,socket,wait,data,status,res) {
		var remappedData = data;
		if(Reflect.hasField(data,"json")) {
			if(Reflect.hasField(data,"bioinfJobId")) {
				remappedData = { "uuid" : data.bioinfJobId};
			}
			if(Reflect.hasField(data.json,"error")) {
				remappedData.error = data.json.error;
			}
			if(Reflect.hasField(data.json,"objects")) {
				var objects = data.json.objects;
				var returnKey = "result-set";
				if(objects != null && objects.length > 0 && Reflect.hasField(objects[0],"result-set")) {
					objects = Reflect.field(objects[0],"result-set");
				} else if(objects != null && objects.length > 0 && Reflect.hasField(objects[0],"refreshed_objects")) {
					objects = Reflect.field(objects[0],"refreshed_objects");
					returnKey = "refreshed-objects";
				} else if(objects != null && objects.length > 0 && Reflect.hasField(objects[0],"upload_set")) {
					objects = Reflect.field(objects[0],"upload_set");
				}
				Reflect.setField(remappedData,returnKey,objects);
			} else {
				var _g = 0;
				var _g1 = Reflect.fields(data.json);
				while(_g < _g1.length) {
					var field = _g1[_g];
					++_g;
					Reflect.setField(remappedData,field,Reflect.field(data.json,field));
				}
			}
		}
		if(wait == "yes") {
			this.debug("Sending response");
			res.status(statusCode);
			res.send(remappedData);
		} else {
			this.debug("Not sending response");
		}
		this.uuidToResponse.set(uuid,remappedData);
		socket.disconnect();
		status.set("disconnected",true);
	}
	,runCommand: function(socket,command,json,uuid) {
		json.msgId = uuid;
		json.bioinfJobId = uuid;
		this.uuidToJobInfo.set(uuid,{ "MSG" : command, "JSON" : json});
		this.debug("Sending command " + command);
		socket.emit(command,json);
	}
	,__class__: saturn.server.plugins.core.RESTSocketWrapperPlugin
});
saturn.server.plugins.core.SATurnDefaultRESTRouter = $hxClasses["saturn.server.plugins.core.SATurnDefaultRESTRouter"] = function() {
};
saturn.server.plugins.core.SATurnDefaultRESTRouter.__name__ = ["saturn","server","plugins","core","SATurnDefaultRESTRouter"];
saturn.server.plugins.core.SATurnDefaultRESTRouter.update_blastdb = function(path,req,res,next,handle_function) {
	var command = "_blast_updater_";
	if(!Reflect.hasField(req.params,"database") || req.params.database == null) {
		res.status(400);
		res.send("Bad Request - database parameter missing");
		next();
	} else {
		var jsonObj = { "database" : req.params.database};
		handle_function(path,req,res,next,command,jsonObj);
	}
};
saturn.server.plugins.core.SATurnDefaultRESTRouter.prototype = {
	__class__: saturn.server.plugins.core.SATurnDefaultRESTRouter
};
saturn.server.plugins.core.SocketPlugin = $hxClasses["saturn.server.plugins.core.SocketPlugin"] = function(server,config) {
	saturn.server.plugins.core.BaseServerPlugin.call(this,server,config);
	this.startSocketServer();
};
saturn.server.plugins.core.SocketPlugin.__name__ = ["saturn","server","plugins","core","SocketPlugin"];
saturn.server.plugins.core.SocketPlugin.__super__ = saturn.server.plugins.core.BaseServerPlugin;
saturn.server.plugins.core.SocketPlugin.prototype = $extend(saturn.server.plugins.core.BaseServerPlugin.prototype,{
	startSocketServer: function() {
		var socket = js.Node.require("socket.io").listen(this.saturn.getServer().server,{ log : true});
		socket.set("origins",this.saturn.getServerConfig().origins);
		socket.set("transports",["websocket","polling"]);
		this.saturn.setServerSocket(socket);
	}
	,__class__: saturn.server.plugins.core.SocketPlugin
});
if(!saturn.server.plugins.socket) saturn.server.plugins.socket = {};
if(!saturn.server.plugins.socket.core) saturn.server.plugins.socket.core = {};
saturn.server.plugins.socket.core.BaseServerSocketPlugin = $hxClasses["saturn.server.plugins.socket.core.BaseServerSocketPlugin"] = function(server,config) {
	this.authenticateAll = false;
	this.pluginName = Type.getClassName(Type.getClass(this));
	this.messageToCB = new haxe.ds.StringMap();
	this.debug = (js.Node.require("debug"))("saturn:socket-plugin");
	saturn.server.plugins.core.BaseServerPlugin.call(this,server,config);
};
saturn.server.plugins.socket.core.BaseServerSocketPlugin.__name__ = ["saturn","server","plugins","socket","core","BaseServerSocketPlugin"];
saturn.server.plugins.socket.core.BaseServerSocketPlugin.__super__ = saturn.server.plugins.core.BaseServerPlugin;
saturn.server.plugins.socket.core.BaseServerSocketPlugin.prototype = $extend(saturn.server.plugins.core.BaseServerPlugin.prototype,{
	queueName: null
	,queue: null
	,messageToCB: null
	,pluginName: null
	,authenticateAll: null
	,processConfig: function() {
		saturn.server.plugins.core.BaseServerPlugin.prototype.processConfig.call(this);
		if(Reflect.hasField(this.config,"authentication")) {
			if(Reflect.hasField(this.config.authentication,"*")) {
				this.debug("(AUTH_ALL)");
				this.authenticateAll = true;
			}
		}
	}
	,registerPlugins: function() {
		if(!Reflect.hasField(this.config,"authentication")) {
			this.config.authentication = [];
		}
		if(Reflect.hasField(this.config,"plugins")) {
			var pluginDefs = Reflect.field(this.config,"plugins");
			var _g = 0;
			while(_g < pluginDefs.length) {
				var pluginDef = pluginDefs[_g];
				++_g;
				if(Reflect.hasField(pluginDef,"authentication")) {
					var fields = Reflect.fields(pluginDef.authentication);
					var _g1 = 0;
					while(_g1 < fields.length) {
						var field = fields[_g1];
						++_g1;
						this.debug("CHILD_PLUGIN_AUTH:" + field);
						Reflect.setField(this.config.authentication,field,Reflect.field(pluginDef.authentication,field));
					}
				}
			}
		}
		saturn.server.plugins.core.BaseServerPlugin.prototype.registerPlugins.call(this);
	}
	,addListeners: function(socket) {
		var _gthis = this;
		var message = this.messageToCB.keys();
		while(message.hasNext()) {
			var message1 = message.next();
			var message2 = [message1];
			var message3 = message2[0];
			var tmp = (function(message4) {
				return function(data) {
					var handler = _gthis.messageToCB.get(message4[0]);
					data.socketId = socket.id;
					handler(data,socket);
				};
			})(message2);
			socket.on(message3,tmp);
		}
	}
	,cleanup: function(data) {
	}
	,registerListener: function(message,cb) {
		var _gthis = this;
		var paths = [Type.getClassName(Type.getClass(this))];
		if(Reflect.hasField(this.config,"namespaces")) {
			var namespace_defs = this.config.namespaces;
			var _g = 0;
			while(_g < namespace_defs.length) {
				var namespace_def = namespace_defs[_g];
				++_g;
				paths.push(namespace_def.name);
			}
		}
		var wrapperCb = cb;
		var auth = this.authenticateAll;
		if(!auth) {
			if(Reflect.hasField(this.config,"authentication")) {
				if(Reflect.hasField(this.config.authentication,message)) {
					auth = true;
				}
			}
		}
		if(auth) {
			this.debug("AUTH_REQUIRED: " + message);
			wrapperCb = function(obj,socket) {
				if(message == "_data_request_objects_namedquery") {
					_gthis.debug("Checking named query");
					if(Reflect.hasField(_gthis.config.authentication,message)) {
						var messageConfig = Reflect.field(_gthis.config.authentication,message);
						var namedQueryConfigs = Reflect.field(messageConfig,"queries");
						var namedQuery = Reflect.field(obj,"queryId");
						_gthis.debug("Checking configuration for " + namedQuery);
						if(Reflect.hasField(namedQueryConfigs,namedQuery)) {
							var namedQueryConfig = Reflect.field(namedQueryConfigs,namedQuery);
							if(Reflect.field(namedQueryConfig,"role") == "PUBLIC") {
								_gthis.debug("Named query is publically accessible!");
								cb(obj,socket);
								return;
							} else {
								_gthis.debug("Role is not public");
							}
						} else {
							_gthis.debug("Missing query configuration");
						}
					} else {
						cb(obj,socket);
						return;
					}
				}
				_gthis.saturn.isSocketAuthenticated(socket,function(user) {
					if(user != null) {
						_gthis.debug("User: " + user.username);
						cb(obj,socket);
					} else {
						_gthis.handleError(obj,"Access denied<br/>Login or acquire additional permissions",null);
					}
				});
			};
		}
		var _g1 = 0;
		while(_g1 < paths.length) {
			var path = paths[_g1];
			++_g1;
			var fqm = path;
			if(message.length > 0) {
				fqm = path + "." + message;
			}
			this.debug("URL: " + fqm);
			this.messageToCB.set(fqm,wrapperCb);
		}
	}
	,sendJson: function(job,json,done) {
		try {
			var jobId = this.getJobId(job);
			var response = { };
			this.debug("JSON Error: " + Std.string(json.error));
			if(json.error != null) {
				json.error = StringTools.replace(Std.string(json.error),"\n","");
				response.error = json.error;
			}
			response.bioinfJobId = jobId;
			response.json = json;
			response.msgId = jobId;
			var socket = this.getSocket(job);
			if(socket != null) {
				socket.emit("__response__",response);
				this.cleanup(job);
			} else {
				this.debug("Unknown destination for " + jobId);
			}
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			if( js.Boot.__instanceof(e,saturn.server.plugins.socket.core.SocketIOException) ) {
				console.log(e.toString());
			} else throw(e);
		}
		if(done != null) {
			done();
		}
	}
	,sendError: function(job,error,done) {
		try {
			var jobId = this.getJobId(job);
			this.debug("Error: " + error);
			var socket = this.getSocket(job);
			if(socket != null) {
				socket.emit(this.pluginName + ":response",{ bioinfJobId : jobId, error : error, msgId : jobId});
				socket.emit("__response__",{ bioinfJobId : jobId, error : error, msgId : jobId});
			} else {
				this.debug("Unknown destination for " + jobId);
			}
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			if( js.Boot.__instanceof(e,saturn.server.plugins.socket.core.SocketIOException) ) {
				console.log(e.toString());
			} else throw(e);
		}
		if(done != null) {
			done();
		}
		this.cleanup(job);
	}
	,broadcast: function(msg,json) {
		this.debug("Broadcasting message:" + msg);
		this.saturn.getServerSocket().sockets.emit(msg,json);
	}
	,registerCommand: function(command,handler) {
		this.registerListener(command,handler);
	}
	,handleError: function(job,error,cb) {
		this.debug(error);
		if(cb != null) {
			cb();
		}
		try {
			var socket = this.getSocket(job);
			var jobId = this.getJobId(job);
			if(socket != null) {
				var errorObj = error;
				if(Reflect.hasField(error,"message")) {
					socket.emit("receiveError",{ msgId : jobId, bioinfJobId : jobId, error : error, JOB_DONE : 1});
				} else {
					socket.emit("receiveError",{ msgId : jobId, bioinfJobId : jobId, error : haxe.Json.stringify(error), JOB_DONE : 1});
				}
			} else {
				this.debug("Unable to identify socket associated with job " + jobId + "\nError: " + Std.string(error));
			}
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			if( js.Boot.__instanceof(e,saturn.server.plugins.socket.core.SocketIOException) ) {
				console.log(e.toString());
			} else throw(e);
		}
	}
	,getJobId: function(data) {
		var jobId;
		if(Reflect.hasField(data,"data")) {
			if(Reflect.hasField(data.data,"bioinfJobId")) {
				jobId = data.data.bioinfJobId;
			} else if(Reflect.hasField(data.data,"msgId")) {
				jobId = data.data.msgId;
			} else {
				return "-1";
			}
		} else if(Reflect.hasField(data,"bioinfJobId")) {
			jobId = data.bioinfJobId;
		} else if(Reflect.hasField(data,"msgId")) {
			jobId = data.msgId;
		} else {
			return "-1";
		}
		return jobId;
	}
	,getSocket: function(data) {
		if(Reflect.hasField(data,"data")) {
			if(Reflect.hasField(data.data,"socketId")) {
				return this.saturn.getServerSocket().sockets.connected[data.data.socketId];
			} else {
				throw new js._Boot.HaxeError(new saturn.server.plugins.socket.core.SocketIOException("Socket ID field missing from job"));
			}
		} else if(Reflect.hasField(data,"socketId")) {
			return this.saturn.getServerSocket().sockets.connected[data.socketId];
		} else {
			throw new js._Boot.HaxeError(new saturn.server.plugins.socket.core.SocketIOException("Socket ID field missing from job"));
		}
	}
	,getSocketUserNoAuthCheck: function(socket) {
		return this.saturn.getSocketUserNoAuthCheck(socket);
	}
	,__class__: saturn.server.plugins.socket.core.BaseServerSocketPlugin
});
saturn.server.plugins.socket.core.RemoteProviderPlugin = $hxClasses["saturn.server.plugins.socket.core.RemoteProviderPlugin"] = function(server,config) {
	saturn.server.plugins.socket.core.BaseServerSocketPlugin.call(this,server,config);
	this.registerProviderCommand("_request_models",$bind(this,this.getModels));
	this.registerProviderCommand("_data_request_objects_idstartswith",$bind(this,this.getByIdStartsWith));
	this.registerProviderCommand("_data_request_objects_ids",$bind(this,this.getObjectIds));
	this.registerProviderCommand("_data_request_objects_values",$bind(this,this.getByValues));
	this.registerProviderCommand("_data_request_objects_pkeys",$bind(this,this.getByPkeys));
	this.registerProviderCommand("_data_request_objects_by_class",$bind(this,this.getByClass));
	this.registerProviderCommand("_data_request_objects_namedquery",$bind(this,this.getByNamedQuery));
	this.registerProviderCommand("_data_delete_request",$bind(this,this["delete"]));
	this.registerProviderCommand("_data_insert_request",$bind(this,this.insert));
	this.registerProviderCommand("_data_update_request",$bind(this,this.update));
	this.registerProviderCommand("_data_commit_request",$bind(this,this.commit));
	this.registerProviderCommand("_data_request_query",$bind(this,this.query));
	this.registerProviderCommand("_data_request_upload_file",$bind(this,this.uploadFile));
};
saturn.server.plugins.socket.core.RemoteProviderPlugin.__name__ = ["saturn","server","plugins","socket","core","RemoteProviderPlugin"];
saturn.server.plugins.socket.core.RemoteProviderPlugin.__super__ = saturn.server.plugins.socket.core.BaseServerSocketPlugin;
saturn.server.plugins.socket.core.RemoteProviderPlugin.prototype = $extend(saturn.server.plugins.socket.core.BaseServerSocketPlugin.prototype,{
	registerProviderCommand: function(command,cb) {
		var _gthis = this;
		this.registerListener(command,function(data,socket) {
			var user = _gthis.getSocketUserNoAuthCheck(socket);
			var providerName = saturn.client.core.CommonCore.getDefaultProviderName();
			if(Reflect.hasField(data,"queryId")) {
				var namedQuery = Reflect.field(data,"queryId");
				_gthis.debug("Looking " + namedQuery);
				providerName = saturn.client.core.CommonCore.getProviderForNamedQuery(namedQuery);
				_gthis.debug("Got for named query: " + providerName);
			} else if(Reflect.hasField(data,"class_name")) {
				_gthis.debug("Looking for provider");
				providerName = saturn.client.core.CommonCore.getProviderNameForModel(data.class_name);
				if(providerName == null) {
					_gthis.debug("Error finding provider for " + Std.string(data.class_name));
					_gthis.handleError(data,"Unable to find source for entity");
					return;
				}
			} else if(Reflect.hasField(data,"queryStr")) {
				var query = saturn.db.query_lang.Query.deserialise(Reflect.field(data,"queryStr"));
				data.queryObj = query;
				var clazzList = query.getClassList();
				var clazz_name = clazzList[0];
				_gthis.debug(clazz_name);
				providerName = saturn.client.core.CommonCore.getProviderNameForModel(clazz_name);
				_gthis.debug(providerName);
				if(providerName == null) {
					_gthis.debug("Error finding provider for " + clazz_name);
					_gthis.handleError(data,"Unable to find source for entity");
					return;
				}
			}
			saturn.client.core.CommonCore.getDefaultProvider(function(err,provider) {
				if(err != null) {
					_gthis.handleError(data,err);
				} else {
					var disconnectOnEnd = false;
					var connectAsUser = "";
					var config = provider.getConfig();
					if(config != null) {
						connectAsUser = config.connect_as_user;
					}
					_gthis.debug("Connect as user is: " + connectAsUser);
					if(command != "_request_models" && (connectAsUser == "preferred" || connectAsUser == "force")) {
						if(user == null) {
							if(connectAsUser == "force") {
								_gthis.debug("Connect as user is forced but user is not logged in to " + providerName + " " + command);
								_gthis.handleError(data,"You must be logged in to use this provider");
								return;
							} else {
								_gthis.debug("Calling method on Provider");
								cb(data,provider,user,function() {
									if(disconnectOnEnd) {
										provider._closeConnection();
									}
								});
							}
						} else {
							_gthis.debug("Connecting as user");
							var original_provider = provider;
							var userProvider = provider.generatedLinkedClone();
							userProvider.setConnectAsUser(true);
							disconnectOnEnd = true;
							_gthis.getSaturnServer().getAuthenticationPlugin().decryptUserPassword(user,function(err1,user1) {
								userProvider.setUser(user1);
								if(err1 != null) {
									_gthis.handleError(data,err1);
								} else {
									_gthis.debug("Calling method on Provider");
									cb(data,userProvider,user1,function() {
										if(disconnectOnEnd) {
											userProvider._closeConnection();
										}
									});
								}
							});
						}
					} else {
						_gthis.debug("Calling method on Provider");
						cb(data,provider,user,function() {
							if(disconnectOnEnd) {
								provider._closeConnection();
							}
						});
					}
				}
			},providerName);
		});
	}
	,getModels: function(data,provider,user,cb) {
		var json = { };
		var combined_models = saturn.client.core.CommonCore.getCombinedModels();
		json.models = haxe.Serializer.run(combined_models);
		this.sendJson(data,json,null);
		cb();
	}
	,getByIdStartsWith: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			var data1 = data.id;
			var data2 = data.field;
			var tmp = Type.resolveClass(data.class_name);
			provider.getByIdStartsWith(data1,data2,tmp,data.limit,function(objs,err) {
				var json = { };
				var i = saturn.client.core.CommonCore.releaseResource(provider);
				json.error = err;
				json.objects = objs;
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.handleError(data,e);
			cb();
		}
	}
	,query: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			var queryObj = data.queryObj;
			this.debug(Type.getClassName(Type.getClass(queryObj)));
			provider.query(queryObj,function(objs,err) {
				var json = { };
				var i = saturn.client.core.CommonCore.releaseResource(provider);
				json.error = err;
				json.objects = objs;
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			saturn.core.Util.debug(e);
			this.handleError(data,e);
			cb();
		}
	}
	,getObjectIds: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			var data1 = data.ids;
			var tmp = Type.resolveClass(data.class_name);
			provider.getByIds(data1,tmp,function(objs,err) {
				var json = { };
				saturn.client.core.CommonCore.releaseResource(provider);
				json.error = err;
				json.objects = objs;
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.sendError(data,e,null);
			cb();
		}
	}
	,getByValues: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			var data1 = data.values;
			var tmp = Type.resolveClass(data.class_name);
			provider.getByValues(data1,tmp,data.field,function(objs,err) {
				var json = { };
				saturn.client.core.CommonCore.releaseResource(provider);
				json.error = err;
				json.objects = objs;
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.sendError(data,e,null);
			cb();
		}
	}
	,getByPkeys: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			var data1 = data.ids;
			var tmp = Type.resolveClass(data.class_name);
			provider.getByPkeys(data1,tmp,function(objs,err) {
				var json = { };
				saturn.client.core.CommonCore.releaseResource(provider);
				json.error = err;
				json.objects = objs;
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.sendError(data,e,null);
			cb();
		}
	}
	,getByClass: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			var tmp = Type.resolveClass(data.class_name);
			provider.getObjects(tmp,function(objs,err) {
				var json = { };
				saturn.client.core.CommonCore.releaseResource(provider);
				json.error = err;
				json.objects = objs;
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.sendError(data,e,null);
			cb();
		}
	}
	,getByNamedQuery: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			this.debug("Start " + Std.string(data.queryId));
			var params = haxe.Unserializer.run(data.parameters);
			this.debug("End");
			if(data.queryId == "saturn.workflow") {
				params[1].setRemote(true);
			}
			params = this.autoCompleteFields(params,user);
			var clazz = null;
			if(data.class_name != null) {
				clazz = Type.resolveClass(data.class_name);
			}
			provider.getByNamedQuery(data.queryId,params,clazz,provider.getConfig().enable_cache,function(objs,err) {
				_gthis.debug("Returning from named query " + Std.string(data.queryId));
				var json = { };
				saturn.client.core.CommonCore.releaseResource(provider);
				json.error = err;
				json.objects = objs;
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.sendError(data,e,null);
			cb();
		}
	}
	,autoCompleteFields: function(params,user) {
		var retParams = [];
		if((params instanceof Array) && params.__enum__ == null) {
			var _g = 0;
			while(_g < params.length) {
				var paramSet = params[_g];
				++_g;
				var _g1 = 0;
				var _g2 = Reflect.fields(paramSet);
				while(_g1 < _g2.length) {
					var field = _g2[_g1];
					++_g1;
					if(field == "_username") {
						saturn.core.Util.debug("Setting username to " + user.username);
						Reflect.setField(paramSet,"_username",user.username);
					}
				}
				retParams.push(paramSet);
			}
			return retParams;
		} else {
			return params;
		}
	}
	,'delete': function(data,provider,user,cb) {
		var _gthis = this;
		try {
			var objs = this.convertJsonObjectArray(data.objs);
			provider._delete(objs,data.class_name,function(err) {
				var json = { };
				json.error = err;
				saturn.client.core.CommonCore.releaseResource(provider);
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.sendError(data,e,null);
			cb();
		}
	}
	,insert: function(data,provider,user,cb) {
		var _gthis = this;
		var objs = this.convertJsonObjectArray(data.objs);
		provider._insert(objs,data.class_name,function(err) {
			var json = { };
			saturn.client.core.CommonCore.releaseResource(provider);
			js.Node.console.log("Returning from insert: " + err);
			if(err != null) {
				_gthis.handleError(data,err,null);
			} else {
				_gthis.sendJson(data,json,null);
			}
			cb();
		});
	}
	,update: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			var objs = this.convertJsonObjectArray(data.objs);
			provider._update(objs,data.class_name,function(err) {
				var json = { };
				saturn.client.core.CommonCore.releaseResource(provider);
				json.error = err;
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.sendError(data,e,null);
			cb();
		}
	}
	,commit: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			provider.commit(function(err) {
				var json = { };
				saturn.client.core.CommonCore.releaseResource(provider);
				json.error = err;
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.sendError(data,e,null);
			cb();
		}
	}
	,convertJsonObjectArray: function(jsonObjsStr) {
		var jsonObjs = haxe.Json.parse(jsonObjsStr);
		var objs = [];
		var _g = 0;
		while(_g < jsonObjs.length) {
			var jsonObj = jsonObjs[_g];
			++_g;
			var obj = new haxe.ds.StringMap();
			var _g1 = 0;
			var _g2 = Reflect.fields(jsonObj);
			while(_g1 < _g2.length) {
				var field = _g2[_g1];
				++_g1;
				obj.set(field,Reflect.field(jsonObj,field));
			}
			objs.push(obj);
		}
		return objs;
	}
	,uploadFile: function(data,provider,user,cb) {
		var _gthis = this;
		try {
			provider.uploadFile(data.contents,data.file_identifier,function(err,upload_id) {
				var json = { "upload_id" : upload_id};
				saturn.client.core.CommonCore.releaseResource(provider);
				_gthis.sendJson(data,json,null);
				cb();
			});
		} catch( e ) {
			if (e instanceof js._Boot.HaxeError) e = e.val;
			saturn.client.core.CommonCore.releaseResource(provider);
			this.sendError(data,e,null);
			cb();
		}
	}
	,__class__: saturn.server.plugins.socket.core.RemoteProviderPlugin
});
saturn.server.plugins.socket.core.SocketIOException = $hxClasses["saturn.server.plugins.socket.core.SocketIOException"] = function(err) {
	saturn.util.HaxeException.call(this,err);
};
saturn.server.plugins.socket.core.SocketIOException.__name__ = ["saturn","server","plugins","socket","core","SocketIOException"];
saturn.server.plugins.socket.core.SocketIOException.__super__ = saturn.util.HaxeException;
saturn.server.plugins.socket.core.SocketIOException.prototype = $extend(saturn.util.HaxeException.prototype,{
	__class__: saturn.server.plugins.socket.core.SocketIOException
});
saturn.util.StringUtils = $hxClasses["saturn.util.StringUtils"] = function() { };
saturn.util.StringUtils.__name__ = ["saturn","util","StringUtils"];
saturn.util.StringUtils.getRepeat = function(txt,count) {
	var stringBuf = new StringBuf();
	var _g1 = 0;
	var _g = count;
	while(_g1 < _g) {
		var i = _g1++;
		stringBuf.add(txt);
	}
	return stringBuf.toString();
};
saturn.util.StringUtils.reverse = function(txt) {
	var cols = txt.split("");
	cols.reverse();
	return cols.join("");
};
saturn.util.StringUtils.__super__ = StringTools;
saturn.util.StringUtils.prototype = $extend(StringTools.prototype,{
	__class__: saturn.util.StringUtils
});
if(!saturn.workflow) saturn.workflow = {};
saturn.workflow.Object = $hxClasses["saturn.workflow.Object"] = function() {
	this.remote = false;
};
saturn.workflow.Object.__name__ = ["saturn","workflow","Object"];
saturn.workflow.Object.prototype = {
	error: null
	,data: null
	,response: null
	,remote: null
	,setRemote: function(remote) {
		this.remote = remote;
	}
	,isRemote: function() {
		return this.remote;
	}
	,getParameter: function(param) {
		var data = this.getData();
		if(data != null && Reflect.hasField(data,param)) {
			return Reflect.field(data,param);
		} else if(Reflect.hasField(this,param)) {
			return Reflect.field(this,param);
		} else {
			return null;
		}
	}
	,setError: function(error) {
		saturn.core.Util.debug(error);
		this.error = error;
	}
	,getError: function() {
		return this.error;
	}
	,setData: function(data) {
		this.data = data;
	}
	,getData: function() {
		return this.data;
	}
	,getResponse: function() {
		return this.response;
	}
	,setResponse: function(resp) {
		this.response = resp;
	}
	,setup: function(cb) {
	}
	,__class__: saturn.workflow.Object
};
function $iterator(o) { if( o instanceof Array ) return function() { return HxOverrides.iter(o); }; return typeof(o.iterator) == 'function' ? $bind(o,o.iterator) : o.iterator; }
var $_, $fid = 0;
function $bind(o,m) { if( m == null ) return null; if( m.__id__ == null ) m.__id__ = $fid++; var f; if( o.hx__closures__ == null ) o.hx__closures__ = {}; else f = o.hx__closures__[m.__id__]; if( f == null ) { f = function(){ return f.method.apply(f.scope, arguments); }; f.scope = o; f.method = m; o.hx__closures__[m.__id__] = f; } return f; }
$hxClasses["Math"] = Math;
String.prototype.__class__ = $hxClasses["String"] = String;
String.__name__ = ["String"];
$hxClasses["Array"] = Array;
Array.__name__ = ["Array"];
Date.prototype.__class__ = $hxClasses["Date"] = Date;
Date.__name__ = ["Date"];
var Int = $hxClasses["Int"] = { __name__ : ["Int"]};
var Dynamic = $hxClasses["Dynamic"] = { __name__ : ["Dynamic"]};
var Float = $hxClasses["Float"] = Number;
Float.__name__ = ["Float"];
var Bool = $hxClasses["Bool"] = Boolean;
Bool.__ename__ = ["Bool"];
var Class = $hxClasses["Class"] = { __name__ : ["Class"]};
var Enum = { };
bindings.NodeFSExtra.fsExtra = require('fs-extra');
var NodePostgres = require('pg').Client;
bindings.NodeTemp.temp = require('temp');
var __map_reserved = {};
haxe.Serializer.USE_CACHE = false;
haxe.Serializer.USE_ENUM_INDEX = false;
haxe.Serializer.BASE64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";
haxe.Unserializer.DEFAULT_RESOLVER = new haxe._Unserializer.DefaultResolver();
haxe.Unserializer.BASE64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:";
haxe.ds.ObjectMap.count = 0;
js.Boot.__toStr = ({ }).toString;
js.NodeC.UTF8 = "utf8";
js.NodeC.ASCII = "ascii";
js.NodeC.BINARY = "binary";
js.NodeC.BASE64 = "base64";
js.NodeC.HEX = "hex";
js.NodeC.EVENT_EVENTEMITTER_NEWLISTENER = "newListener";
js.NodeC.EVENT_EVENTEMITTER_ERROR = "error";
js.NodeC.EVENT_STREAM_DATA = "data";
js.NodeC.EVENT_STREAM_END = "end";
js.NodeC.EVENT_STREAM_ERROR = "error";
js.NodeC.EVENT_STREAM_CLOSE = "close";
js.NodeC.EVENT_STREAM_DRAIN = "drain";
js.NodeC.EVENT_STREAM_CONNECT = "connect";
js.NodeC.EVENT_STREAM_SECURE = "secure";
js.NodeC.EVENT_STREAM_TIMEOUT = "timeout";
js.NodeC.EVENT_STREAM_PIPE = "pipe";
js.NodeC.EVENT_PROCESS_EXIT = "exit";
js.NodeC.EVENT_PROCESS_UNCAUGHTEXCEPTION = "uncaughtException";
js.NodeC.EVENT_PROCESS_SIGINT = "SIGINT";
js.NodeC.EVENT_PROCESS_SIGUSR1 = "SIGUSR1";
js.NodeC.EVENT_CHILDPROCESS_EXIT = "exit";
js.NodeC.EVENT_HTTPSERVER_REQUEST = "request";
js.NodeC.EVENT_HTTPSERVER_CONNECTION = "connection";
js.NodeC.EVENT_HTTPSERVER_CLOSE = "close";
js.NodeC.EVENT_HTTPSERVER_UPGRADE = "upgrade";
js.NodeC.EVENT_HTTPSERVER_CLIENTERROR = "clientError";
js.NodeC.EVENT_HTTPSERVERREQUEST_DATA = "data";
js.NodeC.EVENT_HTTPSERVERREQUEST_END = "end";
js.NodeC.EVENT_CLIENTREQUEST_RESPONSE = "response";
js.NodeC.EVENT_CLIENTRESPONSE_DATA = "data";
js.NodeC.EVENT_CLIENTRESPONSE_END = "end";
js.NodeC.EVENT_NETSERVER_CONNECTION = "connection";
js.NodeC.EVENT_NETSERVER_CLOSE = "close";
js.NodeC.FILE_READ = "r";
js.NodeC.FILE_READ_APPEND = "r+";
js.NodeC.FILE_WRITE = "w";
js.NodeC.FILE_WRITE_APPEND = "a+";
js.NodeC.FILE_READWRITE = "a";
js.NodeC.FILE_READWRITE_APPEND = "a+";
js.Node.console = console;
js.Node.process = process;
js.Node.require = require;
js.Node.setTimeout = setTimeout;
js.Node.clearTimeout = clearTimeout;
js.Node.setInterval = setInterval;
js.Node.clearInterval = clearInterval;
js.Node.setImmediate = (function($this) {
	var $r;
	var version = HxOverrides.substr(js.Node.process.version,1,null).split(".").map(Std.parseInt);
	$r = version[0] > 0 || version[1] >= 9 ? js.Node.isNodeWebkit() ? global.setImmediate : setImmediate : null;
	return $r;
}(this));
js.Node.clearImmediate = (function($this) {
	var $r;
	var version = HxOverrides.substr(js.Node.process.version,1,null).split(".").map(Std.parseInt);
	$r = version[0] > 0 || version[1] >= 9 ? js.Node.isNodeWebkit() ? global.clearImmediate : clearImmediate : null;
	return $r;
}(this));
js.Node.global = global;
js.Node.module = js.Node.isNodeWebkit() ? global.module : module;
js.Node.stringify = JSON.stringify;
js.Node.parse = JSON.parse;
saturn.app.SaturnServer.DEBUG = (js.Node.require("debug"))("saturn:server");
saturn.client.core.CommonCore.pools = new haxe.ds.StringMap();
saturn.client.core.CommonCore.resourceToPool = new haxe.ds.ObjectMap();
saturn.client.core.CommonCore.providers = new haxe.ds.StringMap();
saturn.core.molecule.Molecule.newLineReg = new EReg("\n","g");
saturn.core.molecule.Molecule.carLineReg = new EReg("\r","g");
saturn.core.molecule.Molecule.whiteSpaceReg = new EReg("\\s","g");
saturn.core.molecule.Molecule.reg_starReplace = new EReg("\\*","");
saturn.core.StandardGeneticCode.instance = new saturn.core.StandardGeneticCode();
saturn.core.StandardGeneticCode.standardTable = saturn.core.StandardGeneticCode.instance.getCodonLookupTable();
saturn.core.StandardGeneticCode.aaToCodon = saturn.core.StandardGeneticCode.instance.getAAToCodonTable();
saturn.core.GeneticCodeRegistry.CODE_REGISTRY = new saturn.core.GeneticCodeRegistry();
saturn.core.Util.fs = js.Node.require("fs");
saturn.core.Util.temp = js.Node.require("temp");
saturn.core.Util.split = js.Node.require("split");
saturn.core.molecule.MoleculeConstants.aMW = 331.2;
saturn.core.molecule.MoleculeConstants.tMW = 322.2;
saturn.core.molecule.MoleculeConstants.gMW = 347.2;
saturn.core.molecule.MoleculeConstants.cMW = 307.2;
saturn.core.molecule.MoleculeConstants.aChainMW = 313.2;
saturn.core.molecule.MoleculeConstants.tChainMW = 304.2;
saturn.core.molecule.MoleculeConstants.gChainMW = 329.2;
saturn.core.molecule.MoleculeConstants.cChainMW = 289.2;
saturn.core.molecule.MoleculeConstants.O2H = 18.02;
saturn.core.molecule.MoleculeConstants.OH = 17.01;
saturn.core.molecule.MoleculeConstants.PO3 = 78.97;
saturn.core.molecule.MoleculeSetRegistry.defaultRegistry = new saturn.core.molecule.MoleculeSetRegistry();
saturn.db.DefaultProvider.r_date = new EReg("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.000Z","");
saturn.db.query_lang.SQLVisitor.injection_check = new EReg("^([A-Za-z0-9\\.])+$","");
saturn.app.SaturnServer.main();
